var LivePlayer=function(l){function t(t){for(var e,r,i=t[0],n=t[1],a=t[2],s=0,o=[];s<i.length;s++)r=i[s],Object.prototype.hasOwnProperty.call(h,r)&&h[r]&&o.push(h[r][0]),h[r]=0;for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(l[e]=n[e]);for(d&&d(t);o.length;)o.shift()();return c.push.apply(c,a||[]),u()}function u(){for(var t,e=0;e<c.length;e++){for(var r=c[e],i=!0,n=1;n<r.length;n++){var a=r[n];0!==h[a]&&(i=!1)}i&&(c.splice(e--,1),t=s(s.s=r[0]))}return t}var r={},h={3:0},c=[];function s(t){var e;return(r[t]||(e=r[t]={i:t,l:!1,exports:{}},l[t].call(e.exports,e,e.exports,s),e.l=!0,e)).exports}s.m=l,s.c=r,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/flu/player/";var e=(i=this.webpackJsonpLivePlayer=this.webpackJsonpLivePlayer||[]).push.bind(i);i.push=t;for(var i=i.slice(),n=0;n<i.length;n++)t(i[n]);var d=e;return c.push([197,1,5,4,0,2,6]),u()}([function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return a}),r.d(e,"e",function(){return s}),r.d(e,"c",function(){return o}),r.d(e,"d",function(){return l});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(t,e){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}))(t,e)};function n(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&i>=t.length?void 0:t)&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,a=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(i=a.next()).done;)s.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}},,,function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},,function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(123);function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,n(i.key),i)}}t.exports=function(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var n=r(355);function i(){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get.bind():t.exports=i=function(t,e,r){var i=n(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:r):i.value},t.exports.__esModule=!0,t.exports.default=t.exports,i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(199);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(61).default,n=r(46);t.exports=function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,function(t,e,r){var i=r(123);t.exports=function(t,e,r){return(e=i(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,function(t,e,r){"use strict";r.d(e,"i",function(){return A}),r.d(e,"j",function(){return o}),r.d(e,"h",function(){return l}),r.d(e,"g",function(){return u}),r.d(e,"c",function(){return v}),r.d(e,"e",function(){return y}),r.d(e,"b",function(){return S}),r.d(e,"f",function(){return T}),r.d(e,"a",function(){return E}),r.d(e,"d",function(){return b});var e=r(17),i=r.n(e),e=r(160),h=r.n(e),e=r(61),c=r.n(e),e=r(120),d=r.n(e);function n(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){i()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var a="authTokenName",s=["streamName",a,"authToken","autoplay","ago","debug","duration","from","timeshift","logo","poster","hasPreview","isVideoPoster","proto","play_duration","realtime","to","tracks","liveSyncDurationCount","url","source","sentryConfig","chromeless","filter.tracks"],p=function(t){return t[a]||"token"};function g(t){if("string"==typeof t){if("false"==t.toLowerCase()||"0"==t)return!1;if("true"==t.toLowerCase()||"1"==t)return!0}return null}var o=function(t,e){var r,t=d()({url:t}),i=t.pathname.split("/").filter(function(t){return""!==t&&-1===t.indexOf(".html")}).join("/"),n=t.query,a={},n=(n&&(a=n.split("&").filter(function(t){return""!==t}).reduce(function(t,e){function r(t){return decodeURIComponent(t)}var e=e.split("="),e=h()(e,2),i=e[0],e=e[1];return t[r(i)]=r(e),t},{})),e.reduce(function(t,e){return f(f({},t),e)},{})),e=f(f({},a),n),n=e.baseUrl,n=n&&d()({url:n})||t,t=f(f(f({},{host:n.host,hostname:n.hostname,protocol:n.protocol,port:n.port,streamName:i}),a),e),s=(null!=t.volume&&(t.volume=(n=t.volume,0<=(n=parseInt(n,10))&&n<=100?n:void 0)),1===t.mute?t.mute=!0:0===t.mute&&(t.mute=!1),t),o=[p(t),"volume"],l={};for(r in s){var u=s[r];"streamName"===r||o&&-1<o.indexOf(r)||null!==u&&"object"===c()(u)?l[r]=u:l[r]=null!=g(u)?g(u):u}return l};function l(t){t=p(t);return[].concat(s,t?[t]:[])}function u(t){var e=p(t),t=t[e];return t?"".concat(e,"=").concat(t):void 0}var v=function(t){var e=t.from,t=t.to;return e&&t&&0<t-e?t-e:void 0},m=function(t,e){return e?"".concat(t).concat(t.includes("?")?"&":"?").concat(e):t};function y(t){var e,r,i,n,a;return!1===t.poster?{isVideoPoster:!1,poster:!1}:(e=!t.hasPreview,r=u(t),i=t.host,n=t.protocol,a=t.streamName,t=t.hasPreview?"jpg":"mp4",n="".concat(n,"//").concat(i,"/").concat(a,"/preview.").concat(t),{isVideoPoster:e,poster:m(n,r)})}var E=function(t,e){var r=t.authToken,i=t.protocol,n=t.host,t=t.streamName;return m("".concat(i,"//").concat(n,"/").concat(t,"/").concat(e),r)},T=function(t,r){var i=t.proto,n=t.streamName,a=t.ago,s=t.from,o=t.duration,l=t.realtime,u=t.protocol,h=t.host,c=t.debug,d=t.authToken,f=t.url,p=t.source,g=t.timeshift,v=t.filterTracks;return function(){var t=f||p,e="dash"===i?".mpd":".fmp4.m3u8";return window.navigator.userAgent.includes("(Web0S; Linux/SmartTV)")&&(e="dash"),t||(t="//".concat(h,"/").concat(n,"/"),l&&r&&!a?t+="mse_ld".concat(s?"?from=".concat(s):""):(t=(t="".concat(u).concat(t))+(a?"rewind-".concat(a).concat("dash"===i?"?thumbnails=100":""):s?"archive-".concat(s,"-").concat(o||"7200"):!g||"hls"!==i&&i?"index":"timeshift_".concat(10<=g.length?"abs":"rel","-").concat(g))+e,(a||s||g&&("hls"===i||!i))&&(t=t.replace(".fmp4","")))),t=m(t,d),v&&(t="".concat(t).concat(t.includes("?")?"&":"?","filter.tracks=").concat(v)),c&&console.info("set source",t),t}},b=function(t){var e=t.streamName,r=t.host,t=t.authToken,r="//".concat(r,"/").concat(e,"/media_info.json");return m(r,t)},A=function(){var t=window.navigator.userAgent;if(t.includes("Chrome")){t=t.split("Chrome/")[1];if(107<=Number(t.split(".")[0]))return!0}return!1},_=function(t,e){return-1<e.indexOf(t)};function S(e,r){return function(t){t=_(t,r)?e[t]:void 0;return"true"===t||"on"===t||"false"!==t&&"off"!==t&&t}}},,,,,,,,,function(t,e){var r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},,,,,,,,,,,function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,,,,,,,function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(t,e,r){var i=r(352),n=r(353),a=r(154),s=r(354);t.exports=function(t){return i(t)||n(t)||a(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){r=r(356)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e){function l(t,e,r,i,n,a,s){try{var o=t[a](s),l=o.value}catch(t){return void r(t)}o.done?e(l):Promise.resolve(l).then(i,n)}t.exports=function(o){return function(){var t=this,s=arguments;return new Promise(function(e,r){var i=o.apply(t,s);function n(t){l(i,e,r,n,a,"next",t)}function a(t){l(i,e,r,n,a,"throw",t)}n(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},,function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return s});var e=r(17),i=r.n(e);r(121);function n(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function a(t){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){i()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},{media:{width:0,height:0},letterboxing:{horizontal:0,vertical:0}});return e.media.width=t.media.width*t.dom.height/t.media.height,e.media.height=t.media.height*e.media.width/t.media.width,e.media.width>t.dom.width&&(e.media.height=t.media.height*t.dom.width/t.media.width,e.media.width=t.media.width*e.media.height/t.media.height),e.media.width<t.dom.width?e.letterboxing.horizontal=Math.floor((t.dom.width-e.media.width)/2):e.media.height<t.dom.height&&(e.letterboxing.vertical=Math.floor((t.dom.height-e.media.height)/2)),e.media.width=Math.floor(e.media.width),e.media.height=Math.floor(e.media.height),e}Date.now(),window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;function s(t){var e=window,r=e.innerWidth,e=e.innerHeight,i=document.documentElement,n=i.clientHeight,i=i.clientWidth,t=t.getBoundingClientRect(),a=t.bottom,s=t.right,o=t.left,t=t.top;return 0<=a&&0<=s&&t<=(e||n)&&o<=(r||i)}},,,,function(i,t,e){"use strict";e.d(t,"a",function(){return Ta});var t=e(62),s=e.n(t),t=e(17),n=e.n(t),t=e(5),o=e.n(t),t=e(6),l=e.n(t),t=e(7),d=e.n(t),t=e(8),P=e.n(t),t=e(9),x=e.n(t),t=e(3),O=e.n(t),u=e(4);function M(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}F=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,j=/^(?=([^\/?#]*))\1([^]*)$/,q=/(?:\/|^)\.(?=\/)/g,z=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var i=a.parseURL(t);if(i)return i.path=a.normalizePath(i.path),a.buildURLFromParts(i);throw new Error("Error trying to parse base URL.")}i=a.parseURL(e);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=a.normalizePath(i.path),a.buildURLFromParts(i)):e;e=a.parseURL(t);if(!e)throw new Error("Error trying to parse base URL.");!e.netLoc&&e.path&&"/"!==e.path[0]&&(t=j.exec(e.path),e.netLoc=t[1],e.path=t[2]),e.netLoc&&!e.path&&(e.path="/");var n,t={scheme:e.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};return i.netLoc||(t.netLoc=e.netLoc,"/"!==i.path[0]&&(i.path?(n=(n=e.path).substring(0,n.lastIndexOf("/")+1)+i.path,t.path=a.normalizePath(n)):(t.path=e.path,i.params||(t.params=e.params,i.query)||(t.query=e.query)))),null===t.path&&(t.path=r.alwaysNormalize?a.normalizePath(i.path):i.path),a.buildURLFromParts(t)},parseURL:function(t){t=F.exec(t);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(q,"");t.length!==(t=t.replace(z,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};var F,j,q,z,a,Q=a;function X(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function f(i){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach(function(t){var e,r;e=i,r=n[t=t],(t=function(t){t=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);r=r.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(n,t))})}return i}function G(){return(G=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r,i=arguments[e];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}).apply(this,arguments)}const N=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)};let $=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t}({}),K=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),H=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.UNKNOWN="unknown",t}({});function J(){}const Z={trace:J,debug:J,log:J,warn:J,info:J,error:J};let tt=Z;function et(r,...t){t.forEach(function(t){var e;tt[t]=r[t]?r[t].bind(r):(t=t,(e=self.console[t])?e.bind(self.console,`[${t}] >`):J)})}const V=tt,rt=/^(\d+)x(\d+)$/,it=/(.+?)=(".*?"|.*?)(?:,|$)/g;class B{constructor(t){for(const e in t="string"==typeof t?B.parseAttrList(t):t)t.hasOwnProperty(e)&&("X-"===e.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(e)),this[e]=t[e])}decimalInteger(t){t=parseInt(this[t],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(t){if(this[t]){var e=(1&(e=(this[t]||"0x").slice(2)).length?"0":"")+e,r=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)r[t]=parseInt(e.slice(2*t,2*t+2),16);return r}return null}hexadecimalIntegerAsNumber(t){t=parseInt(this[t],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){t=this[t];return t?parseFloat(t):e}enumeratedString(t){return this[t]}bool(t){return"YES"===this[t]}decimalResolution(t){t=rt.exec(this[t]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(t){var e,r={};for(it.lastIndex=0;null!==(e=it.exec(t));){let t=e[2];0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),r[e[1].trim()]=t}return r}}class nt{constructor(t,e){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,e){var r=e.attr;for(const i in r)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]!==r[i]){V.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=i;break}t=G(new B({}),r,t)}this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr&&(e=new Date(this.attr["END-DATE"]),N(e.getTime()))&&(this._endDate=e)}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){var t;return this._endDate||(null!==(t=this.duration)?new Date(this._startDate.getTime()+1e3*t):null)}get duration(){if("DURATION"in this.attr){var t=this.attr.decimalFloatingPoint("DURATION");if(N(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&N(this.startDate.getTime())&&(null===this.duration||0<=this.duration)&&(!this.endOnNext||!!this.class)}}class at{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var y="audio",k="video",st="audiovideo";class ot{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[y]:null,[k]:null,[st]:null},this.baseurl=t}setByteRange(t,e){var t=t.split("@",2),r=[];1===t.length?r[0]=e?e.byteRangeEndOffset:0:r[0]=parseInt(t[1]),r[1]=parseInt(t[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange||[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Q.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class lt extends ot{constructor(t,e){super(e),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new at,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=t}get decryptdata(){var t=this["levelkeys"];if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){var t;return null!==this.programDateTime&&N(this.programDateTime)?(t=N(this.duration)?this.duration:0,this.programDateTime+1e3*t):null}get encrypted(){if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),e=t.length;if(1<e||1===e&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(t){this.levelkeys&&(t=this.levelkeys[t])&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}abortRequests(){var t;null!=(t=this.loader)&&t.abort(),null!=(t=this.keyLoader)&&t.abort()}setElementaryStreamInfo(t,e,r,i,n,a=!1){var s=this["elementaryStreams"],o=s[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,r),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,n)):s[t]={startPTS:e,endPTS:r,startDTS:i,endDTS:n,partial:a}}clearElementaryStreamInfo(){var t=this["elementaryStreams"];t[y]=null,t[k]=null,t[st]=null}}class ut extends ot{constructor(t,e,r,i,n){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new at,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=i;r=t.enumeratedString("BYTERANGE");r&&this.setByteRange(r,n),n&&(this.fragOffset=n.fragOffset+n.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){var t=this["elementaryStreams"];return!!(t.audio||t.video||t.audiovideo)}}class ht{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){var e,r;t?(e=this.lastPartSn-t.lastPartSn,r=this.lastPartIndex-t.lastPartIndex,this.updated=this.endSN!==t.endSN||!!r||!!e,this.advanced=this.endSN>t.endSN||0<e||0==e&&0<r,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay):(this.advanced=!0,this.updated=!0)}get hasProgramDateTime(){return!!this.fragments.length&&N(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){var t=this.driftEndTime-this.driftStartTime;return 0<t?1e3*(this.driftEnd-this.driftStart)/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return null!=(t=this.fragments)&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function ct(t){return Uint8Array.from(atob(t),t=>t.charCodeAt(0))}function dt(t){function e(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}function ft(t){var e,r,t=t.split(":");let i=null;return"data"===t[0]&&2===t.length&&2===(e=(t=t[1].split(";"))[t.length-1].split(",")).length&&(r="base64"===e[0],e=e[1],i=r?(t.splice(-1,1),ct(e)):(r=pt(r=e).subarray(0,16),(t=new Uint8Array(16)).set(r,16-r.length),t)),i}function pt(t){return Uint8Array.from(unescape(encodeURIComponent(t)),t=>t.charCodeAt(0))}var p={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},gt="org.w3.clearkey",vt="com.apple.streamingkeydelivery",mt="com.microsoft.playready",yt="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Et(t){switch(t){case vt:return p.FAIRPLAY;case mt:return p.PLAYREADY;case yt:return p.WIDEVINE;case gt:return p.CLEARKEY}}var Tt="edef8ba979d64acea3c827dcd51d21ed";function bt(t){switch(t){case p.FAIRPLAY:return vt;case p.PLAYREADY:return mt;case p.WIDEVINE:return yt;case p.CLEARKEY:return gt}}function At(t){const{drmSystems:e,widevineLicenseUrl:r}=t;t=e?[p.FAIRPLAY,p.WIDEVINE,p.PLAYREADY,p.CLEARKEY].filter(t=>!!e[t]):[];return!t[p.WIDEVINE]&&r&&t.push(p.WIDEVINE),t}const _t="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function St(t,e,r){return Uint8Array.prototype.slice?t.slice(e,r):new Uint8Array(Array.prototype.slice.call(t,e,r))}const Lt=(t,e)=>e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,kt=(t,e)=>e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,Rt=(t,e)=>{var r=e;let i=0;for(;Lt(t,e);){i+=10;var n=wt(t,e+6);i+=n,kt(t,e+10)&&(i+=10),e+=i}if(0<i)return t.subarray(r,r+i)},wt=(t,e)=>{var r=(127&t[e])<<21;return(r|=(127&t[e+1])<<14)|(127&t[e+2])<<7|127&t[e+3]},It=t=>{var e=Ct(t);for(let t=0;t<e.length;t++){var r=e[t];if(Dt(r)){if(8!==r.data.byteLength)return;{var r=new Uint8Array(r.data),i=1&r[3];let t=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];return t/=45,i&&(t+=47721858.84),Math.round(t)}}}},Dt=t=>t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info,Ct=t=>{let e=0;for(var r,i=[];Lt(t,e);){for(var n=wt(t,e+6),a=(e+=10)+n;e+8<a;){o=t.subarray(e),r=s=void 0,s=String.fromCharCode(o[0],o[1],o[2],o[3]),r=wt(o,4);var s={type:s,size:r,data:o.subarray(10,10+r)},o=(t=>{if(t.type==="PRIV")return Pt(t);else if(t.type[0]==="W")return Ot(t);return xt(t)})(s);o&&i.push(o),e+=s.size+10}kt(t,e)&&(e+=10)}return i},Pt=t=>{var e,r;if(!(t.size<2))return e=T(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1)),{key:t.type,info:e,data:r.buffer}},xt=t=>{var e,r;if(!(t.size<2))return"TXXX"===t.type?(e=1,e+=(r=T(t.data.subarray(1),!0)).length+1,e=T(t.data.subarray(e)),{key:t.type,info:r,data:e}):(r=T(t.data.subarray(1)),{key:t.type,data:r})},Ot=t=>{var e,r;return"WXXX"===t.type?t.size<2?void 0:(e=1,e+=(r=T(t.data.subarray(1),!0)).length+1,e=T(t.data.subarray(e)),{key:t.type,info:r,data:e}):(r=T(t.data),{key:t.type,data:r})},T=(t,e=!1)=>{var r,i=function(){Mt||void 0===self.TextDecoder||(Mt=new self.TextDecoder("utf-8"));return Mt}();if(i)return i=i.decode(t),e?-1!==(r=i.indexOf("\0"))?i.substring(0,r):i:i.replace(/\0/g,"");var n,a,s=t.length;let o,l="",u=0;for(;u<s;){if(0===(n=t[u++])&&e)return l;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:o=t[u++],l+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=t[u++],a=t[u++],l+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&a)<<0)}}return l};let Mt;const g={hexDump:function(r){let i="";for(let e=0;e<r.length;e++){let t=r[e].toString(16);t.length<2&&(t="0"+t),i+=t}return i}},Ft=Math.pow(2,32)-1,Nt=[].push,Bt={video:1,audio:2,id3:3,text:4};function v(t){return String.fromCharCode.apply(null,t)}function Ut(t,e){t=t[e]<<8|t[e+1];return t<0?65536+t:t}function R(t,e){t=jt(t,e);return t<0?4294967296+t:t}function jt(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Gt(t,e,r){t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r}function w(e,r){var i=[];if(r.length){var n=e.byteLength;for(let t=0;t<n;){var a=R(e,t),s=v(e.subarray(t+4,t+8)),a=1<a?t+a:n;s===r[0]&&(1===r.length?i.push(e.subarray(t+8,a)):(s=w(e.subarray(t+8,a),r.slice(1))).length&&Nt.apply(i,s)),t=a}}return i}function $t(t){const r=[];var e=w(t,["moov","trak"]);for(let t=0;t<e.length;t++){var i=e[t],n=w(i,["tkhd"])[0];if(n){var n=R(n,0===n[0]?12:20),a=w(i,["mdia","mdhd"])[0];if(a){var a=R(a,0===a[0]?12:20),s=w(i,["mdia","hdlr"])[0];if(s){s=v(s.subarray(8,12)),s={soun:y,vide:k}[s];if(s){i=w(i,["mdia","minf","stbl","stsd"])[0];let t;i&&(t=v(i.subarray(12,16))),r[n]={timescale:a,type:s},r[s]={timescale:a,id:n,codec:t}}}}}}return w(t,["moov","mvex","trex"]).forEach(t=>{var e=R(t,4),e=r[e];e&&(e.default={duration:R(t,12),flags:R(t,20)})}),r}function Kt(t){var e=w(t,["schm"])[0];if(e){e=v(e.subarray(4,8));if("cbcs"===e||"cenc"===e)return w(t,["schi","tenc"])[0]}return V.error("[eme] missing 'schm' box"),null}function Ht(t,e){let r=0,i=0,n=0;var a=w(t,["moof","traf"]);for(let t=0;t<a.length;t++){var s=a[t],o=w(s,["tfhd"])[0],l=e[R(o,4)];if(l){var u=l.default,h=R(o,0)|(null==u?void 0:u.flags);let e=null==u?void 0:u.duration;8&h&&(e=R(o,2&h?12:8));var c,d=l.timescale||9e4,f=w(s,["trun"]);for(let t=0;t<f.length;t++)!(r=function(e){var r=R(e,0);let i=8;1&r&&(i+=4);4&r&&(i+=4);let n=0;var a=R(e,4);for(let t=0;t<a;t++){var s;256&r&&(s=R(e,i),n+=s,i+=4),512&r&&(i+=4),1024&r&&(i+=4),2048&r&&(i+=4)}return n}(f[t]))&&e&&(c=R(f[t],4),r=e*c),l.type===k?i+=r/d:l.type===y&&(n+=r/d)}}if(0!==i||0!==n)return i||n;{let e=0;var p=w(t,["sidx"]);for(let t=0;t<p.length;t++){var g=function(e){var r=[],t=e[0];let i=8;var n=R(e,i);i=(i+=4)+(0===t?8:16)+2;let a=e.length+0;var s=Ut(e,i);i+=2;for(let t=0;t<s;t++){var o=i,l=R(e,o),u=(o+=4,2147483647&l);if(1==(2147483648&l)>>>31)return V.warn("SIDX has hierarchical references (not supported)"),null;l=R(e,o);o+=4,r.push({referenceSize:u,subsegmentDuration:l,info:{duration:l/n,start:a,end:a+u-1}}),a+=u,o+=4,i=o}return{earliestPresentationTime:0,timescale:n,version:t,referencesCount:s,references:r}}(p[t]);null!=g&&g.references&&(e+=g.references.reduce((t,e)=>t+e.info.duration||0,0))}return e}}function Vt(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function Wt(T,b){const A=[],_=b.samples,S=b.timescale,u=b.id;let L=!1;return w(_,["moof"]).map(t=>{const E=t.byteOffset-8;w(t,["traf"]).map(l=>{var t=w(l,["tfdt"]).map(t=>{var e=t[0];let r=R(t,4);return(r=1===e?(r*=Math.pow(2,32))+R(t,8):r)/S})[0];return void 0!==t&&(T=t),w(l,["tfhd"]).map(t=>{var e=R(t,4),r=16777215&R(t,0),i=0!=(1&r),n=0!=(2&r),a=0!=(8&r);let m=0;var s=0!=(16&r);let y=0;r=0!=(32&r);let o=8;e===u&&(i&&(o+=8),n&&(o+=4),a&&(m=R(t,o),o+=4),s&&(y=R(t,o),o+=4),r&&(o+=4),"video"===b.type&&(L=function(t){if(!t)return!1;var e=t.indexOf("."),t=e<0?t:t.substring(0,e);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}(b.codec)),w(l,["trun"]).map(e=>{var r=e[0],t=16777215&R(e,0);let i=0;var n=0!=(256&t);let a=0;var s=0!=(512&t);let o=0;var l=0!=(1024&t),u=0!=(2048&t);let h=0;var c,d,f=R(e,4);let p=8,g=(0!=(1&t)&&(i=R(e,p),p+=4),0!=(4&t)&&(p+=4),i+E);for(let t=0;t<f;t++){if(n?(a=R(e,p),p+=4):a=m,s?(o=R(e,p),p+=4):o=y,l&&(p+=4),u&&(h=(0===r?R:jt)(e,p),p+=4),b.type===k){let t=0;for(;t<o;){var v=R(_,g);g+=4,c=L,d=_[g],(c?39==(c=d>>1&63)||40==c:6==(31&d))&&Yt(_.subarray(g,g+v),L?2:1,T+h/S,A),g+=v,t+=v+4}}T+=a/S}}))})})}),A}function Yt(t,e,r,i){var n=qt(t);let a=0,s=(a+=e,0),o=0,l=!1,u=0;for(;a<n.length;){for(s=0;!(a>=n.length)&&(u=n[a++],s+=u,255===u););for(o=0;!(a>=n.length)&&(u=n[a++],o+=u,255===u););var h=n.length-a;if(!l&&4===s&&a<n.length){if(l=!0,181===n[a++]){var c=Ut(n,a);if(a+=2,49===c){c=R(n,a);if(a+=4,1195456820===c){c=n[a++];if(3===c){var d=n[a++],f=64&d,p=f?2+3*(31&d):0,g=new Uint8Array(p);if(f){g[0]=d;for(let t=1;t<p;t++)g[t]=n[a++]}i.push({type:c,payloadType:s,pts:r,bytes:g})}}}}}else if(5===s&&o<h){if(l=!0,16<o){var v=[];for(let t=0;t<16;t++){var m=n[a++].toString(16);v.push(1==m.length?"0"+m:m),3!==t&&5!==t&&7!==t&&9!==t||v.push("-")}var y=o-16,E=new Uint8Array(y);for(let t=0;t<y;t++)E[t]=n[a++];i.push({payloadType:s,pts:r,uuid:v.join(""),userData:T(E),userDataBytes:E})}}else if(o<h)a+=o;else if(o>h)break}}function qt(t){var e=t.byteLength,r=[];let i=1;for(;i<e-2;)0===t[i]&&0===t[i+1]&&3===t[i+2]?(r.push(i+2),i+=2):i++;if(0===r.length)return t;var n=e-r.length,a=new Uint8Array(n);let s=0;for(i=0;i<n;s++,i++)s===r[0]&&(s++,r.shift()),a[i]=t[s];return a}function zt(r,e,i){if(16!==r.byteLength)throw new RangeError("Invalid system id");let n,a;if(e){n=1,a=new Uint8Array(16*e.length);for(let t=0;t<e.length;t++){var s=e[t];if(16!==s.byteLength)throw new RangeError("Invalid key");a.set(s,16*t)}}else n=0,a=new Uint8Array;let o;0<n?(o=new Uint8Array(4),0<e.length&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;var l=new Uint8Array(4);i&&0<i.byteLength&&new DataView(l.buffer).setUint32(0,i.byteLength,!1);{var u=[112,115,115,104],h=[new Uint8Array([n,0,0,0]),r,o,a,l,i||new Uint8Array],c=h.length;let t=8,e=c;for(;e--;)t+=h[e].byteLength;var d=new Uint8Array(t);for(d[0]=t>>24&255,d[1]=t>>16&255,d[2]=t>>8&255,d[3]=255&t,d.set(u,4),e=0,t=8;e<c;e++)d.set(h[e],t),t+=h[e].byteLength;return d}}let Qt={};class Xt{static clearKeyUriToKeyIdMap(){Qt={}}constructor(t,e,r,i=[1],n=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=r,this.keyFormatVersions=i,this.iv=n,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&"AES-128"!==t}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case vt:case yt:case mt:case gt:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv)return"number"!=typeof e&&("AES-128"!==this.method||this.iv||V.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),e=function(e){var r=new Uint8Array(16);for(let t=12;t<16;t++)r[t]=e>>8*(15-t)&255;return r}(e),new Xt(this.method,this.uri,"identity",this.keyFormatVersions,e);var r=ft(this.uri);if(r)switch(this.keyFormat){case yt:22<=(this.pssh=r).length&&(this.keyId=r.subarray(r.length-22,r.length-6));break;case mt:var i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),i=(this.pssh=zt(i,null,r),new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2)),i=String.fromCharCode.apply(null,Array.from(i)),i=i.substring(i.indexOf("<"),i.length),i=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];i&&(i=i.childNodes[0]?i.childNodes[0].nodeValue:i.getAttribute("VALUE"))&&(dt(i=ct(i).subarray(0,16)),this.keyId=i);break;default:{let t=r.subarray(0,16);16!==t.length&&((i=new Uint8Array(16)).set(t,16-t.length),t=i),this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t=Qt[this.uri];t||(e=Object.keys(Qt).length%Number.MAX_SAFE_INTEGER,t=new Uint8Array(16),new DataView(t.buffer,12,4).setUint32(0,e),Qt[this.uri]=t),this.keyId=t}return this}}const Jt=/\{\$([a-zA-Z0-9-_]+)\}/g;function Zt(t){return Jt.test(t)}function U(e,r,i){if(null!==e.variableList||e.hasVariableRefs)for(let t=i.length;t--;){var n=i[t],a=r[n];a&&(r[n]=te(e,a))}}function te(i,t){if(null!==i.variableList||i.hasVariableRefs){const n=i.variableList;return t.replace(Jt,t=>{var e=t.substring(2,t.length-1),r=null==n?void 0:n[e];return void 0===r?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${e}"`)),t):r})}return t}function ee(e,t,r){let i=e.variableList;i||(e.variableList=i={});let n,a;if("QUERYPARAM"in t){n=t.QUERYPARAM;try{var s=new self.URL(r).searchParams;if(!s.has(n))throw new Error(`"${n}" does not match any query parameter in URI: "${r}"`);a=s.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message))}}else n=t.NAME,a=t.VALUE;n in i?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):i[n]=a||""}function re(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}const ie={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},ne=re();function ae(t,e){return null!=(e=null==ne?void 0:ne.isTypeSupported(`${e||"video"}/mp4;codecs="${t}"`))&&e}const se=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,oe=/#EXT-X-MEDIA:(.*)/g,le=/^#EXT(?:INF|-X-TARGETDURATION):/m,ue=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),he=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class m{static findGroup(e,r){for(let t=0;t<e.length;t++){var i=e[t];if(i.id===r)return i}}static convertAVC1ToAVCOTI(t){var e,r=t.split(".");return 2<r.length?(e=r.shift()+".",(e+=parseInt(r.shift()).toString(16))+("000"+parseInt(r.shift()).toString(16)).slice(-4)):t}static resolve(t,e){return Q.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return le.test(t)}static parseMasterPlaylist(t,e){var r,i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Zt(t)},n=[];for(se.lastIndex=0;null!=(r=se.exec(t));)if(r[1]){var a=new B(r[1]),s=(U(i,a,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]),te(i,r[2])),s={attrs:a,bitrate:a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),name:a.NAME,url:m.resolve(s,e)},o=a.decimalResolution("RESOLUTION");o&&(s.width=o.width,s.height=o.height),!function(i,n){["video","audio","text"].forEach(r=>{const e=i.filter(t=>{return t=t,e=r,!!(e=ie[e])&&!0===e[t.slice(0,4)];var e});var t;e.length&&(t=e.filter(t=>0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)),n[r+"Codec"]=(0<t.length?t:e)[0],i=i.filter(t=>-1===e.indexOf(t)))}),n.unknownCodecs=i}((a.CODECS||"").split(/[ ,]+/).filter(t=>t),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=m.convertAVC1ToAVCOTI(s.videoCodec)),null!=(o=s.unknownCodecs)&&o.length||n.push(s),i.levels.push(s)}else if(r[3]){var a=r[3],l=r[4];switch(a){case"SESSION-DATA":var u=new B(l),h=(U(i,u,["DATA-ID","LANGUAGE","VALUE","URI"]),u["DATA-ID"]);h&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[h]=u);break;case"SESSION-KEY":h=ce(l,e,i);h.encrypted&&h.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(h)):V.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${l}"`);break;case"DEFINE":u=new B(l);U(i,u,["NAME","VALUE","QUERYPARAM"]),ee(i,u,e);break;case"CONTENT-STEERING":var c=new B(l);U(i,c,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:m.resolve(c["SERVER-URI"],e),pathwayId:c["PATHWAY-ID"]||"."};break;case"START":i.startTimeOffset=de(l)}}var d=0<n.length&&n.length<i.levels.length;return i.levels=d?n:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(t,e,r){var i={},n=r.levels,a={AUDIO:n.map(t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec})),SUBTITLES:n.map(t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec})),"CLOSED-CAPTIONS":[]};let s=0;for(oe.lastIndex=0;null!==(u=oe.exec(t));){var o,l,u=new B(u[1]),h=u.TYPE;h&&(o=a[h],l=i[h]||[],i[h]=l,U(r,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]),h={attrs:u,bitrate:0,id:s++,groupId:u["GROUP-ID"]||"",instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:h,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?m.resolve(u.URI,e):""},null!=o&&o.length&&(fe(h,u=m.findGroup(o,h.groupId)||o[0],"audioCodec"),fe(h,u,"textCodec")),l.push(h))}return i}static parseLevelPlaylist(t,e,r,i,n,F){var a=new ht(e),s=a.fragments;let o=null,l=0,u=0,h=0,c=0,d=null,f=new lt(i,e),p,g,v,m=-1,y=!1;for(ue.lastIndex=0,a.m3u8=t,a.hasVariableRefs=Zt(t);null!==(p=ue.exec(t));){y&&(y=!1,(f=new lt(i,e)).start=h,f.sn=l,f.cc=c,f.level=r,o)&&(f.initSegment=o,f.rawProgramDateTime=o.rawProgramDateTime,o.rawProgramDateTime=null);var E=p[1];if(E){f.duration=parseFloat(E);var T=(" "+p[2]).slice(1);f.title=T||null,f.tagList.push(T?["INF",E,T]:["INF",E])}else if(p[3])N(f.duration)&&(f.start=h,v&&ve(f,v,a),f.sn=l,f.level=r,f.cc=c,f.urlId=n,s.push(f),T=(" "+p[3]).slice(1),f.relurl=te(a,T),pe(f,d),d=f,h+=f.duration,l++,u=0,y=!0);else if(p[4]){E=(" "+p[4]).slice(1);d?f.setByteRange(E,d):f.setByteRange(E)}else if(p[5])f.rawProgramDateTime=(" "+p[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]),-1===m&&(m=s.length);else if(p=p[0].match(he)){for(g=1;g<p.length&&void 0===p[g];g++);var b=(" "+p[g]).slice(1),A=(" "+p[g+1]).slice(1),_=p[g+2]?(" "+p[g+2]).slice(1):"";switch(b){case"PLAYLIST-TYPE":a.type=A.toUpperCase();break;case"MEDIA-SEQUENCE":l=a.startSN=parseInt(A);break;case"SKIP":var S=new B(A),L=(U(a,S,["RECENTLY-REMOVED-DATERANGES"]),S.decimalInteger("SKIPPED-SEGMENTS"));if(N(L)){for(let t=a.skippedSegments=L;t--;)s.unshift(null);l+=L}L=S.enumeratedString("RECENTLY-REMOVED-DATERANGES");L&&(a.recentlyRemovedDateranges=L.split("\t"));break;case"TARGETDURATION":a.targetduration=Math.max(parseInt(A),1);break;case"VERSION":a.version=parseInt(A);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(A||_)&&f.tagList.push(_?[A,_]:[A]);break;case"DISCONTINUITY":c++,f.tagList.push(["DIS"]);break;case"GAP":f.gap=!0,f.tagList.push([b]);break;case"BITRATE":f.tagList.push([b,A]);break;case"DATERANGE":S=new B(A),L=(U(a,S,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),U(a,S,S.clientAttrs),new nt(S,a.dateRanges[S.ID]));L.isValid||a.skippedSegments?a.dateRanges[L.id]=L:V.warn(`Ignoring invalid DATERANGE tag: "${A}"`),f.tagList.push(["EXT-X-DATERANGE",A]);break;case"DEFINE":var k=new B(A);if(U(a,k,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in k){I=w=R=void 0;var R=a,w=k,I=F;if(w=w.IMPORT,I&&w in I){let t=R.variableList;t||(R.variableList=t={}),t[w]=I[w]}else R.playlistParsingError||(R.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${w}"`))}else ee(a,k,e);break;case"DISCONTINUITY-SEQUENCE":c=parseInt(A);break;case"KEY":I=ce(A,e,a);if(I.isSupported()){if("NONE"===I.method){v=void 0;break}(v=(v=v||{})[I.keyFormat]?G({},v):v)[I.keyFormat]=I}else V.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${A}"`);break;case"START":a.startTimeOffset=de(A);break;case"MAP":R=new B(A);U(a,R,["BYTERANGE","URI"]),f.duration?(ge(w=new lt(i,e),R,r,v),o=w,(f.initSegment=o).rawProgramDateTime&&!f.rawProgramDateTime&&(f.rawProgramDateTime=o.rawProgramDateTime)):(ge(f,R,r,v),o=f,y=!0);break;case"SERVER-CONTROL":k=new B(A);a.canBlockReload=k.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=k.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=0<a.canSkipUntil&&k.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=k.optionalFloat("PART-HOLD-BACK",0),a.holdBack=k.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var D=new B(A);a.partTarget=D.decimalFloatingPoint("PART-TARGET");break;case"PART":{let t=a.partList;t=t||(a.partList=[]);var D=0<u?t[t.length-1]:void 0,C=u++,P=new B(A),P=(U(a,P,["BYTERANGE","URI"]),new ut(P,f,e,C,D));t.push(P),f.duration+=P.duration;break}case"PRELOAD-HINT":C=new B(A);U(a,C,["URI"]),a.preloadHint=C;break;case"RENDITION-REPORT":P=new B(A);U(a,P,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(P);break;default:V.warn("line parsed but not handled: "+p)}}else V.warn("No matches on slow regex match for level playlist!")}d&&!d.relurl?(s.pop(),h-=d.duration,a.partList&&(a.fragmentHint=d)):a.partList&&(pe(f,d),f.cc=c,a.fragmentHint=f,v)&&ve(f,v,a);var x=s.length,O=s[0],M=s[x-1];return 0<(h+=a.skippedSegments*a.targetduration)&&x&&M?(a.averagetargetduration=h/x,x=M.sn,a.endSN="initSegment"!==x?x:0,a.live||(M.endList=!0),O&&(a.startCC=O.cc)):(a.endSN=0,a.startCC=0),a.fragmentHint&&(h+=a.fragmentHint.duration),a.totalduration=h,a.endCC=c,0<m&&function(e,r){let i=e[r];for(let t=r;t--;){var n=e[t];if(!n)return;n.programDateTime=i.programDateTime-1e3*n.duration,i=n}}(s,m),a}}function ce(t,e,r){var t=new B(t),r=(U(r,t,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]),null!=(r=t.METHOD)?r:""),i=t.URI,n=t.hexadecimalInteger("IV"),a=t.KEYFORMATVERSIONS,s=null!=(s=t.KEYFORMAT)?s:"identity",t=(i&&t.IV&&!n&&V.error("Invalid IV: "+t.IV),i?m.resolve(i,e):""),i=(a||"1").split("/").map(Number).filter(Number.isFinite);return new Xt(r,t,s,i,n)}function de(t){t=new B(t).decimalFloatingPoint("TIME-OFFSET");return N(t)?t:null}function fe(t,e,r){e=e[r];e&&(t[r]=e)}function pe(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),N(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}function ge(t,e,r,i){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=r,t.sn="initSegment",i&&(t.levelkeys=i),t.initSegment=null}function ve(t,e,r){t.levelkeys=e;r=r.encryptedFragments;r.length&&r[r.length-1].levelkeys===e||!Object.keys(e).some(t=>e[t].isCommonEncryption)||r.push(t)}var me="manifest",ye="level",E="audioTrack",b="subtitleTrack",A="main",_="audio",Ee="subtitle";function Te(t){t=t.type;switch(t){case E:return _;case b:return Ee;default:return A}}function be(t,e){let r=t.url;return r=void 0!==r&&0!==r.indexOf("data:")?r:e.url}class Ae{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){var t=this["hls"];t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on($.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){var t=this["hls"];t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off($.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){var e=this.hls.config,r=e.pLoader,i=e.loader,r=new(r||i)(e);return this.loaders[t.type]=r}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){e=e.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:me,url:e,deliveryDirectives:null})}onLevelLoading(t,e){var{id:e,level:r,url:i,deliveryDirectives:n}=e;this.load({id:e,level:r,responseType:"text",type:ye,url:i,deliveryDirectives:n})}onAudioTrackLoading(t,e){var{id:e,groupId:r,url:i,deliveryDirectives:n}=e;this.load({id:e,groupId:r,level:null,responseType:"text",type:E,url:i,deliveryDirectives:n})}onSubtitleTrackLoading(t,e){var{id:e,groupId:r,url:i,deliveryDirectives:n}=e;this.load({id:e,groupId:r,level:null,responseType:"text",type:b,url:i,deliveryDirectives:n})}load(e){var r=this.hls.config;let t=this.getInternalLoader(e);if(t){var i=t.context;if(i&&i.url===e.url)return void V.trace("[playlist-loader]: playlist request ongoing");V.log("[playlist-loader]: aborting previous loader for type: "+e.type),t.abort()}let n;if(n=e.type===me?r.manifestLoadPolicy.default:G({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),t=this.createInternalLoader(e),null!=(i=e.deliveryDirectives)&&i.part){let t;e.type===ye&&null!==e.level?t=this.hls.levels[e.level].details:e.type===E&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===b&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t&&(r=t.partTarget,i=t.targetduration,r)&&i&&(r=1e3*Math.max(3*r,.8*i),n=G({},n,{maxTimeToFirstByteMs:Math.min(r,n.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(r,n.maxTimeToFirstByteMs)}))}i=n.errorRetry||n.timeoutRetry||{},r={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:i.maxNumRetry||0,retryDelay:i.retryDelayMs||0,maxRetryDelay:i.maxRetryDelayMs||0};t.load(e,r,{onSuccess:(t,e,r,i)=>{var n=this.getInternalLoader(r),a=(this.resetInternalLoader(r.type),t.data);0!==a.indexOf("#EXTM3U")?this.handleManifestParsingError(t,r,new Error("no EXTM3U delimiter"),i||null,e):(e.parsing.start=performance.now(),m.isMediaPlaylist(a)?this.handleTrackOrLevelPlaylist(t,e,r,i||null,n):this.handleMasterPlaylist(t,e,r,i))},onError:(t,e,r,i)=>{this.handleNetworkError(e,r,!1,t,i)},onTimeout:(t,e,r)=>{this.handleNetworkError(e,r,!0,void 0,t)}})}handleMasterPlaylist(t,e,r,i){var n,a,s,o,l,u=this.hls,h=t.data,c=be(t,r),d=m.parseMasterPlaylist(h,c);d.playlistParsingError?this.handleManifestParsingError(t,r,d.playlistParsingError,i,e):({contentSteering:t,levels:r,sessionData:n,sessionKeys:a,startTimeOffset:s,variableList:o}=d,{AUDIO:h=[],SUBTITLES:d,"CLOSED-CAPTIONS":l}=(this.variableList=o,m.parseMasterPlaylistMedia(h,c,d)),h.length&&!h.some(t=>!t.url)&&r[0].audioCodec&&!r[0].attrs.AUDIO&&(V.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new B({}),bitrate:0,url:""})),u.trigger($.MANIFEST_LOADED,{levels:r,audioTracks:h,subtitles:d,captions:l,contentSteering:t,url:c,stats:e,networkDetails:i,sessionData:n,sessionKeys:a,startTimeOffset:s,variableList:o}))}handleTrackOrLevelPlaylist(t,e,r,i,n){var a=this.hls,{id:s,level:o,type:l}=r,u=be(t,r),s=N(s)?s:0,o=N(o)?o:s,h=Te(r),o=m.parseLevelPlaylist(t.data,u,o,h,s,this.variableList);l===me&&(h={attrs:new B({}),bitrate:0,details:o,name:"",url:u},a.trigger($.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:u,stats:e,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})),e.parsing.end=performance.now(),r.levelDetails=o,this.handlePlaylistLoaded(o,t,e,r,i,n)}handleManifestParsingError(t,e,r,i,n){this.hls.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.MANIFEST_PARSING_ERROR,fatal:e.type===me,url:t.url,err:r,error:r,reason:r.message,response:t,context:e,networkDetails:i,stats:n})}handleNetworkError(t,e,r=!1,i,n){let a=`A network ${r?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading `+t.type;t.type===ye?a+=`: ${t.level} id: `+t.id:t.type!==E&&t.type!==b||(a+=` id: ${t.id} group-id: "${t.groupId}"`);var s=new Error(a);V.warn("[playlist-loader]: "+a);let o=H.UNKNOWN,l=!1;var u=this.getInternalLoader(t);switch(t.type){case me:o=r?H.MANIFEST_LOAD_TIMEOUT:H.MANIFEST_LOAD_ERROR,l=!0;break;case ye:o=r?H.LEVEL_LOAD_TIMEOUT:H.LEVEL_LOAD_ERROR,l=!1;break;case E:o=r?H.AUDIO_TRACK_LOAD_TIMEOUT:H.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case b:o=r?H.SUBTITLE_TRACK_LOAD_TIMEOUT:H.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(t.type);u={type:K.NETWORK_ERROR,details:o,fatal:l,url:t.url,loader:u,context:t,error:s,networkDetails:e,stats:n};i&&(s=(null==e?void 0:e.url)||t.url,u.response=f({url:s,data:void 0},i)),this.hls.trigger($.ERROR,u)}handlePlaylistLoaded(t,e,r,i,n,a){var s=this.hls,{type:o,level:l,id:u,groupId:h,deliveryDirectives:c}=i,d=be(e,i),f=Te(i),p="number"==typeof i.level&&f===A?l:void 0;if(t.fragments.length){t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));var l=t.playlistParsingError;if(l)s.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:l,reason:l.message,response:e,context:i,level:p,parent:f,networkDetails:n,stats:r});else switch(t.live&&a&&(a.getCacheAge&&(t.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),o){case me:case ye:s.trigger($.LEVEL_LOADED,{details:t,level:p||0,id:u||0,stats:r,networkDetails:n,deliveryDirectives:c});break;case E:s.trigger($.AUDIO_TRACK_LOADED,{details:t,id:u||0,groupId:h||"",stats:r,networkDetails:n,deliveryDirectives:c});break;case b:s.trigger($.SUBTITLE_TRACK_LOADED,{details:t,id:u||0,groupId:h||"",stats:r,networkDetails:n,deliveryDirectives:c})}}else l=new Error("No Segments found in Playlist"),s.trigger($.ERROR,{type:K.NETWORK_ERROR,details:H.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:l,reason:l.message,response:e,context:i,level:p,parent:f,networkDetails:n,stats:r})}}function _e(t,e){let r;try{r=new Event("addtrack")}catch(t){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function Se(e,r){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(r.id))try{if(e.addCue(r),!e.cues.getCueById(r.id))throw new Error("addCue is failed for: "+r)}catch(t){V.debug("[texttrack-utils]: "+t);try{var i=new self.TextTrackCue(r.startTime,r.endTime,r.text);i.id=r.id,e.addCue(i)}catch(t){V.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+t)}}"disabled"===t&&(e.mode=t)}function Le(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function ke(e,t,r,i){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&0<e.cues.length){var a=function(r,i,n){var a=[],s=function(t,e){if(e<t[0].startTime)return 0;var r=t.length-1;if(e>t[r].endTime)return-1;let i=0,n=r;for(;i<=n;){var a=Math.floor((n+i)/2);if(e<t[a].startTime)n=a-1;else{if(!(e>t[a].startTime&&i<r))return a;i=a+1}}return t[i].startTime-e<e-t[n].startTime?i:n}(r,i);if(-1<s)for(let t=s,e=r.length;t<e;t++){var o=r[t];if(o.startTime>=i&&o.endTime<=n)a.push(o);else if(o.startTime>n)return a}return a}(e.cues,t,r);for(let t=0;t<a.length;t++)i&&!i(a[t])||e.removeCue(a[t])}"disabled"===n&&(e.mode=n)}var Re="org.id3",we="com.apple.quicktime.HLS",Ie="https://aomedia.org/emsg/ID3";function De(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const Ce=(()=>{var t=De();try{new t(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Pe(t,e){return t.getTime()/1e3-e}class xe{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,e){this.media=e.media}onMediaDetaching(){this.id3Track&&(Le(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){t=this.getID3Track(t.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return _e(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(this.media){var{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:i}}=this["hls"];if(r||i){var n=e["samples"],a=(this.id3Track||(this.id3Track=this.createTrack(this.media)),De());for(let t=0;t<n.length;t++){var s=n[t].type;if((s!==Ie||r)&&i){var o=Ct(n[t].data);if(o){var l=n[t].pts;let e=l+n[t].duration;(e=e>Ce?Ce:e)-l<=0&&(e=l+.25);for(let t=0;t<o.length;t++){var u,h=o[t];Dt(h)||(this.updateId3CueEnds(l,s),(u=new a(l,e,"")).value=h,s&&(u.type=s),this.id3Track.addCue(u))}}}}}}}updateId3CueEnds(e,r){var t,i=null==(t=this.id3Track)?void 0:t.cues;if(i)for(let t=i.length;t--;){var n=i[t];n.type===r&&n.startTime<e&&n.endTime===Ce&&(n.endTime=e)}}onBufferFlushing(t,{startOffset:e,endOffset:r,type:i}){var{id3Track:n,hls:a}=this;if(a){const{enableEmsgMetadataCues:s,enableID3MetadataCues:o}=a["config"];if(n&&(s||o)){let t;ke(n,e,r,t="audio"===i?t=>t.type===Re&&o:"video"===i?t=>t.type===Ie&&s:t=>t.type===Re&&o||t.type===Ie&&s)}}}onLevelUpdated(t,{details:e}){if(this.media&&e.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){const{dateRangeCuesAppended:p,id3Track:i}=this,g=e["dateRanges"],v=Object.keys(g);if(i){var r=Object.keys(p).filter(t=>!v.includes(t));for(let t=r.length;t--;){const m=r[t];Object.keys(p[m].cues).forEach(t=>{i.removeCue(p[m].cues[t])}),delete p[m]}}e=e.fragments[e.fragments.length-1];if(0!==v.length&&N(null==e?void 0:e.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));var n,a=e.programDateTime/1e3-e.start,s=De();for(let t=0;t<v.length;t++){var o=v[t];const y=g[o];var l=p[o],u=(null==l?void 0:l.cues)||{};let r=(null==l?void 0:l.durationKnown)||!1;var h=Pe(y.startDate,a);let i=Ce;var c=y.endDate,d=(c?(i=Pe(c,a),r=!0):y.endOnNext&&!r&&(c=v.reduce((t,e)=>{var r=g[e];return r.class===y.class&&r.id!==e&&r.startDate>y.startDate&&t.push(r),t},[]).sort((t,e)=>t.startDate.getTime()-e.startDate.getTime())[0])&&(i=Pe(c.startDate,a),r=!0),Object.keys(y.attr));for(let t=0;t<d.length;t++){var f=d[t];if("ID"!==(n=f)&&"CLASS"!==n&&"START-DATE"!==n&&"DURATION"!==n&&"END-DATE"!==n&&"END-ON-NEXT"!==n){let e=u[f];if(e)r&&!l.durationKnown&&(e.endTime=i);else{let t=y.attr[f];e=new s(h,i,""),"SCTE35-OUT"!==(n=f)&&"SCTE35-IN"!==n||(t=(n=t,Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer)),e.value={key:f,data:t},e.type=we,e.id=o,this.id3Track.addCue(e),u[f]=e}}}p[o]={cues:u,dateRange:y,durationKnown:r}}}}}}class Oe{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){var{config:t,levelDetails:e}=this;return void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){var t=this["levelDetails"];if(null===t)return null;var{holdBack:t,partHoldBack:e,targetduration:r}=t,{liveSyncDuration:i,liveSyncDurationCount:n,lowLatencyMode:a}=this.config,s=this.hls.userConfig;let o=a&&e||t;return(o=s.liveSyncDuration||s.liveSyncDurationCount||0===o?void 0!==i?i:n*r:o)+Math.min(+this.stallCount,r)}get liveSyncPosition(){var t,e=this.estimateLiveEdge(),r=this.targetLatency,i=this.levelDetails;return null===e||null===r||null===i?null:(t=i.edge,e=e-r-this.edgeStalled,r=t-i.totalduration,t=t-(this.config.lowLatencyMode&&i.partTarget||i.targetduration),Math.min(Math.max(r,e),t))}get drift(){var t=this["levelDetails"];return null===t?1:t.drift}get edgeStalled(){var t,e=this["levelDetails"];return null===e?0:(t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration),Math.max(e.age-t,0))}get forwardBufferLength(){var t,{media:e,levelDetails:r}=this;return e&&r?((t=e.buffered.length)?e.buffered.end(t-1):r.edge)-this.currentTime:0}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on($.ERROR,this.onError,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off($.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){(this.levelDetails=e).advanced&&this.timeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,e){e.details===H.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(e=this.levelDetails))&&e.live&&V.warn("[playback-rate-controller]: Stall detected, adjusting target latency")}timeupdate(){var t,e,r,{media:i,levelDetails:n}=this;i&&n&&(this.currentTime=i.currentTime,null!==(e=this.computeLatency()))&&(this._latency=e,{lowLatencyMode:r,maxLiveSyncPlaybackRate:t}=this.config,r)&&1!==t&&null!==(r=this.targetLatency)&&(e=e-r,r=Math.min(this.maxLatency,r+n.targetduration),n.live&&e<r&&.05<e&&1<this.forwardBufferLength?(n=Math.min(2,Math.max(1,t)),r=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20,i.playbackRate=Math.min(n,Math.max(1,r))):1!==i.playbackRate&&0!==i.playbackRate&&(i.playbackRate=1))}estimateLiveEdge(){var t=this["levelDetails"];return null===t?null:t.edge+t.age}computeLatency(){var t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}const Me=["NONE","TYPE-0","TYPE-1",null];var Fe="",Ne="YES",Be="v2";class Ue{constructor(t,e,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=r}addDirectives(t){t=new self.URL(t);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class je{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(t){t%=this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var t;return null==(t=this.audioGroupIds)?void 0:t[this.urlId]}get textGroupId(){var t;return null==(t=this.textGroupIds)?void 0:t[this.urlId]}addFallback(t){this.url.push(t.url),this._attrs.push(t.attrs)}}function Ge(r,i){var n=i.startPTS;if(N(n)){let t=0,e;(e=i.sn>r.sn?(t=n-r.start,r):(t=r.start-n,i)).duration!==t&&(e.duration=t)}else i.sn>r.sn?r.cc===i.cc&&r.minEndPTS?i.start=r.start+(r.minEndPTS-r.start):i.start=r.start+r.duration:i.start=Math.max(r.start-i.duration,0)}function $e(t,e,r,i,n,a){i-r<=0&&(V.warn("Fragment should have a positive duration",e),i=r+e.duration,a=n+e.duration);let s=r,o=i;var l=e.startPTS,u=e.endPTS,h=(N(l)&&(h=Math.abs(l-r),N(e.deltaPTS)?e.deltaPTS=Math.max(h,e.deltaPTS):e.deltaPTS=h,s=Math.max(r,l),r=Math.min(r,l),n=Math.min(n,e.startDTS),o=Math.min(i,u),i=Math.max(i,u),a=Math.max(a,e.endDTS)),r-e.start),l=(0!==e.start&&(e.start=r),e.duration=i-e.start,e.startPTS=r,e.maxStartPTS=s,e.startDTS=n,e.endPTS=i,e.minEndPTS=o,e.endDTS=a,e.sn);if(!t||l<t.startSN||l>t.endSN)return 0;let c;var u=l-t.startSN,d=t.fragments;for(d[u]=e,c=u;0<c;c--)Ge(d[c],d[c-1]);for(c=u;c<d.length-1;c++)Ge(d[c],d[c+1]);return t.fragmentHint&&Ge(d[d.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,h}function Ke(t,r){let i=null;var e=t.fragments;for(let t=e.length-1;0<=t;t--){var n=e[t].initSegment;if(n){i=n;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let a=0,s;var o=t,l=r,u=(t,e)=>{t.relurl&&(a=t.cc-e.cc),N(t.startPTS)&&N(t.endPTS)&&(e.start=e.startPTS=t.startPTS,e.startDTS=t.startDTS,e.maxStartPTS=t.maxStartPTS,e.endPTS=t.endPTS,e.endDTS=t.endDTS,e.minEndPTS=t.minEndPTS,e.duration=t.endPTS-t.startPTS,e.duration&&(s=e),r.PTSKnown=r.alignedSliding=!0),e.elementaryStreams=t.elementaryStreams,e.loader=t.loader,e.stats=t.stats,e.urlId=t.urlId,t.initSegment&&(e.initSegment=t.initSegment,i=t.initSegment)},h=l.skippedSegments,c=Math.max(o.startSN,l.startSN)-l.startSN,d=(o.fragmentHint?1:0)+(h?l.endSN:Math.min(o.endSN,l.endSN))-l.startSN,f=l.startSN-o.startSN,p=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,g=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments;for(let e=c;e<=d;e++){var v=g[f+e];let t=p[e];h&&!t&&e<h&&(t=l.fragments[e]=v),v&&t&&u(v,t)}if(i&&(r.fragmentHint?r.fragments.concat(r.fragmentHint):r.fragments).forEach(t=>{var e;t.initSegment&&t.initSegment.relurl!==(null==(e=i)?void 0:e.relurl)||(t.initSegment=i)}),r.skippedSegments)if(r.deltaUpdateFailed=r.fragments.some(t=>!t),r.deltaUpdateFailed){V.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=r.skippedSegments;t--;)r.fragments.shift();r.startSN=r.fragments[0].sn,r.startCC=r.fragments[0].cc}else r.canSkipDateRanges&&(r.dateRanges=function(t,r,e){const i=G({},t);e&&e.forEach(t=>{delete i[t]});return Object.keys(r).forEach(t=>{var e=new nt(r[t].attr,i[t]);e.isValid?i[t]=e:V.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(r[t].attr)}"`)}),i}(t.dateRanges,r.dateRanges,r.recentlyRemovedDateranges));var m=r.fragments;if(a){V.warn("discontinuity sliding from playlist, take drift into account");for(let t=0;t<m.length;t++)m[t].cc+=a}r.skippedSegments&&(r.startCC=r.fragments[0].cc);var y=t.partList,E=r.partList,T=(t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats};if(y&&E){let r=0;for(let t=0,e=y.length;t<=e;t++){var b=y[t],A=E[t+r];b&&A&&b.index===A.index&&b.fragment.sn===A.fragment.sn?T(b,A):r--}}s?$e(r,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):He(t,r),m.length&&(r.totalduration=r.edge-m[0].start),r.driftStartTime=t.driftStartTime,r.driftStart=t.driftStart;o=r.advancedDateTime;r.advanced&&o?(c=r.edge,r.driftStart||(r.driftStartTime=o,r.driftStart=c),r.driftEndTime=o,r.driftEnd=c):(r.driftEndTime=t.driftEndTime,r.driftEnd=t.driftEnd,r.advancedDateTime=t.advancedDateTime)}function He(t,e){var r=e.startSN+e.skippedSegments-t.startSN,t=t.fragments;r<0||r>=t.length||Ve(e,t[r].start)}function Ve(e,r){if(r){var i=e.fragments;for(let t=e.skippedSegments;t<i.length;t++)i[t].start+=r;e.fragmentHint&&(e.fragmentHint.start+=r)}}function We(t,e,r){return null!=t&&t.details?Ye(null==(t=t.details)?void 0:t.partList,e,r):null}function Ye(e,r,i){if(e)for(let t=e.length;t--;){var n=e[t];if(n.index===i&&n.fragment.sn===r)return n}return null}function qe(t){switch(t.details){case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_TIMEOUT:case H.LEVEL_LOAD_TIMEOUT:case H.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ze(t,e){e=qe(e);return t.default[`${e?"timeout":"error"}Retry`]}function Qe(t,e){e="linear"===t.backoff?1:Math.pow(2,e);return Math.min(e*t.retryDelayMs,t.maxRetryDelayMs)}function Xe(t){return f(f({},t),{errorRetry:null,timeoutRetry:null})}function Je(t,e,r,i){return!!t&&e<t.maxNumRetry&&(0===(e=i)&&!1===navigator.onLine||!!e&&(e<400||499<e)||!!r)}const Ze={search:function(t,e){let r=0,i=t.length-1;for(;r<=i;){var n,a,s=e(a=t[n=(r+i)/2|0]);if(0<s)r=1+n;else{if(!(s<0))return a;i=n-1}}return null}};function tr(e,r,i){if(null!==r&&Array.isArray(e)&&e.length&&N(r)){var t=e[0].programDateTime;if(!(r<(t||0))){t=e[e.length-1].endProgramDateTime;if(!((t||0)<=r)){i=i||0;for(let t=0;t<e.length;++t){var n=e[t];if(function(t,e,r){e=1e3*Math.min(e,r.duration+(r.deltaPTS||0)),r=r.endProgramDateTime||0;return t<r-e}(r,i,n))return n}}}}return null}function er(t,e,r=0,i=0){let n=null;return t?n=e[t.sn-e[0].sn+1]||null:0===r&&0===e[0].start&&(n=e[0]),n&&0===rr(r,i,n)||!(e=Ze.search(e,rr.bind(null,r,i)))||e===t&&n?n:e}function rr(t=0,e=0,r){return r.start<=t&&r.start+r.duration>t?0:(e=Math.min(e,r.duration+(r.deltaPTS||0)),r.start+r.duration-e<=t?1:r.start-e>t&&r.start?-1:0)}var ir=0,nr=2,ar=5,sr=0,or=1,lr=2;class ur{constructor(t,e){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=V.log.bind(V,e+":"),this.warn=V.warn.bind(V,e+":"),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(i,n){var a=null==n?void 0:n.renditionReports;if(a){let r=-1;for(let t=0;t<a.length;t++){var s=a[t];let e;try{e=new self.URL(s.URI,n.url).href}catch(t){V.warn("Could not construct new URL for Rendition Report: "+t),e=s.URI||""}if(e===i){r=t;break}e===i.substring(0,e.length)&&(r=t)}if(-1!==r){var e=a[r],o=parseInt(e["LAST-MSN"])||(null==n?void 0:n.lastPartSn);let t=parseInt(e["LAST-PART"])||(null==n?void 0:n.lastPartIndex);return this.hls.config.lowLatencyMode&&(e=Math.min(n.age-n.partTarget,n.targetduration),0<=t)&&e>n.partTarget&&(t+=1),new Ue(o,0<=t?t:void 0,Fe)}}}loadPlaylist(t){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(t)}playlistLoaded(t,n,a){var{details:s,stats:o}=n,l=self.performance.now(),u=o.loading.first?Math.max(0,l-o.loading.first):0;if(s.advancedDateTime=Date.now()-u,s.live||null!=a&&a.live){if(s.reloaded(a),a&&this.log(`live playlist ${t} `+(s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:"MISSED")),a&&0<s.fragments.length&&Ke(a,s),this.canLoad&&s.live){let e,r=void 0,i=void 0;if(s.canBlockReload&&s.endSN&&s.advanced){var u=this.hls.config.lowLatencyMode,h=s.lastPartSn,c=s.endSN,d=s.lastPartIndex,f=h===c,h=(-1!==d?(r=f?c+1:h,i=f?u?0:d:d+1):r=c+1,s.age),d=h+s.ageHeader;let t=Math.min(d-s.partTarget,1.5*s.targetduration);if(0<t&&(a&&t>a.tuneInGoal?(this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${t} with playlist age: `+s.age),t=0):(c=Math.floor(t/s.targetduration),r+=c,void 0!==i&&(d=Math.round(t%s.targetduration/s.partTarget),i+=d),this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${h.toFixed(2)}s goal: ${t} skip sn ${c} to part `+i)),s.tuneInGoal=t),e=this.getDeliveryDirectives(s,n.deliveryDirectives,r,i),u||!f)return void this.loadPlaylist(e)}else s.canBlockReload&&(e=this.getDeliveryDirectives(s,n.deliveryDirectives,r,i));a=this.hls.mainForwardBufferInfo,d=a?a.end-a.len:0,h=function(t,e){let r=1e3*t.targetduration;return t.updated?(t=t.fragments).length&&4*r>e&&(e=1e3*t[t.length-1].duration)<r&&(r=e):r/=2,Math.round(r)}(s,1e3*(s.edge-d)),c=(s.updated&&l>this.requestScheduled+h&&(this.requestScheduled=o.loading.start),void 0!==r&&s.canBlockReload?this.requestScheduled=o.loading.first+h-(1e3*s.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+h<l?this.requestScheduled=l:this.requestScheduled-l<=0&&(this.requestScheduled+=h),this.requestScheduled-l),c=Math.max(0,c);this.log(`reload live playlist ${t} in ${Math.round(c)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(e),c)}}else this.clearTimer()}getDeliveryDirectives(t,e,r,i){let n=function(t,e){var{canSkipUntil:t,canSkipDateRanges:r,endSN:i}=t;return t&&(void 0!==e?e-i:0)<t?r?Be:Ne:Fe}(t,r);return null!=e&&e.skip&&t.deltaUpdateFailed&&(r=e.msn,i=e.part,n=Fe),new Ue(r,i,n)}checkRetry(t){var e=t.details,r=qe(t),i=t.errorAction,{action:n,retryCount:a=0,retryConfig:s}=i||{},n=!!i&&!!s&&(n===ar||!i.resolved&&n===nr);if(n){if(this.requestScheduled=-1,a>=s.maxNumRetry)return!1;r&&null!=(r=t.context)&&r.deliveryDirectives?(this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist()):(r=Qe(s,a),this.timer=self.setTimeout(()=>this.loadPlaylist(),r),this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${e}" in ${r}ms`)),t.levelRetry=!0,i.resolved=!0}return n}}let hr;class cr extends ur{constructor(t,e){super(t,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){var t=this["hls"];t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.ERROR,this.onError,this)}_unregisterListeners(){var t=this["hls"];t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const o=[],l={};let u;e.levels.forEach(t=>{var e=t.attrs,{AUDIO:r,CODECS:e,"FRAME-RATE":i,"PATHWAY-ID":n,RESOLUTION:a,SUBTITLES:s}=(-1!==(null==(r=t.audioCodec)?void 0:r.indexOf("mp4a.40.34"))&&(hr=hr||/chrome|firefox/i.test(navigator.userAgent))&&(t.audioCodec=void 0),e),n=`${n||"."}-`+t.bitrate+`-${a}-${i}-`+e;(u=l[n])?u.addFallback(t):(u=new je(t),l[n]=u,o.push(u)),dr(u,"audio",r),dr(u,"text",s)}),this.filterAndSortMediaOptions(o,e)}filterAndSortMediaOptions(t,r){let i=[],n=[],a=!1,s=!1,o=!1,l=t.filter(({audioCodec:t,videoCodec:e,width:r,height:i,unknownCodecs:n})=>(a=a||!(!r||!i),s=s||!!e,o=o||!!t,!(null!=n&&n.length)&&(!t||ae(t,"audio"))&&(!e||ae(e,"video"))));if(0===(l=(a||s)&&o?l.filter(({videoCodec:t,width:e,height:r})=>!!t||!(!e||!r)):l).length)Promise.resolve().then(()=>{var t;this.hls&&(t=new Error("no level with compatible codecs found in manifest"),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:r.url,error:t,reason:t.message}))});else{r.audioTracks&&fr(i=r.audioTracks.filter(t=>!t.audioCodec||ae(t.audioCodec,"audio"))),r.subtitles&&fr(n=r.subtitles);var u=l.slice(0);l.sort((t,e)=>t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"]?(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1:t.bitrate!==e.bitrate?t.bitrate-e.bitrate:t.attrs["FRAME-RATE"]!==e.attrs["FRAME-RATE"]?t.attrs.decimalFloatingPoint("FRAME-RATE")-e.attrs.decimalFloatingPoint("FRAME-RATE"):t.attrs.SCORE!==e.attrs.SCORE?t.attrs.decimalFloatingPoint("SCORE")-e.attrs.decimalFloatingPoint("SCORE"):a&&t.height!==e.height?t.height-e.height:0);let e=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l)).length!==u.length)for(let t=0;t<u.length;t++)if(u[t].pathwayId===l[0].pathwayId){e=u[t];break}this._levels=l;for(let t=0;t<l.length;t++)if(l[t]===e){this._firstLevel=t,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: `+e.bitrate);break}t=o&&!s,t={levels:l,audioTracks:i,subtitleTracks:n,sessionData:r.sessionData,sessionKeys:r.sessionKeys,firstLevel:this._firstLevel,stats:r.stats,audio:o,video:s,altAudio:!t&&i.some(t=>!!t.url)};this.hls.trigger($.MANIFEST_PARSED,t),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(t){var e=this._levels;if(0!==e.length){if(t<0||t>=e.length){var r=new Error("invalid level idx"),i=t<0;if(this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.LEVEL_SWITCH_ERROR,level:t,fatal:i,error:r,reason:r.message}),i)return;t=Math.min(t,e.length-1)}var r=this.currentLevelIndex,i=this.currentLevel,n=i?i.attrs["PATHWAY-ID"]:void 0,e=e[t],a=e.attrs["PATHWAY-ID"];this.currentLevelIndex=t,this.currentLevel=e,r===t&&e.details&&i&&n===a||(this.log(`Switching to level ${t}${a?" with Pathway "+a:""} from level `+r+(n?" with Pathway "+n:"")),delete(a=G({},e,{level:t,maxBitrate:e.maxBitrate,attrs:e.attrs,uri:e.uri,urlId:e.urlId}))._attrs,delete a._urlId,this.hls.trigger($.LEVEL_SWITCHING,a),(r=e.details)&&!r.live)||(n=this.switchParams(e.uri,null==i?void 0:i.details),this.loadPlaylist(n))}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){var t;return void 0===this._startLevel?void 0!==(t=this.hls.config.startLevel)?t:this._firstLevel:this._startLevel}set startLevel(t){this._startLevel=t}onError(t,e){!e.fatal&&e.context&&e.context.type===ye&&e.context.level===this.level&&this.checkRetry(e)}onFragLoaded(t,{frag:e}){void 0!==e&&e.type===A&&void 0!==(e=this._levels[e.level])&&(e.loadError=0)}onLevelLoaded(t,e){var{level:r,details:i}=e,n=this._levels[r];n?r===this.currentLevelIndex?(0===n.fragmentError&&(n.loadError=0),this.playlistLoaded(r,e,n.details)):null!=(n=e.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0):(this.warn("Invalid level index "+r),null!=(n=e.deliveryDirectives)&&n.skip&&(i.deltaUpdateFailed=!0))}onAudioTrackSwitched(t,e){var r=this.currentLevel;if(r){var i=this.hls.audioTracks[e.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==i){let e=-1;for(let t=0;t<r.audioGroupIds.length;t++)if(r.audioGroupIds[t]===i){e=t;break}-1!==e&&e!==r.urlId&&(r.urlId=e,this.canLoad)&&this.startLoad()}}}loadPlaylist(e){super.loadPlaylist();var r=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){var n=i.urlId;let t=i.uri;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}var a=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${r}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${n+1}/${i.url.length} `+t),this.clearTimer(),this.hls.trigger($.LEVEL_LOADING,{url:t,level:r,id:n,deliveryDirectives:e||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(r,i){const n=(t,e)=>e!==i;var t=this._levels.filter((t,e)=>!(e===r&&(1<t.url.length&&void 0!==i?(t.url=t.url.filter(n),t.audioGroupIds&&(t.audioGroupIds=t.audioGroupIds.filter(n)),t.textGroupIds&&(t.textGroupIds=t.textGroupIds.filter(n)),t.urlId=0):(this.steering&&this.steering.removeLevel(t),1))));this.hls.trigger($.LEVELS_UPDATED,{levels:t})}onLevelsUpdated(t,{levels:e}){e.forEach((t,e)=>{t=t.details;null!=t&&t.fragments&&t.fragments.forEach(t=>{t.level=e})}),this._levels=e}}function dr(t,e,r){r&&("audio"===e?(t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds[t.url.length-1]=r):"text"===e&&(t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds[t.url.length-1]=r))}function fr(t){const r={};t.forEach(t=>{var e=t.groupId||"";t.id=r[e]=r[e]||0,r[e]++})}var pr="NOT_LOADED",gr="APPENDING",vr="PARTIAL",mr="OK";class yr{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){var t=this["hls"];t.on($.BUFFER_APPENDED,this.onBufferAppended,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this),t.on($.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){var t=this["hls"];t.off($.BUFFER_APPENDED,this.onBufferAppended,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this),t.off($.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){var r=this.activePartLists[t];if(r)for(let t=r.length;t--;){var i=r[t];if(!i)break;var n=i.end;if(i.start<=e&&null!==n&&e<=n)return i}return this.getBufferedFrag(e,t)}getBufferedFrag(e,r){var i=this["fragments"],n=Object.keys(i);for(let t=n.length;t--;){var a=i[n[t]];if((null==a?void 0:a.body.type)===r&&a.buffered){a=a.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(r,i,n,t){this.timeRanges&&(this.timeRanges[r]=i);const a=(null==t?void 0:t.fragment.sn)||-1;Object.keys(this.fragments).forEach(t=>{const e=this.fragments[t];!e||a>=e.body.sn||(e.buffered||e.loaded?(t=e.range[r])&&t.time.some(t=>{t=!this.isTimeBuffered(t.startPTS,t.endPTS,i);return t&&this.removeFragment(e.body),t}):e.body.type===n&&this.removeFragment(e.body))})}detectPartialFragments(t){const i=this.timeRanges,{frag:n,part:a}=t;if(i&&"initSegment"!==n.sn){t=Tr(n);const s=this.fragments[t];if(!(!s||s.buffered&&n.gap)){const o=!n.relurl;Object.keys(i).forEach(t=>{var e,r=n.elementaryStreams[t];r&&(e=i[t],r=o||!0===r.partial,s.range[t]=this.getBufferedTimes(n,a,r,e))}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,s.body.endList&&(this.endListFragments[s.body.type]=s),Er(s)||this.removeParts(n.sn-1,n.type)):this.removeFragment(s.body)}}}removeParts(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter(t=>t.fragment.sn>=e))}fragBuffered(t,e){var r=Tr(t);let i=this.fragments[r];!i&&e&&(i=this.fragments[r]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap)&&(this.hasGaps=!0),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(t,e,r,i){var n={time:[],partial:r},a=t.start,s=t.end,o=t.minEndPTS||s,l=t.maxStartPTS||a;for(let t=0;t<i.length;t++){var u=i.start(t)-this.bufferPadding,h=i.end(t)+this.bufferPadding;if(u<=l&&o<=h){n.time.push({startPTS:Math.max(a,i.start(t)),endPTS:Math.min(s,i.end(t))});break}if(a<h&&u<s)n.partial=!0,n.time.push({startPTS:Math.max(a,i.start(t)),endPTS:Math.min(s,i.end(t))});else if(s<=u)break}return n}getPartialFragment(e){let r=null,i,n,a,s=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(t=>{t=l[t];t&&Er(t)&&(n=t.body.start-o,a=t.body.end+o,e>=n)&&e<=a&&(i=Math.min(e-n,a-e),s<=i)&&(r=t.body,s=i)}),r}isEndListAppended(t){t=this.endListFragments[t];return void 0!==t&&(t.buffered||Er(t))}getState(t){t=Tr(t),t=this.fragments[t];return t?t.buffered?Er(t)?vr:mr:gr:pr}isTimeBuffered(e,r,i){var n,a;for(let t=0;t<i.length;t++){if(n=i.start(t)-this.bufferPadding,a=i.end(t)+this.bufferPadding,n<=e&&r<=a)return!0;if(r<=n)return!1}return!1}onFragLoaded(t,e){var r,{frag:i,part:n}=e;"initSegment"===i.sn||i.bitrateTest||(r=Tr(i),this.fragments[r]={body:i,appendedPTS:null,loaded:n?null:e,buffered:!1,range:Object.create(null)})}onBufferAppended(t,e){const{frag:r,part:i,timeRanges:n}=e;if("initSegment"!==r.sn){const a=r.type;if(i){let t=this.activePartLists[a];t||(this.activePartLists[a]=t=[]),t.push(i)}this.timeRanges=n,Object.keys(n).forEach(t=>{var e=n[t];this.detectEvictedFragments(t,e,a,i)})}}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){t=Tr(t);return!!this.fragments[t]}hasParts(t){return!(null==(t=this.activePartLists[t])||!t.length)}removeFragmentsInRange(r,i,n,a,s){a&&!this.hasGaps||Object.keys(this.fragments).forEach(t=>{var e,t=this.fragments[t];!t||(e=t.body).type!==n||a&&!e.gap||e.start<i&&e.end>r&&(t.buffered||s)&&this.removeFragment(e)})}removeFragment(t){var e=Tr(t),r=(t.stats.loaded=0,t.clearElementaryStreamInfo(),this.activePartLists[t.type]);if(r){const i=t.sn;this.activePartLists[t.type]=r.filter(t=>t.fragment.sn!==i)}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Er(t){var e;return t.buffered&&(t.body.gap||(null==(e=t.range.video)?void 0:e.partial)||(null==(e=t.range.audio)?void 0:e.partial)||(null==(e=t.range.audiovideo)?void 0:e.partial))}function Tr(t){return`${t.type}_${t.level}_${t.urlId}_`+t.sn}const br=Math.pow(2,17);class Ar{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(o,l){const u=o.url;if(!u)return Promise.reject(new Lr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:o,error:new Error("Fragment does not have a "+(u?"part list":"url")),networkDetails:null}));this.abort();const r=this.config,h=r.fLoader,c=r.loader;return new Promise((a,n)=>{if(this.loader&&this.loader.destroy(),o.gap){if(o.tagList.some(t=>"GAP"===t[0]))return void n(Sr(o));o.gap=!1}const s=this.loader=o.loader=new(h||c)(r);var t=_r(o),e=Xe(r.fragLoadPolicy.default);const i={loadPolicy:e,timeout:e.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===o.sn?1/0:br};o.stats=s.stats,s.load(t,i,{onSuccess:(t,e,r,i)=>{this.resetLoader(o,s);let n=t.data;r.resetIV&&o.decryptdata&&(o.decryptdata.iv=new Uint8Array(n.slice(0,16)),n=n.slice(16)),a({frag:o,part:null,payload:n,networkDetails:i})},onError:(t,e,r,i)=>{this.resetLoader(o,s),n(new Lr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:o,response:f({url:u,data:void 0},t),error:new Error(`HTTP Error ${t.code} `+t.text),networkDetails:r,stats:i}))},onAbort:(t,e,r)=>{this.resetLoader(o,s),n(new Lr({type:K.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:o,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,e,r)=>{this.resetLoader(o,s),n(new Lr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,error:new Error(`Timeout after ${i.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(t,e,r,i)=>{l&&l({frag:o,part:null,payload:r,networkDetails:i})}})})}loadPart(l,u,h){this.abort();const e=this.config,r=e.fLoader,c=e.loader;return new Promise((n,a)=>{if(this.loader&&this.loader.destroy(),l.gap||u.gap)a(Sr(l,u));else{const s=this.loader=l.loader=new(r||c)(e),o=_r(l,u);var t=Xe(e.fragLoadPolicy.default);const i={loadPolicy:t,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:br};u.stats=s.stats,s.load(o,i,{onSuccess:(t,e,r,i)=>{this.resetLoader(l,s),this.updateStatsFromPart(l,u);t={frag:l,part:u,payload:t.data,networkDetails:i};h(t),n(t)},onError:(t,e,r,i)=>{this.resetLoader(l,s),a(new Lr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:l,part:u,response:f({url:o.url,data:void 0},t),error:new Error(`HTTP Error ${t.code} `+t.text),networkDetails:r,stats:i}))},onAbort:(t,e,r)=>{l.stats.aborted=u.stats.aborted,this.resetLoader(l,s),a(new Lr({type:K.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:l,part:u,error:new Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,e,r)=>{this.resetLoader(l,s),a(new Lr({type:K.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,part:u,error:new Error(`Timeout after ${i.timeout}ms`),networkDetails:r,stats:t}))}})}})}updateStatsFromPart(t,e){var r=t.stats,i=e.stats,n=i.total,t=(r.loaded+=i.loaded,n?(n=((t=Math.round(t.duration/e.duration))-(e=Math.min(Math.round(r.loaded/n),t)))*Math.round(r.loaded/e),r.total=r.loaded+n):r.total=Math.max(r.loaded,r.total),r.loading),e=i.loading;t.start?t.first+=e.first-e.start:(t.start=e.start,t.first=e.first),t.end=e.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function _r(r,i=null){var n=i||r,i={frag:r,part:i,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},a=n.byteRangeStartOffset,n=n.byteRangeEndOffset;if(N(a)&&N(n)){let t=a,e=n;"initSegment"===r.sn&&"AES-128"===(null==(r=r.decryptdata)?void 0:r.method)&&((r=n-a)%16&&(e=n+(16-r%16)),0!==a)&&(i.resetIV=!0,t=a-16),i.rangeStart=t,i.rangeEnd=e}return i}function Sr(t,e){var r=new Error(`GAP ${t.gap?"tag":"attribute"} found`),r={type:K.MEDIA_ERROR,details:H.FRAG_GAP,fatal:!1,frag:t,error:r,networkDetails:null};return e&&(r.part=e),(e||t).stats.aborted=!0,new Lr(r)}class Lr extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class kr{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const r in this.keyUriToKeyInfo){var e=this.keyUriToKeyInfo[r].loader;if(e){if(t&&t!==e.context.frag.type)return;e.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,e=H.KEY_LOAD_ERROR,r,i,n){return new Lr({type:K.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:n,error:r,networkDetails:i})}loadClear(t,e){if(this.emeController&&this.config.emeEnabled){var{sn:r,cc:i}=t;for(let t=0;t<e.length;t++){const n=e[t];if(i<=n.cc&&("initSegment"===r||"initSegment"===n.sn||r<n.sn)){this.emeController.selectKeySystemFormat(n).then(t=>{n.setKeyFormat(t)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r)return t=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading"),Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,t));var i,t=r.uri;if(!t)return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${t}"`)));let n=this.keyUriToKeyInfo[t];if(null!=(i=n)&&i.decryptdata.key)return r.key=n.decryptdata.key,Promise.resolve({frag:e,keyInfo:n});if(null!=(i=n)&&i.keyLoadPromise)switch(null==(i=n.mediaKeySessionContext)?void 0:i.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return n.keyLoadPromise.then(t=>(r.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:n}))}switch(n=this.keyUriToKeyInfo[t]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===r.keyFormat?this.loadKeyHTTP(n,e):this.loadKeyEME(n,e);case"AES-128":return this.loadKeyHTTP(n,e);default:return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){t=this.emeController.loadKey(r);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,r))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(r)}loadKeyHTTP(r,a){const i=this.config;const l=new i.loader(i);return a.keyLoader=r.loader=l,r.keyLoadPromise=new Promise((s,o)=>{const n={keyInfo:r,frag:a,responseType:"arraybuffer",url:r.decryptdata.uri};var t=i.keyLoadPolicy.default,t={loadPolicy:t,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},e={onSuccess:(t,e,r,i)=>{var{frag:r,keyInfo:n,url:a}=r;if(!r.decryptdata||n!==this.keyUriToKeyInfo[a])return o(this.createKeyLoadError(r,H.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));n.decryptdata.key=r.decryptdata.key=new Uint8Array(t.data),r.keyLoader=null,n.loader=null,s({frag:r,keyInfo:n})},onError:(t,e,r,i)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.KEY_LOAD_ERROR,new Error(`HTTP Error ${t.code} loading key `+t.text),r,f({url:n.url,data:void 0},t)))},onTimeout:(t,e,r)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),r))},onAbort:(t,e,r)=>{this.resetLoader(e),o(this.createKeyLoadError(a,H.INTERNAL_ABORTED,new Error("key loading aborted"),r))}};l.load(n,t,e)})}resetLoader(t){var{frag:t,keyInfo:e,url:r}=t,i=e.loader;t.keyLoader===i&&(t.keyLoader=null,e.loader=null),delete this.keyUriToKeyInfo[r],i&&i.destroy()}}const Rr={length:0,start:()=>0,end:()=>0};class S{static isBuffered(t,e){try{if(t){var r=S.getBuffered(t);for(let t=0;t<r.length;t++)if(e>=r.start(t)&&e<=r.end(t))return!0}}catch(t){}return!1}static bufferInfo(e,r,i){try{if(e){var n=S.getBuffered(e),a=[];let t;for(t=0;t<n.length;t++)a.push({start:n.start(t),end:n.end(t)});return this.bufferedInfo(a,r,i)}}catch(t){}return{len:0,start:r,end:r,nextStart:void 0}}static bufferedInfo(e,r,i){r=Math.max(0,r),e.sort(function(t,e){var r=t.start-e.start;return r||e.end-t.end});let n=[];if(i)for(let t=0;t<e.length;t++){var a,s=n.length;s&&(a=n[s-1].end,e[t].start-a<i)?e[t].end>a&&(n[s-1].end=e[t].end):n.push(e[t])}else n=e;let o=0,l,u=r,h=r;for(let t=0;t<n.length;t++){var c=n[t].start,d=n[t].end;if(c<=r+i&&r<d)u=c,h=d,o=h-r;else if(r+i<c){l=c;break}}return{len:o,start:u||0,end:h||0,nextStart:l}}static getBuffered(t){try{return t.buffered}catch(t){return V.log("failed to get media.buffered",t),Rr}}}class wr{constructor(t,e,r,i=0,n=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ir(),this.buffering={audio:Ir(),video:Ir(),audiovideo:Ir()},this.level=t,this.sn=e,this.id=r,this.size=i,this.part=n,this.partial=a}}function Ir(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Dr(r,i){let n=null;for(let t=0,e=r.length;t<e;t++){var a=r[t];if(a&&a.cc===i){n=a;break}}return n}function Cr(t,e){t&&(e=t.start+e,t.start=t.startPTS=e,t.endPTS=e+t.duration)}function Pr(r,t){var i=t.fragments;for(let t=0,e=i.length;t<e;t++)Cr(i[t],r);t.fragmentHint&&Cr(t.fragmentHint,r),t.alignedSliding=!0}function xr(t,e,r){var i,n,a;e&&(function(t,e,r){return!(!e.details||!(r.endCC>r.startCC||t&&t.cc<r.startCC))}(t=t,i=e,n=r)&&(t=function(t,e){if(t=t.fragments,(e=e.fragments).length&&t.length){t=Dr(t,e[0].cc);if(t&&t.startPTS)return t;V.log("No frag in previous level to align on")}else V.log("No fragments to align")}(i.details,n))&&N(t.start)&&(V.log("Adjusting PTS using last level due to CC increase within current level "+n.url),Pr(t.start,n)),!r.alignedSliding&&e.details&&(i=r,(t=e.details).fragments.length)&&i.hasProgramDateTime&&t.hasProgramDateTime&&(n=t.fragments[0].programDateTime,a=i.fragments[0].programDateTime,t=(a-n)/1e3+t.fragments[0].start)&&N(t)&&(V.log(`Adjusting PTS using programDateTime delta ${a-n}ms, sliding:${t.toFixed(3)} ${i.url} `),Pr(t,i)),r.alignedSliding||!e.details||r.skippedSegments||He(e.details,r))}function Or(t,e){var r,i,n;t.hasProgramDateTime&&e.hasProgramDateTime&&(r=t.fragments,e=e.fragments,r.length)&&e.length&&(r=Dr(r,(e=e[Math.round(e.length/2)-1]).cc)||r[Math.round(r.length/2)-1],i=e.programDateTime,n=r.programDateTime,null!==i)&&null!==n&&Pr((n-i)/1e3-(r.start-e.start),t)}class Mr{constructor(t,e){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=e}decrypt(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)}}class Fr{constructor(t,e){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=e}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class Nr{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){var e=new DataView(t),r=new Uint32Array(4);for(let t=0;t<4;t++)r[t]=e.getUint32(4*t);return r}initTable(){var t=this.sBox,e=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],s=r[3],r=this.invSubMix,o=r[0],l=r[1],u=r[2],h=r[3],c=new Uint32Array(256);let d=0,f=0,p=0;for(p=0;p<256;p++)p<128?c[p]=p<<1:c[p]=p<<1^283;for(p=0;p<256;p++){var g=(g=f^f<<1^f<<2^f<<3^f<<4)>>>8^255&g^99,v=c[e[t[d]=g]=d],m=c[v],y=c[m],E=257*c[g]^16843008*g;i[d]=E<<24|E>>>8,n[d]=E<<16|E>>>16,a[d]=E<<8|E>>>24,s[d]=E,E=16843009*y^65537*m^257*v^16843008*d,o[g]=E<<24|E>>>8,l[g]=E<<16|E>>>16,u[g]=E<<8|E>>>24,h[g]=E,d?(d=v^c[c[c[y^v]]],f^=c[c[f]]):d=f=1}}expandKey(n){var a=this.uint8ArrayToUint32Array_(n);let t=!0,e=0;for(;e<a.length&&t;)t=a[e]===this.key[e],e++;if(!t){this.key=a;var s=this.keySize=a.length;if(4!==s&&6!==s&&8!==s)throw new Error("Invalid aes key size="+s);var o=this.ksRows=4*(s+6+1);let t,e;var l=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),h=this.sBox,c=this.rcon,n=this.invSubMix,d=n[0],f=n[1],p=n[2],g=n[3];let r,i;for(t=0;t<o;t++)t<s?r=l[t]=a[t]:(i=r,t%s==0?(i=h[(i=i<<8|i>>>24)>>>24]<<24|h[i>>>16&255]<<16|h[i>>>8&255]<<8|h[255&i],i^=c[t/s|0]<<24):6<s&&t%s==4&&(i=h[i>>>24]<<24|h[i>>>16&255]<<16|h[i>>>8&255]<<8|h[255&i]),l[t]=r=(l[t-s]^i)>>>0);for(e=0;e<o;e++)t=o-e,i=3&e?l[t]:l[t-4],e<4||t<=4?u[e]=i:u[e]=d[h[i>>>24]]^f[h[i>>>16&255]]^p[h[i>>>8&255]]^g[h[255&i]],u[e]=u[e]>>>0}}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,r){var i=this.keySize+6,n=this.invKeySchedule,a=this.invSBox,s=this.invSubMix,o=s[0],l=s[1],u=s[2],h=s[3],s=this.uint8ArrayToUint32Array_(r);let c=s[0],d=s[1],f=s[2],p=s[3];var g,v,m,y,E=new Int32Array(t),T=new Int32Array(E.length);let b,A,_,S,L,k,R,w,I,D;for(var C=this.networkToHostOrderSwap;e<E.length;){for(g=C(E[e]),v=C(E[e+1]),m=C(E[e+2]),y=C(E[e+3]),L=g^n[0],k=y^n[1],R=m^n[2],w=v^n[3],I=4,D=1;D<i;D++)b=o[L>>>24]^l[k>>16&255]^u[R>>8&255]^h[255&w]^n[I],A=o[k>>>24]^l[R>>16&255]^u[w>>8&255]^h[255&L]^n[I+1],_=o[R>>>24]^l[w>>16&255]^u[L>>8&255]^h[255&k]^n[I+2],S=o[w>>>24]^l[L>>16&255]^u[k>>8&255]^h[255&R]^n[I+3],L=b,k=A,R=_,w=S,I+=4;b=a[L>>>24]<<24^a[k>>16&255]<<16^a[R>>8&255]<<8^a[255&w]^n[I],A=a[k>>>24]<<24^a[R>>16&255]<<16^a[w>>8&255]<<8^a[255&L]^n[I+1],_=a[R>>>24]<<24^a[w>>16&255]<<16^a[L>>8&255]<<8^a[255&k]^n[I+2],S=a[w>>>24]<<24^a[L>>16&255]<<16^a[k>>8&255]<<8^a[255&R]^n[I+3],T[e]=C(b^c),T[e+1]=C(S^d),T[e+2]=C(_^f),T[e+3]=C(A^p),c=g,d=v,f=m,p=y,e+=4}return T.buffer}}class Br{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=e)try{var r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(t){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){var t,e,{currentResult:r,remainderData:i}=this;return!r||i?(this.reset(),null):(i=new Uint8Array(r),this.reset(),this.removePKCS7Padding?(t=(r=i).byteLength,(e=t&&new DataView(r.buffer).getUint8(t-1))?St(r,0,t-e):r):i)}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(i,n,a){return this.useSoftware?new Promise((t,e)=>{this.softwareDecrypt(new Uint8Array(i),n,a);var r=this.flush();r?t(r.buffer):e(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(i),n,a)}softwareDecrypt(t,e,r){var{currentIV:i,currentResult:n,remainderData:a}=this,a=(this.logOnce("JS AES decrypt"),a&&(t=Vt(a,t),this.remainderData=null),this.getValidChunk(t));if(!a.length)return null;i&&(r=i);let s=this.softwareDecrypter;(s=s||(this.softwareDecrypter=new Nr)).expandKey(e);t=n;return this.currentResult=s.decrypt(a.buffer,0,r),this.currentIV=St(a,-16).buffer,t||null}webCryptoDecrypt(e,r,i){const n=this.subtle;return this.key===r&&this.fastAesKey||(this.key=r,this.fastAesKey=new Fr(n,r)),this.fastAesKey.expandKey().then(t=>{return n?(this.logOnce("WebCrypto AES decrypt"),new Mr(n,new Uint8Array(i)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))}).catch(t=>(V.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${t.name}: `+t.message),this.onWebCryptoError(e,r,i)))}onWebCryptoError(t,e,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,r);t=this.flush();if(t)return t.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let e=t;var r=t.length-t.length%16;return r!==t.length&&(e=St(t,0,r),this.remainderData=St(t,r)),e}logOnce(t){this.logEnabled&&(V.log("[decrypter]: "+t),this.logEnabled=!1)}}const Ur={toString:function(e){let r="";var i=e.length;for(let t=0;t<i;t++)r+=`[${e.start(t).toFixed(3)}-${e.end(t).toFixed(3)}]`;return r}},L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class jr extends class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!(!this._tickInterval||(self.clearInterval(this._tickInterval),this._tickInterval=null))}clearNextTick(){return!(!this._tickTimer||(self.clearTimeout(this._tickTimer),this._tickTimer=null))}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}{constructor(t,e,r,i,n){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=L.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=n,this.logPrefix=i,this.log=V.log.bind(V,i+":"),this.warn=V.warn.bind(V,i+":"),this.hls=t,this.fragmentLoader=new Ar(t.config),this.keyLoader=r,this.fragmentTracker=e,this.config=t.config,this.decrypter=new Br(t.config),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED}_streamEnded(t,e){return!(e.live||t.nextStart||!t.end||!this.media)&&(null!=(t=e.partList)&&t.length?(t=t[t.length-1],S.isBuffered(this.media,t.start+t.duration/2)):(t=e.fragments[e.fragments.length-1].type,this.fragmentTracker.isEndListAppended(t)))}getLevelDetails(){var t;return!this.levels||null===this.levelLastLoaded||null==(t=this.levels[this.levelLastLoaded])?void 0:t.details}onMediaAttached(t,e){e=this.media=this.mediaBuffer=e.media,this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended),e=this.config;this.levels&&e.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(e.startPosition)}onMediaDetaching(){var t=this.media;null!=t&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){var{config:t,fragCurrent:e,media:r,mediaBuffer:i,state:n}=this,a=r?r.currentTime:0,i=S.bufferInfo(i||r,a,t.maxBufferHole);this.log(`media seeking to ${N(a)?a.toFixed(3):a}, state: `+n),this.state===L.ENDED?this.resetLoadingState():e&&(n=t.maxFragLookUpTolerance,t=e.start-n,n=e.start+e.duration+n,!i.len||n<i.start||t>i.end)&&(n=n<a,a<t||n)&&(n&&e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null),r&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||i.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=L.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,r){this._loadFragForPlayback(t,e,r)}_loadFragForPlayback(r,t,e){this._doFragLoad(r,t,e,t=>{this.fragContextChanged(r)?(this.warn(`Fragment ${r.sn}${t.part?" p: "+t.part.index:""} of level ${r.level} was dropped during download.`),this.fragmentTracker.removeFragment(r)):(r.stats.chunkCount++,this._handleFragmentLoadProgress(t))}).then(t=>{var e;t&&(e=this.state,this.fragContextChanged(r)?e!==L.FRAG_LOADING&&(this.fragCurrent||e!==L.PARSING)||(this.fragmentTracker.removeFragment(r),this.state=L.IDLE):("payload"in t&&(this.log(`Loaded fragment ${r.sn} of level `+r.level),this.hls.trigger($.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t)))}).catch(t=>{this.state!==L.STOPPED&&this.state!==L.ERROR&&(this.warn(t),this.resetFragmentLoading(r))})}clearTrackerIfNeeded(t){var e,r=this["fragmentTracker"];r.getState(t)===gr?(e=t.type,e=this.getFwdBufferInfo(this.mediaBuffer,e),e=Math.max(t.duration,e?e.len:this.config.maxBufferLength),this.reduceMaxBufferLength(e)&&r.removeFragment(t)):0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?r.removeAllFragments():r.hasParts(t.type)&&(r.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),r.getState(t)===vr)&&r.removeFragment(t)}flushMainBuffer(t,e,r=null){t-e&&(t={startOffset:t,endOffset:e,type:r},this.hls.trigger($.BUFFER_FLUSHING,t))}_loadInitSegment(a,n){this._doFragLoad(a,n).then(t=>{if(t&&!this.fragContextChanged(a)&&this.levels)return t;throw new Error("init load aborted")}).then(r=>{const i=this["hls"];var t=r["payload"],e=a.decryptdata;if(t&&0<t.byteLength&&e&&e.key&&e.iv&&"AES-128"===e.method){const n=self.performance.now();return this.decrypter.decrypt(new Uint8Array(t),e.key.buffer,e.iv.buffer).catch(t=>{throw i.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:a}),t}).then(t=>{var e=self.performance.now();return i.trigger($.FRAG_DECRYPTED,{frag:a,payload:t,stats:{tstart:n,tdecrypt:e}}),r.payload=t,r})}return r}).then(t=>{var{fragCurrent:e,hls:r,levels:i}=this;if(!i)throw new Error("init load aborted, missing levels");i=a.stats;this.state=L.IDLE,n.fragmentError=0,a.data=new Uint8Array(t.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),t.frag===e&&r.trigger($.FRAG_BUFFERED,{stats:i,frag:e,part:null,id:a.type}),this.tick()}).catch(t=>{this.state!==L.STOPPED&&this.state!==L.ERROR&&(this.warn(t),this.resetFragmentLoading(a))})}fragContextChanged(t){var e=this["fragCurrent"];return!t||!e||t.level!==e.level||t.sn!==e.sn||t.urlId!==e.urlId}fragBufferedComplete(t,e){var r=this.mediaBuffer||this.media;this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.playlistType===A?"level":"track"} ${t.level} (frag:[${(null!=(e=t.startPTS)?e:NaN).toFixed(3)}-${(null!=(e=t.endPTS)?e:NaN).toFixed(3)}] > buffer:${r?Ur.toString(S.getBuffered(r)):"(detached)"})`),this.state=L.IDLE,r&&(!this.loadedmetadata&&t.type==A&&r.buffered.length&&(null==(e=this.fragCurrent)?void 0:e.sn)===(null==(t=this.fragPrevious)?void 0:t.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){var e,r,i=this["transmuxer"];i&&({frag:t,part:e,partsLoaded:r}=t,r=!r||0===r.length||r.some(t=>!t),t=new wr(t.level,t.sn,t.stats.chunkCount+1,0,e?e.index:-1,!r),i.flush(t))}_handleFragmentLoadProgress(t){}_doFragLoad(e,r,i=null,n){var a=null==r?void 0:r.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let s=null;if(!e.encrypted||null!=(o=e.decryptdata)&&o.key?!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments):(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} `+e.level),this.state=L.KEY_LOADING,this.fragCurrent=e,s=this.keyLoader.load(e).then(t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger($.KEY_LOADED,t),this.state===L.KEY_LOADING&&(this.state=L.IDLE),t}),this.hls.trigger($.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(s=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var o=a.partList;if(o&&n){i>e.end&&a.fragmentHint&&(e=a.fragmentHint);var l=this.getNextPart(o,e,i);if(-1<l){const h=o[l];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${l}-${o.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: `+parseFloat(i.toFixed(3))),this.nextLoadPosition=h.start+h.duration,this.state=L.FRAG_LOADING;let t;return t=s?s.then(t=>!t||this.fragContextChanged(t.frag)?null:this.doFragPartsLoad(e,h,r,n)).catch(t=>this.handleFragLoadError(t)):this.doFragPartsLoad(e,h,r,n).catch(t=>this.handleFragLoadError(t)),this.hls.trigger($.FRAG_LOADING,{frag:e,part:h,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):t}if(!e.url||this.loadedEndOfParts(o,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: `+parseFloat(i.toFixed(3))),N(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=L.FRAG_LOADING;const u=this.config.progressive;let t;return t=u&&s?s.then(t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,n)).catch(t=>this.handleFragLoadError(t)):Promise.all([this.fragmentLoader.load(e,u?n:void 0),s]).then(([t])=>(!u&&t&&n&&n(t),t)).catch(t=>this.handleFragLoadError(t)),this.hls.trigger($.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):t}doFragPartsLoad(o,r,l,u){return new Promise((i,t)=>{var e;const n=[],a=null==(e=l.details)?void 0:e.partList,s=r=>{this.fragmentLoader.loadPart(o,r,u).then(t=>{var e=(n[r.index]=t).part,t=(this.hls.trigger($.FRAG_LOADED,t),We(l,o.sn,r.index+1)||Ye(a,o.sn,r.index+1));if(!t)return i({frag:o,part:e,partsLoaded:n});s(t)}).catch(t)};s(r)})}handleFragLoadError(t){var e;return"data"in t?(e=t.data,t.data&&e.details===H.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger($.ERROR,e)):this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0}),null}_handleTransmuxerFlush(t){var e,r,i,n=this.getCurrentContext(t);n&&this.state===L.PARSING?({frag:n,part:e,level:r}=n,i=self.performance.now(),n.stats.parsing.end=i,e&&(e.stats.parsing.end=i),this.updateLevelTiming(n,e,r,t.partial)):this.fragCurrent||this.state===L.STOPPED||this.state===L.ERROR||(this.state=L.IDLE)}getCurrentContext(t){var e,r,i,n,{levels:a,fragCurrent:s}=this,{level:t,sn:o,part:l}=t;return null!=a&&a[t]?(a=a[t],(n=(l=-1<l?We(a,o,l):null)?l.fragment:(r=o,i=s,null!=(e=a)&&e.details?(n=(e=e.details).fragments[r-e.startSN])||((n=e.fragmentHint)&&n.sn===r?n:r<e.startSN&&i&&i.sn===r?i:null):null))?(s&&s!==n&&(n.stats=s.stats),{frag:n,part:l,level:a}):null):(this.warn(`Levels object was unset while buffering fragment ${o} of level ${t}. The current chunk will not be buffered.`),null)}bufferFragmentData(e,r,i,n,a){if(e&&this.state===L.PARSING){var{data1:s,data2:o}=e;let t=s;null!=(s=t=s&&o?Vt(s,o):t)&&s.length&&(o={type:e.type,frag:r,part:i,chunkMeta:n,parent:r.type,data:t},this.hls.trigger($.BUFFER_APPENDING,o),e.dropped)&&e.independent&&!i&&!a&&this.flushBufferGap(r)}}flushBufferGap(t){var e,r,i=this.media;i&&(S.isBuffered(i,i.currentTime)?(e=i.currentTime,i=S.bufferInfo(i,e,0),r=t.duration,r=Math.min(2*this.config.maxFragLookUpTolerance,.25*r),i=Math.max(Math.min(t.start-r,i.end-r),e+r),t.start-i>r&&this.flushMainBuffer(i,t.start)):this.flushMainBuffer(0,t.start))}getFwdBufferInfo(t,e){var r=this.getLoadPosition();return N(r)?this.getFwdBufferInfoAtPos(t,r,e):null}getFwdBufferInfoAtPos(t,e,r){var i=this["config"]["maxBufferHole"],n=S.bufferInfo(t,e,i);if(0===n.len&&void 0!==n.nextStart){r=this.fragmentTracker.getBufferedFrag(e,r);if(r&&n.nextStart<r.end)return S.bufferInfo(t,e,Math.max(n.nextStart,i))}return n}getMaxBufferLength(t){var e=this["config"];let r;return r=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(r,e.maxMaxBufferLength)}reduceMaxBufferLength(t){var e=this.config,t=t||e.maxBufferLength;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${e.maxMaxBufferLength}s`),!0)}getAppendedFrag(t,e=0){t=this.fragmentTracker.getAppendedFrag(t,A);return t&&"fragment"in t?t.fragment:t}getNextFragment(t,e){var r=e.fragments,i=r.length;if(!i)return null;var n=this["config"],a=r[0].start;let s;if(e.live){var o=n.initialLiveManifestSize;if(i<o)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${o})`),null;e.PTSKnown||this.startFragRequested||-1!==this.startPosition||(s=this.getInitialLiveFragment(e,r),this.startPosition=s?this.hls.liveSyncPosition||s.start:t)}else t<=a&&(s=r[0]);return s||(i=n.lowLatencyMode?e.partEnd:e.fragmentEnd,s=this.getFragmentAtPosition(t,i,e)),this.mapToInitFragWhenRequired(s)}isLoopLoading(t,e){var r=this.fragmentTracker.getState(t);return(r===mr||r===vr&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,r,i,n){var a=t.gap,e=this.getNextFragment(this.nextLoadPosition,e);if(null===e)return e;if(t=e,a&&t&&!t.gap&&r.nextStart){e=this.getFwdBufferInfoAtPos(this.mediaBuffer||this.media,r.nextStart,i);if(null!==e&&r.len+e.len>=n)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: `+t.sn),null}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||null!=t&&t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(r,i,n){let a=-1,s=!1,o=!0;for(let t=0,e=r.length;t<e;t++){var l=r[t];if(o=o&&!l.independent,-1<a&&n<l.start)break;var u=l.loaded;u?a=-1:(s||l.independent||o)&&l.fragment===i&&(a=t),s=u}return a}loadedEndOfParts(t,e){t=t[t.length-1];return t&&e>t.start&&t.loaded}getInitialLiveFragment(t,e){var r,i,n=this.fragPrevious;let a=null;return n?(t.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),a=tr(e,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),a||((r=n.sn+1)>=t.startSN&&r<=t.endSN&&(r=e[r-t.startSN],n.cc===r.cc)&&(a=r,this.log("Live playlist, switching playlist, load frag with next SN: "+a.sn)),a)||(a=(r=e,i=n.cc,Ze.search(r,t=>t.cc<i?1:t.cc>i?-1:0)))&&this.log("Live playlist, switching playlist, load frag with same CC: "+a.sn)):null!==(e=this.hls.liveSyncPosition)&&(a=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t)),a}getFragmentAtPosition(t,e,r){var i=this["config"];let n=this["fragPrevious"],{fragments:a,endSN:s}=r;var o=r["fragmentHint"],l=i.maxFragLookUpTolerance,u=r.partList,i=!!(i.lowLatencyMode&&null!=u&&u.length&&o);i&&o&&!this.bitrateTest&&(a=a.concat(o),s=o.sn);let h;return(h=t<e?er(n,a,t,e-l<t?0:l):a[a.length-1])&&(o=h.sn-r.startSN,e=this.fragmentTracker.getState(h),n=e===mr||e===vr&&h.gap?h:n)&&h.sn===n.sn&&(!i||u[0].fragment.sn>h.sn)&&n&&h.level===n.level&&(t=a[1+o],h=h.sn<s&&this.fragmentTracker.getState(t)!==mr?t:null),h}synchronizeToLiveEdge(t){var e,r,i,n,{config:a,media:s}=this;s&&(e=this.hls.liveSyncPosition,r=s.currentTime,n=t.fragments[0].start,i=t.edge,n=r>=n-a.maxFragLookUpTolerance&&r<=i,null!==e)&&s.duration>e&&(r<e||!n)&&(a=void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:a.liveMaxLatencyDurationCount*t.targetduration,!n&&s.readyState<4||r<i-a)&&(this.loadedmetadata||(this.nextLoadPosition=e),s.readyState)&&(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${i}, reset currentTime to : `+e.toFixed(3)),s.currentTime=e)}alignPlaylists(t,e){var r,i,n,{levels:a,levelLastLoaded:s,fragPrevious:o}=this,a=null!==s?a[s]:null,s=t.fragments.length;return s?(r=t.fragments[0].start,n=!e,i=t.alignedSliding&&N(r),n||!i&&!r?(xr(o,a,t),n=t.fragments[0].start,this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} prev-sn: ${o?o.sn:"na"} fragments: `+s),n):r):(this.warn("No fragments in live playlist"),0)}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let r=this.startPosition;var i,n;-1!==(r=r<e?-1:r)&&-1!==this.lastCurrentTime||(null!==(n=((i=null!==this.startTimeOffset)?this:t).startTimeOffset)&&N(n)?(r=e+n,n<0&&(r+=t.totalduration),r=Math.min(Math.max(e,r),e+t.totalduration),this.log(`Start time offset ${n} found in ${i?"multivariant":"media"} playlist, adjust startPosition to `+r),this.startPosition=r):t.live?r=this.hls.liveSyncPosition||e:this.startPosition=r=0,this.lastCurrentTime=r),this.nextLoadPosition=r}getLoadPosition(){var t=this["media"];let e=0;return this.loadedmetadata&&t?e=t.currentTime:this.nextLoadPosition&&(e=this.nextLoadPosition),e}handleFragLoadAborted(t,e){this.transmuxer&&"initSegment"!==t.sn&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${e?" part "+e.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===L.FRAG_LOADING_WAITING_RETRY)||(this.state=L.IDLE)}onFragmentOrKeyLoadError(t,e){e.chunkMeta&&!e.frag&&(o=this.getCurrentContext(e.chunkMeta))&&(e.frag=o.frag);var r,i,n,a,s,o=e.frag;o&&o.type===t&&this.levels&&(this.fragContextChanged(o)?this.warn(`Frag load error must match current frag to retry ${o.url} > `+(null==(r=this.fragCurrent)?void 0:r.url)):((r=e.details===H.FRAG_GAP)&&this.fragmentTracker.fragBuffered(o,!0),{action:s,retryCount:n=0,retryConfig:a}=(i=e.errorAction)||{},i&&s===ar&&a?(this.resetStartWhenNotLoaded(null!=(s=this.levelLastLoaded)?s:o.level),s=Qe(a,n),this.warn(`Fragment ${o.sn} of ${t} ${o.level} errored with ${e.details}, retrying loading ${n+1}/${a.maxNumRetry} in ${s}ms`),i.resolved=!0,this.retryDate=self.performance.now()+s,this.state=L.FRAG_LOADING_WAITING_RETRY):a&&i?(this.resetFragmentErrors(t),n<a.maxNumRetry?r||(i.resolved=!0):V.warn(e.details+` reached or exceeded max retry (${n})`)):(null==i?void 0:i.action)===nr?this.state=L.WAITING_LEVEL:this.state=L.ERROR,this.tickImmediate()))}reduceLengthAndFlushBuffer(t){var e,r,i;return(this.state===L.PARSING||this.state===L.PARSED)&&(e=t.parent,(r=(i=this.getFwdBufferInfo(this.mediaBuffer,e))&&.5<i.len)&&this.reduceMaxBufferLength(i.len),(i=!r)&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${e} buffer`),t.frag&&(this.fragmentTracker.removeFragment(t.frag),this.nextLoadPosition=t.frag.start),this.resetLoadingState(),i)}resetFragmentErrors(t){t===_&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==L.STOPPED&&(this.state=L.IDLE)}afterBufferFlushed(t,e,r){t&&(t=S.getBuffered(t),this.fragmentTracker.detectEvictedFragments(e,t,r),this.state===L.ENDED)&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE}resetStartWhenNotLoaded(t){this.loadedmetadata||(this.startFragRequested=!1,null!=(t=this.levels?this.levels[t].details:null)&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition)}resetWhenMissingContext(t){var e;this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(e=this.levelLastLoaded)?e:t.level),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(n,t,a,s){const o=a.details;if(o){if(Object.keys(n.elementaryStreams).reduce((t,e)=>{var r,i=n.elementaryStreams[e];return i?(r=i.endPTS-i.startPTS)<=0?(this.warn(`Could not parse fragment ${n.sn} ${e} duration reliably (${r})`),t||!1):(r=s?0:$e(o,n,i.startPTS,i.endPTS,i.startDTS,i.endDTS),this.hls.trigger($.LEVEL_PTS_UPDATED,{details:o,level:a,drift:r,type:e,frag:n,start:i.startPTS,end:i.endPTS}),!0):t},!1))a.fragmentError=0;else if(null===(null==(e=this.transmuxer)?void 0:e.error)){var e=new Error(`Found no media in fragment ${n.sn} of level ${n.level} resetting transmuxer to fallback to playlist timing`);if(0===a.fragmentError&&(a.fragmentError++,n.gap=!0,this.fragmentTracker.removeFragment(n),this.fragmentTracker.fragBuffered(n,!0)),this.warn(e.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:n,reason:`Found no media in msn ${n.sn} of level "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=L.PARSED,this.hls.trigger($.FRAG_PARSED,{frag:n,part:t})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(t=this.levelLastLoaded)?t:null==(t=this.fragCurrent)?void 0:t.level)?t:0),this.resetLoadingState())}set state(t){var e=this._state;e!==t&&(this._state=t,this.log(e+"->"+t))}get state(){return this._state}}function Gr(){return self.SourceBuffer||self.WebKitSourceBuffer}function c(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class $r{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,r,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,r){}demux(t,e){this.cachedData&&(t=Vt(this.cachedData,t),this.cachedData=null);let r=Rt(t,0),i=r?r.length:0,n;var a,s,o=this._audioTrack,l=this._id3Track,u=r?It(r):void 0,h=t.length;for((null===this.basePTS||0===this.frameIndex&&N(u))&&(this.basePTS=Kr(u,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&0<r.length&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Re,duration:Number.POSITIVE_INFINITY});i<h;)this.canParse(t,i)?(a=this.appendFrame(o,t,i))?(this.frameIndex++,this.lastPTS=a.sample.pts,i+=a.length,n=i):i=h:(a=t,s=i,Lt(a,s)&&wt(a,s+6)+10<=a.length-s?(r=Rt(t,i),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:Re,duration:Number.POSITIVE_INFINITY}),i+=r.length,n=i):i++),i===h&&n!==h&&(s=St(t,n),this.cachedData?this.cachedData=Vt(this.cachedData,s):this.cachedData=s);return{audioTrack:o,videoTrack:c(),id3Track:l,textTrack:c()}}demuxSampleAes(t,e,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){var e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:c(),id3Track:this._id3Track,textTrack:c()}}destroy(){}}const Kr=(t,e,r)=>{return N(t)?90*t:9e4*e+(r?9e4*r.baseTime/r.timescale:0)};function Hr(t,e){return 255===t[e]&&240==(246&t[e+1])}function Vr(t,e){return 1&t[e+1]?7:9}function Wr(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function Yr(t,e){return e+1<t.length&&Hr(t,e)}function qr(t,e,r,i,n){t.samplerate||(e=function(t,e,r,i){let n,a;var s;let o;var l=navigator.userAgent.toLowerCase(),u=i,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=(n=1+((192&e[r+2])>>>6),(60&e[r+2])>>>2);if(!(h.length-1<c))return s=(1&e[r+2])<<2,s|=(192&e[r+3])>>>6,V.log(`manifest codec:${i}, ADTS type:${n}, samplingIndex:`+c),a=/firefox/i.test(l)?6<=c?(n=5,o=new Array(4),c-3):(n=2,o=new Array(2),c):-1!==l.indexOf("android")?(n=2,o=new Array(2),c):(n=5,o=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&6<=c?c-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(6<=c&&1==s||/vivaldi/i.test(l))||!i&&1==s)&&(n=2,o=new Array(2)),c)),o[0]=n<<3,o[0]|=(14&c)>>1,o[1]|=(1&c)<<7,o[1]|=s<<3,5===n&&(o[1]|=(14&a)>>1,o[2]=(1&a)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:h[c],channelCount:s,codec:"mp4a.40."+n,manifestCodec:u};t.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+c})}(e,r,i,n))&&(t.config=e.config,t.samplerate=e.samplerate,t.channelCount=e.channelCount,t.codec=e.codec,t.manifestCodec=e.manifestCodec,V.log(`parsed codec:${t.codec}, rate:${e.samplerate}, channels:`+e.channelCount))}function zr(t){return 9216e4/t}function Qr(t,e,r,i,n){var a,s,i=i+n*zr(t.samplerate),n=function(t,e){var r=Vr(t,e);if(e+r<=t.length){t=Wr(t,e)-r;if(0<t)return{headerLength:r,frameLength:t}}}(e,r);let o;return n?({frameLength:n,headerLength:s}=n,n=s+n,(a=Math.max(0,r+n-e.length))?(o=new Uint8Array(n-s)).set(e.subarray(r+s,e.length),0):o=e.subarray(r+s,r+n),s={unit:o,pts:i},a||t.samples.push(s),{sample:s,length:n,missing:a}):(t=e.length-r,(o=new Uint8Array(t)).set(e.subarray(r,e.length),0),{sample:{unit:o,pts:i},length:t,missing:-1})}const Xr=/\/emsg[-/]ID3/i;let Jr=null;const Zr=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ti=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ei=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ri=[0,1,1,4];function ii(t,e,r,i,n){var a;return!(r+24>e.length)&&(a=ni(e,r))&&r+a.frameLength<=e.length?(i=i+n*(9e4*a.samplesPerFrame/a.sampleRate),n={unit:e.subarray(r,r+a.frameLength),pts:i,dts:i},t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(n),{sample:n,length:a.frameLength,missing:0}):void 0}function ni(t,e){var r,i,n,a,s,o=t[e+1]>>3&3,l=t[e+1]>>1&3,u=t[e+2]>>4&15,h=t[e+2]>>2&3;if(1!=o&&0!=u&&15!=u&&3!=h)return s=t[e+2]>>1&1,r=t[e+3]>>6,i=3==o?3-l:3==l?3:4,i=1e3*Zr[14*i+u-1],u=3==o?0:2==o?1:2,u=ti[3*u+h],h=3==r?1:2,a=8*(o=ei[o][l])*(n=ri[l]),o=Math.floor(o*i/u+s)*n,null===Jr&&(s=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),Jr=s?parseInt(s[1]):0),!!Jr&&Jr<=87&&2==l&&224e3<=i&&0==r&&(t[e+3]=128|t[e+3]),{sampleRate:u,channelCount:h,frameLength:o,samplesPerFrame:a}}function ai(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])}function si(t,e){return e+1<t.length&&ai(t,e)}class oi{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,i=new Uint8Array(4),e=Math.min(4,e);if(0===e)throw new Error("no bytes available");i.set(t.subarray(r,r+e)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*e,this.bytesAvailable-=e}skipBits(t){var e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t||(t=(t-=this.bitsAvailable)-((e=t>>3)<<3),this.bytesAvailable-=e,this.loadWord()),this.word<<=t,this.bitsAvailable-=t}readBits(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;if(32<t&&V.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,0<this.bitsAvailable)this.word<<=e;else{if(!(0<this.bytesAvailable))throw new Error("no bits available");this.loadWord()}return 0<(e=t-e)&&this.bitsAvailable?r<<e|this.readBits(e):r}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){var t=this.skipLZ();return this.readBits(t+1)-1}readEG(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let r=8,i=8;var n;for(let t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}readSPS(){let t=0,e=0,r=0,i=0;var n,a;let s;var o=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),h=this.readBoolean.bind(this),c=this.skipBits.bind(this),d=this.skipEG.bind(this),f=this.skipUEG.bind(this),p=this.skipScalingList.bind(this),g=(o(),o());if(l(5),c(3),o(),f(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){g=u();if(3===g&&c(1),f(),f(),c(1),h())for(a=3!==g?8:12,s=0;s<a;s++)h()&&(s<6?p(16):p(64))}f();g=u();if(0===g)u();else if(1===g)for(c(1),d(),d(),n=u(),s=0;s<n;s++)d();f(),c(1);g=u(),f=u(),l=l(1);0===l&&c(1),c(1),h()&&(t=u(),e=u(),r=u(),i=u());let v=[1,1];if(h()&&h())switch(o()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:v=[o()<<8|o(),o()<<8|o()]}return{width:Math.ceil(16*(g+1)-2*t-2*e),height:(2-l)*(f+1)*16-(l?2:4)*(r+i),pixelRatio:v}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class li{constructor(t,e,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Br(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,r,i){const n=e[r].unit;var t;n.length<=16||(t=(t=n.subarray(16,n.length-n.length%16)).buffer.slice(t.byteOffset,t.byteOffset+t.length),this.decryptBuffer(t).then(t=>{t=new Uint8Array(t);n.set(t,16),this.decrypter.isSync()||this.decryptAacSamples(e,r+1,i)}))}decryptAacSamples(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)r.set(e.subarray(t,t+16),i);return r}getAvcDecryptedUnit(e,t){var r=new Uint8Array(t);let i=0;for(let t=32;t<e.length-16;t+=160,i+=16)e.set(r.subarray(i,i+16),t);return e}decryptAvcSample(e,r,i,n,a){const s=qt(a.data);var t=this.getAvcEncryptedData(s);this.decryptBuffer(t.buffer).then(t=>{a.data=this.getAvcDecryptedUnit(s,t),this.decrypter.isSync()||this.decryptAvcSamples(e,r,i+1,n)})}decryptAvcSamples(t,e,r,i){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,r=0){if(e>=t.length)return void i();for(var n=t[e].units;!(r>=n.length);r++){var a=n[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type||(this.decryptAvcSample(t,e,r,i,a),this.decrypter.isSync())))return}}}}const I=188;class ui{constructor(t,e,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=t,this.config=e,this.typeSupported=r}static probe(t){t=ui.syncOffset(t);return 0<t&&V.warn("MPEG2-TS detected but first sync word found @ offset "+t),-1!==t}static syncOffset(n){var a=n.length;let s=Math.min(940,n.length-I)+1,o=0;for(;o<s;){let e=!1,r=-1,i=0;for(let t=o;t<a;t+=I){if(71!==n[t]){if(i)return-1;break}if(i++,-1===r&&0!==(r=t)&&(s=Math.min(r+18612,n.length-I)+1),(e=e||0===ci(n,t))&&1<i&&(0===r&&2<i||t+I>s))return r}o++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:Bt[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,r,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ui.createTrack("video"),this._audioTrack=ui.createTrack("audio",i),this._id3Track=ui.createTrack("id3"),this._txtTrack=ui.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=r,this._duration=i}resetTimeStamp(){}resetContiguity(){var{_audioTrack:t,_avcTrack:e,_id3Track:r}=this;t&&(t.pesData=null),e&&(e.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(r,t,i=!1,e=!1){i||(this.sampleAes=null);let n;var a=this._avcTrack,s=this._audioTrack,o=this._id3Track,l=this._txtTrack;let u=a.pid,h=a.pesData,c=s.pid,d=o.pid,f=s.pesData,p=o.pesData,g=null,v=this.pmtParsed,m=this._pmtId,y=r.length;if(this.remainderData&&(r=Vt(this.remainderData,r),y=r.length,this.remainderData=null),y<I&&!e)return this.remainderData=r,{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};var E,T=Math.max(0,ui.syncOffset(r));(y-=(y-T)%I)<r.byteLength&&!e&&(this.remainderData=new Uint8Array(r.buffer,y,r.buffer.byteLength-y));let b=0;for(let e=T;e<y;e+=I)if(71===r[e]){var A=!!(64&r[e+1]),_=ci(r,e);let t;if(1<(48&r[e+3])>>4){if((t=e+5+r[e+4])===e+I)continue}else t=e+4;switch(_){case u:A&&(h&&(n=di(h))&&this.parseAVCPES(a,l,n,!1),h={data:[],size:0}),h&&(h.data.push(r.subarray(t,e+I)),h.size+=e+I-t);break;case c:if(A){if(f&&(n=di(f)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,n);break;case"mp3":this.parseMPEGPES(s,n)}f={data:[],size:0}}f&&(f.data.push(r.subarray(t,e+I)),f.size+=e+I-t);break;case d:A&&(p&&(n=di(p))&&this.parseID3PES(o,n),p={data:[],size:0}),p&&(p.data.push(r.subarray(t,e+I)),p.size+=e+I-t);break;case 0:A&&(t+=r[t]+1),m=this._pmtId=(S=r,E=t,(31&S[E+10])<<8|S[E+11]);break;case m:A&&(t+=r[t]+1);var S=function(t,e,r,i){var n={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},a=(15&t[e+1])<<8|t[e+2],s=e+3+a-4,a=(15&t[e+10])<<8|t[e+11];e+=12+a;for(;e<s;){var o=ci(t,e);switch(t[e]){case 207:if(!i){V.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===n.audio&&(n.audio=o);break;case 21:-1===n.id3&&(n.id3=o);break;case 219:if(!i){V.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===n.avc&&(n.avc=o);break;case 3:case 4:!0!==r.mpeg&&!0!==r.mp3?V.log("MPEG audio found, not supported in this browser"):-1===n.audio&&(n.audio=o,n.segmentCodec="mp3");break;case 36:V.warn("Unsupported HEVC stream type found")}e+=5+((15&t[e+3])<<8|t[e+4])}return n}(r,t,this.typeSupported,i);0<(u=S.avc)&&(a.pid=u),0<(c=S.audio)&&(s.pid=c,s.segmentCodec=S.segmentCodec),0<(d=S.id3)&&(o.pid=d),null===g||v||(V.warn(`MPEG-TS PMT found at ${e} after unknown PID '${g}'. Backtracking to sync byte @${T} to parse all TS packets.`),g=null,e=T-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=_}}else b++;0<b&&(L=new Error(`Found ${b} TS packet/s that do not start with 0x47`),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:L,reason:L.message})),a.pesData=h,s.pesData=f,o.pesData=p;var L={audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};return e&&this.extractRemainingSamples(L),L}flush(){var t=this["remainderData"];this.remainderData=null;let e;return e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){var{audioTrack:e,videoTrack:t,id3Track:r,textTrack:i}=t,n=t.pesData,a=e.pesData,s=r.pesData;let o;if(n&&(o=di(n))?(this.parseAVCPES(t,i,o,!0),t.pesData=null):t.pesData=n,a&&(o=di(a))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,o);break;case"mp3":this.parseMPEGPES(e,o)}e.pesData=null}else null!=a&&a.size&&V.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=a;s&&(o=di(s))?(this.parseID3PES(r,o),r.pesData=null):r.pesData=s}demuxSampleAes(t,e,r){t=this.demux(t,r,!0,!this.config.progressive),r=this.sampleAes=new li(this.observer,this.config,e);return this.decrypt(t,r)}decrypt(i,n){return new Promise(t=>{const{audioTrack:e,videoTrack:r}=i;e.samples&&"aac"===e.segmentCodec?n.decryptAacSamples(e.samples,0,()=>{r.samples?n.decryptAvcSamples(r.samples,0,0,()=>{t(i)}):t(i)}):r.samples&&n.decryptAvcSamples(r.samples,0,0,()=>{t(i)})})}destroy(){this._duration=0}parseAVCPES(a,r,s,t){var e=this.parseAVCNALu(a,s.data);let o=this.avcSample,l,u=!1;s.data=null,o&&e.length&&!a.audFound&&(fi(o,a),o=this.avcSample=hi(!1,s.pts,s.dts,"")),e.forEach(e=>{switch(e.type){case 1:{let t=!1;l=!0;var i=e.data;u&&4<i.length&&(2!==(i=new oi(i).readSliceType())&&4!==i&&7!==i&&9!==i||(t=!0)),t&&null!=(i=o)&&i.frame&&!o.key&&(fi(o,a),o=this.avcSample=null),(o=o||(this.avcSample=hi(!0,s.pts,s.dts,""))).frame=!0,o.key=t;break}case 5:l=!0,null!=(i=o)&&i.frame&&!o.key&&(fi(o,a),o=this.avcSample=null),(o=o||(this.avcSample=hi(!0,s.pts,s.dts,""))).key=!0,o.frame=!0;break;case 6:l=!0,Yt(e.data,1,s.pts,r.samples);break;case 7:if(l=!0,u=!0,!a.sps){var i=e.data,t=new oi(i).readSPS(),n=(a.width=t.width,a.height=t.height,a.pixelRatio=t.pixelRatio,a.sps=[i],a.duration=this._duration,i.subarray(1,4));let r="avc1.";for(let e=0;e<3;e++){let t=n[e].toString(16);t.length<2&&(t="0"+t),r+=t}a.codec=r}break;case 8:l=!0,a.pps||(a.pps=[e.data]);break;case 9:l=!1,a.audFound=!0,o&&fi(o,a),o=this.avcSample=hi(!1,s.pts,s.dts,"");break;case 12:l=!0;break;default:l=!1,o&&(o.debug+="unknown NAL "+e.type+" ")}o&&l&&o.units.push(e)}),t&&o&&(fi(o,a),this.avcSample=null)}getLastNalUnit(t){let e=this.avcSample,r;return null!=(t=e=e&&0!==e.units.length?e:t[t.length-1])&&t.units&&(t=e.units,r=t[t.length-1]),r}parseAVCNALu(t,e){var r=e.byteLength;let i=t.naluState||0;var n,a,s,o=i,l=[];let u=0,h=-1,c=0;for(-1===i&&(h=0,c=31&e[0],i=0,u=1);u<r;){var d,f,p=e[u++];i?i=1===i?p?0:2:p?1===p?(0<=h?(d={data:e.subarray(h,u-i-1),type:c},l.push(d)):(d=this.getLastNalUnit(t.samples))&&(o&&u<=4-o&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-o)),0<(n=u-i-1))&&((f=new Uint8Array(d.data.byteLength+n)).set(d.data,0),f.set(e.subarray(0,n),d.data.byteLength),d.data=f,d.state=0),u<r?(n=31&e[u],h=u,c=n,0):-1):0:3:i=p?0:1}return 0<=h&&0<=i&&(a={data:e.subarray(h,r),type:c,state:i},l.push(a)),0===l.length&&(a=this.getLastNalUnit(t.samples))&&((s=new Uint8Array(a.data.byteLength+e.byteLength)).set(a.data,0),s.set(e,a.data.byteLength),a.data=s),t.naluState=i,l}parseAACPES(t,e){let r=0;var i,n,a=this.aacOverFlow;let s=e.data;a&&(this.aacOverFlow=null,u=a.missing,l=a.sample.unit.byteLength,-1===u?((c=new Uint8Array(l+s.byteLength)).set(a.sample.unit,0),c.set(s,l),s=c):(c=l-u,a.sample.unit.set(s.subarray(0,u),c),t.samples.push(a.sample),r=a.missing));let o;for(o=r,i=s.length;o<i-1&&!Yr(s,o);o++);if(o!==r){let t;var l=o<i-1,u=(t=l?"AAC PES did not start with ADTS header,offset:"+o:"No ADTS header found in AAC PES",new Error(t));if(V.warn("parsing error: "+t),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,levelRetry:l,error:u,reason:t}),!l)return}qr(t,this.observer,s,o,this.audioCodec);let h;if(void 0!==e.pts)h=e.pts;else{if(!a)return void V.warn("[tsdemuxer]: AAC PES unknown PTS");var c=zr(t.samplerate);h=a.sample.pts+c}let d=0;for(;o<i;){if(n=Qr(t,s,o,h,d),o+=n.length,n.missing){this.aacOverFlow=n;break}for(d++;o<i-1&&!Yr(s,o);o++);}}parseMPEGPES(t,e){var r=e.data,i=r.length;let n=0,a=0;var s=e.pts;if(void 0===s)V.warn("[tsdemuxer]: MPEG PES unknown PTS");else for(;a<i;)if(si(r,a)){var o=ii(t,r,a,s,n);if(!o)break;a+=o.length,n++}else a++}parseID3PES(t,e){void 0===e.pts?V.warn("[tsdemuxer]: ID3 PES unknown PTS"):(e=G({},e,{type:this._avcTrack?Ie:Re,duration:Number.POSITIVE_INFINITY}),t.samples.push(e))}}function hi(t,e,r,i){return{key:t,frame:!1,pts:e,dts:r,units:[],debug:i,length:0}}function ci(t,e){return((31&t[e+1])<<8)+t[e+2]}function di(t){let i=0,n,e;let a,s;var o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&1<o.length;){var r=new Uint8Array(o[0].length+o[1].length);r.set(o[0]),r.set(o[1],o[0].length),o[0]=r,o.splice(1,1)}if(1!==((n=o[0])[0]<<16)+(n[1]<<8)+n[2])return null;{if((e=(n[4]<<8)+n[5])&&e>t.size-6)return null;var l=n[7];192&l&&(a=536870912*(14&n[9])+4194304*(255&n[10])+16384*(254&n[11])+128*(255&n[12])+(254&n[13])/2,64&l?(s=536870912*(14&n[14])+4194304*(255&n[15])+16384*(254&n[16])+128*(255&n[17])+(254&n[18])/2,54e5<a-s&&(V.warn(Math.round((a-s)/9e4)+"s delta between PTS and DTS, align them"),a=s)):s=a);let r=(l=n[8])+9;if(t.size<=r)return null;t.size-=r;var u=new Uint8Array(t.size);for(let e=0,t=o.length;e<t;e++){let t=(n=o[e]).byteLength;if(r){if(r>t){r-=t;continue}n=n.subarray(r),t-=r,r=0}u.set(n,i),i+=t}return e&&(e-=l+3),{data:u,pts:a,dts:s,len:e}}}function fi(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){var r=e.samples,i=r.length;if(!i)return void e.dropped++;r=r[i-1];t.pts=r.pts,t.dts=r.dts}e.samples.push(t)}t.debug.length&&V.log(t.pts+"/"+t.dts+":"+t.debug)}class pi{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const gi=Math.pow(2,32)-1;class W{static init(){W.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in W.types)W.types.hasOwnProperty(t)&&(W.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),e=(W.HDLR_TYPES={video:e,audio:r},new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])),r=new Uint8Array([0,0,0,0,0,0,0,0]),r=(W.STTS=W.STSC=W.STCO=r,W.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),W.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),W.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),W.STSD=new Uint8Array([0,0,0,0,0,0,0,1]),new Uint8Array([105,115,111,109])),i=new Uint8Array([97,118,99,49]),n=new Uint8Array([0,0,0,1]);W.FTYP=W.box(W.types.ftyp,r,n,r,i),W.DINF=W.box(W.types.dinf,W.box(W.types.dref,e))}static box(t,...e){let r=8,i=e.length;for(var n=i;i--;)r+=e[i].byteLength;var a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(t,4),i=0,r=8;i<n;i++)a.set(e[i],r),r+=e[i].byteLength;return a}static hdlr(t){return W.box(W.types.hdlr,W.HDLR_TYPES[t])}static mdat(t){return W.box(W.types.mdat,t)}static mdhd(t,e){e*=t;var r=Math.floor(e/(1+gi)),e=Math.floor(e%(1+gi));return W.box(W.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,e>>24,e>>16&255,e>>8&255,255&e,85,196,0,0]))}static mdia(t){return W.box(W.types.mdia,W.mdhd(t.timescale,t.duration),W.hdlr(t.type),W.minf(t))}static mfhd(t){return W.box(W.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?W.box(W.types.minf,W.box(W.types.smhd,W.SMHD),W.DINF,W.stbl(t)):W.box(W.types.minf,W.box(W.types.vmhd,W.VMHD),W.DINF,W.stbl(t))}static moof(t,e,r){return W.box(W.types.moof,W.mfhd(t),W.traf(r,e))}static moov(t){let e=t.length;for(var r=[];e--;)r[e]=W.trak(t[e]);return W.box.apply(null,[W.types.moov,W.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(W.mvex(t)))}static mvex(t){let e=t.length;for(var r=[];e--;)r[e]=W.trex(t[e]);return W.box.apply(null,[W.types.mvex,...r])}static mvhd(t,e){e*=t;var r=Math.floor(e/(1+gi)),e=Math.floor(e%(1+gi)),t=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,e>>24,e>>16&255,e>>8&255,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return W.box(W.types.mvhd,t)}static sdtp(t){var e,r=t.samples||[],i=new Uint8Array(4+r.length);let n;for(n=0;n<r.length;n++)e=r[n].flags,i[n+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return W.box(W.types.sdtp,i)}static stbl(t){return W.box(W.types.stbl,W.stsd(t),W.box(W.types.stts,W.STTS),W.box(W.types.stsc,W.STSC),W.box(W.types.stsz,W.STSZ),W.box(W.types.stco,W.STCO))}static avc1(t){let e=[],r=[],i,n,a;for(i=0;i<t.sps.length;i++)n=t.sps[i],a=n.byteLength,e.push(a>>>8&255),e.push(255&a),e=e.concat(Array.prototype.slice.call(n));for(i=0;i<t.pps.length;i++)n=t.pps[i],a=n.byteLength,r.push(a>>>8&255),r.push(255&a),r=r.concat(Array.prototype.slice.call(n));var s=W.box(W.types.avcC,new Uint8Array([1,e[3],e[4],e[5],255,224|t.sps.length].concat(e).concat([t.pps.length]).concat(r))),o=t.width,l=t.height,u=t.pixelRatio[0],h=t.pixelRatio[1];return W.box(W.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,W.box(W.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),W.box(W.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}static esds(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))}static mp4a(t){var e=t.samplerate;return W.box(W.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]),W.box(W.types.esds,W.esds(t)))}static mp3(t){var e=t.samplerate;return W.box(W.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,e>>8&255,255&e,0,0]))}static stsd(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?W.box(W.types.stsd,W.STSD,W.mp3(t)):W.box(W.types.stsd,W.STSD,W.mp4a(t)):W.box(W.types.stsd,W.STSD,W.avc1(t))}static tkhd(t){var e=t.id,r=t.duration*t.timescale,i=t.width,t=t.height,n=Math.floor(r/(1+gi)),r=Math.floor(r%(1+gi));return W.box(W.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,t>>8&255,255&t,0,0]))}static traf(t,e){var r=W.sdtp(t),i=t.id,n=Math.floor(e/(1+gi)),e=Math.floor(e%(1+gi));return W.box(W.types.traf,W.box(W.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),W.box(W.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,e>>24,e>>16&255,e>>8&255,255&e])),W.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,W.box(W.types.trak,W.tkhd(t),W.mdia(t))}static trex(t){t=t.id;return W.box(W.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){var r,i,n,a,s=t.samples||[],o=s.length,l=12+16*o,u=new Uint8Array(l);let h;for(u.set(["video"===t.type?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,255&o,(e+=8+l)>>>24&255,e>>>16&255,e>>>8&255,255&e],0),h=0;h<o;h++)r=(a=s[h]).duration,i=a.size,n=a.flags,a=a.cts,u.set([r>>>24&255,r>>>16&255,r>>>8&255,255&r,i>>>24&255,i>>>16&255,i>>>8&255,255&i,n.isLeading<<2|n.dependsOn,n.isDependedOn<<6|n.hasRedundancy<<4|n.paddingValue<<1|n.isNonSync,61440&n.degradPrio,15&n.degradPrio,a>>>24&255,a>>>16&255,a>>>8&255,255&a],12+16*h);return W.box(W.types.trun,u)}static initSegment(t){W.types||W.init();var t=W.moov(t),e=new Uint8Array(W.FTYP.byteLength+t.byteLength);return e.set(W.FTYP),e.set(t,W.FTYP.byteLength),e}}W.types=void 0,W.HDLR_TYPES=void 0,W.STTS=void 0,W.STSC=void 0,W.STCO=void 0,W.STSZ=void 0,W.VMHD=void 0,W.SMHD=void 0,W.STSD=void 0,W.FTYP=void 0,W.DINF=void 0;const vi=9e4;function mi(t,e,r=1,i=!1){t=t*e*r;return i?Math.round(t):t}function yi(t,e=!1){return mi(t,1e3,1/vi,e)}let Ei=null,Ti=null;class bi{constructor(t,e,r,i=0){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1,null===Ei&&(t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),Ei=t?parseInt(t[1]):0),null===Ti&&(e=navigator.userAgent.match(/Safari\/(\d+)/i),Ti=e?parseInt(e[1]):0)}destroy(){}resetTimeStamp(t){V.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){V.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){V.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(t){let i=!1;t=t.reduce((t,e)=>{var r=e.pts-t;return r<-4294967296?(i=!0,Y(t,e.pts)):0<r?t:e.pts},t[0].pts);return i&&V.debug("PTS rollover detected"),t}remux(r,i,t,e,n,a,s,o){let l,u,h,c,d,f,p=n,g=n;var v=-1<r.pid,m=-1<i.pid,y=i.samples.length,E=0<r.samples.length,T=s&&0<y||1<y;if((!v||E)&&(!m||T)||this.ISGenerated||s){this.ISGenerated||(h=this.generateIS(r,i,n,a));v=this.isVideoContiguous;let t=-1,e;T&&(t=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(i.samples),!v)&&this.config.forceKeyFrameOnDiscontinuity&&(f=!0,0<t?(V.warn(`[mp4-remuxer]: Dropped ${t} out of ${y} video samples due to a missing keyframe`),s=this.getVideoStartPts(i.samples),i.samples=i.samples.slice(t),i.dropped+=t,g+=(i.samples[0].pts-s)/i.inputTimeScale,e=g):-1===t&&(V.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),f=!1)),this.ISGenerated&&(E&&T&&(s=this.getVideoStartPts(i.samples),y=(Y(r.samples[0].pts,s)-s)/i.inputTimeScale,p+=Math.max(0,y),g+=Math.max(0,-y)),E?(r.samplerate||(V.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(r,i,n,a)),u=this.remuxAudio(r,p,this.isAudioContiguous,a,m||T||o===_?g:void 0),T&&(s=u?u.endPTS-u.startPTS:0,i.inputTimeScale||(V.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(r,i,n,a)),l=this.remuxVideo(i,g,v,s))):T&&(l=this.remuxVideo(i,g,v,0)),l)&&(l.firstKeyFrame=t,l.independent=-1!==t,l.firstKeyFramePTS=e)}return this.ISGenerated&&this._initPTS&&this._initDTS&&(t.samples.length&&(d=Ai(t,n,this._initPTS,this._initDTS)),e.samples.length)&&(c=_i(e,n,this._initPTS)),{audio:u,video:l,initSegment:h,independent:f,text:c,id3:d}}generateIS(t,e,r,i){var n=t.samples,a=e.samples,s=this.typeSupported,o={},l=this._initPTS;let u=!l||i,h="audio/mp4",c,d,f;if(u&&(c=d=1/0),t.config&&n.length&&(t.timescale=t.samplerate,"mp3"===t.segmentCodec&&(s.mpeg?(h="audio/mpeg",t.codec=""):s.mp3&&(t.codec="mp3")),o.audio={id:"audio",container:h,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&s.mpeg?new Uint8Array(0):W.initSegment([t]),metadata:{channelCount:t.channelCount}},u)&&(f=t.inputTimeScale,l&&f===l.timescale?u=!1:c=d=n[0].pts-Math.round(f*r)),e.sps&&e.pps&&a.length&&(e.timescale=e.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:W.initSegment([e]),metadata:{width:e.width,height:e.height}},u)&&(f=e.inputTimeScale,l&&f===l.timescale?u=!1:(i=this.getVideoStartPts(a),s=Math.round(f*r),d=Math.min(d,Y(a[0].dts,i)-s),c=Math.min(c,i-s))),Object.keys(o).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:c,timescale:f},this._initDTS={baseTime:d,timescale:f}):c=f=void 0,{tracks:o,initPTS:c,timescale:f}}remuxVideo(t,e,r,i){var n=t.inputTimeScale,a=t.samples,s=[],o=a.length,l=this._initPTS;let u=this.nextAvcDts,h=8,c=this.videoSampleDuration,d,f=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,g=!1;r&&null!==u||(e=e*n,M=a[0].pts-Y(a[0].dts,a[0].pts),u=e-M);var v=l.baseTime*n/l.timescale;for(let t=0;t<o;t++){var m=a[t];m.pts=Y(m.pts-v,u),m.dts=Y(m.dts-v,u),m.dts<a[0<t?t-1:t].dts&&(g=!0)}g&&a.sort(function(t,e){var r=t.dts-e.dts,t=t.pts-e.pts;return r||t}),d=a[0].dts;var e=a[a.length-1].dts-d,y=e?Math.round(e/(o-1)):c||t.inputTimeScale/30;r&&(l=(M=d-u)<-1,(e=y<M)||l)&&(e?V.warn(`AVC: ${yi(M,!0)} ms (${M}dts) hole between fragments detected, filling it`):V.warn(`AVC: ${yi(-M,!0)} ms (${M}dts) overlapping between fragments detected`),!l||u>=a[0].pts)&&(d=u,r=a[0].pts-M,a[0].dts=d,a[0].pts=r,V.log(`Video: First PTS/DTS adjusted: ${yi(r,!0)}/${yi(d,!0)}, delta: ${yi(M,!0)} ms`)),d=Math.max(0,d);let E=0,T=0;for(let t=0;t<o;t++){var b=a[t],A=b.units,_=A.length;let e=0;for(let t=0;t<_;t++)e+=A[t].data.length;T+=e,E+=_,b.length=e,b.dts=Math.max(b.dts,d),f=Math.min(b.pts,f),p=Math.max(b.pts,p)}e=a[o-1].dts;l=T+4*E+8;let S;try{S=new Uint8Array(l)}catch(t){return void this.observer.emit($.ERROR,$.ERROR,{type:K.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:l,reason:"fail allocating video mdat "+l})}var L=new DataView(S.buffer);L.setUint32(0,l),S.set(W.types.mdat,4);let k=!1,R=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,D=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){var C,P=a[e],F=P.units;let r=0;for(let t=0,e=F.length;t<e;t++){var x=F[t],N=x.data,x=x.data.byteLength;L.setUint32(h,x),h+=4,S.set(N,h),h+=x,r+=4+x}let t;e<o-1?(c=a[e+1].dts-P.dts,t=a[e+1].pts-P.pts):(O=this.config,C=0<e?P.dts-a[e-1].dts:y,t=0<e?P.pts-a[e-1].pts:y,O.stretchShortVideoTrack&&null!==this.nextAudioPts&&Math.floor(O.maxBufferHole*n)<(O=(i?f+i*n:this.nextAudioPts)-P.pts)?((c=O-C)<0?c=C:k=!0,V.log(`[mp4-remuxer]: It is approximately ${O/90} ms to the next segment; using duration ${c/90} ms for the last video frame.`)):c=C);var O=Math.round(P.pts-P.dts);R=Math.min(R,c),I=Math.max(I,c),w=Math.min(w,t),D=Math.max(D,t),s.push(new Si(P.key,c,r,O))}if(s.length)if(Ei)Ei<70&&((r=s[0].flags).dependsOn=2,r.isNonSync=0);else if(Ti&&D-w<I-R&&y/I<.025&&0===s[0].cts){V.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let r=d;for(let t=0,e=s.length;t<e;t++){var B,U=r+s[t].duration,j=r+s[t].cts;t<e-1?(B=U+s[t+1].cts,s[t].duration=B-j):s[t].duration=t?s[t-1].duration:y,s[t].cts=0,r=U}}c=k||!c?y:c,this.nextAvcDts=u=e+c,this.videoSampleDuration=c,this.isVideoContiguous=!0;var M={data1:W.moof(t.sequenceNumber++,d,G({},t,{samples:s})),data2:S,startPTS:f/n,endPTS:(p+c)/n,startDTS:d/n,endDTS:u/n,type:"video",hasAudio:!1,hasVideo:!0,nb:s.length,dropped:t.dropped};return t.samples=[],t.dropped=0,M}remuxAudio(n,t,r,e,i){var a=n.inputTimeScale,s=a/(n.samplerate||a),o="aac"===n.segmentCodec?1024:1152,l=o*s,u=this._initPTS,h="mp3"===n.segmentCodec&&this.typeSupported.mpeg,c=[],d=void 0!==i;let f=n.samples,p=h?0:8,g=this.nextAudioPts||-1;const v=t*a,m=u.baseTime*a/u.timescale;if(this.isAudioContiguous=r=r||f.length&&0<g&&(e&&Math.abs(v-g)<9e3||Math.abs(Y(f[0].pts-m,v)-g)<20*l),f.forEach(function(t){t.pts=Y(t.pts-m,v)}),!r||g<0){if(!(f=f.filter(t=>0<=t.pts)).length)return;g=0===i?0:e&&!d?Math.max(0,v):f[0].pts}if("aac"===n.segmentCodec){var y=this.config.maxAudioFramesDrift;for(let r=0,i=g;r<f.length;r++){var E=f[r],T=E.pts,b=T-i,A=Math.abs(1e3*b/a);if(b<=-y*l&&d)0===r&&(V.warn(`Audio frame @ ${(T/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*b/a)} ms.`),this.nextAudioPts=g=i=T);else if(y*l<=b&&A<1e4&&d){let e=Math.round(b/l);(i=T-e*l)<0&&(e--,i+=l),0===r&&(this.nextAudioPts=g=i),V.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(i/a).toFixed(3)}s due to ${Math.round(1e3*b/a)} ms gap.`);for(let t=0;t<e;t++){var _=Math.max(i,0);let t=pi.getSilentFrame(n.manifestCodec||n.codec,n.channelCount);t||(V.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),t=E.unit.subarray()),f.splice(r,0,{unit:t,pts:_}),i+=l,r++}}E.pts=i,i+=l}}let S=null,L=null,k,R=0,w=f.length;for(;w--;)R+=f[w].unit.byteLength;for(let e=0,t=f.length;e<t;e++){var I=f[e],D=I.unit;let t=I.pts;if(null!==L)c[e-1].duration=Math.round((t-L)/s);else{if(r&&"aac"===n.segmentCodec&&(t=g),S=t,!(0<R))return;R+=p;try{k=new Uint8Array(R)}catch(t){return void this.observer.emit($.ERROR,$.ERROR,{type:K.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:R,reason:"fail allocating audio mdat "+R})}h||(new DataView(k.buffer).setUint32(0,R),k.set(W.types.mdat,4))}k.set(D,p);I=D.byteLength;p+=I,c.push(new Si(!0,o,I,0)),L=t}t=c.length;if(t)return u=c[c.length-1],this.nextAudioPts=g=L+s*u.duration,i=h?new Uint8Array(0):W.moof(n.sequenceNumber++,S/s,G({},n,{samples:c})),n.samples=[],e=S/a,u=g/a,i={data1:i,data2:k,startPTS:e,endPTS:u,startDTS:e,endDTS:u,type:"audio",hasAudio:!0,hasVideo:!1,nb:t},this.isAudioContiguous=!0,i}remuxEmptyAudio(t,e,r,i){var n=t.inputTimeScale,a=t.samplerate||n,s=this.nextAudioPts,o=this._initDTS,o=9e4*o.baseTime/o.timescale,l=(null!==s?s:i.startDTS*n)+o,s=i.endDTS*n+o,u=1024*(n/a),h=Math.ceil((s-l)/u),c=pi.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(V.warn("[mp4-remuxer]: remux empty Audio"),c){var d=[];for(let t=0;t<h;t++){var f=l+t*u;d.push({unit:c,pts:f,dts:f})}return t.samples=d,this.remuxAudio(t,e,r,!1)}V.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")}}function Y(t,e){let r;if(null!==e)for(r=e<t?-8589934592:8589934592;4294967296<Math.abs(t-e);)t+=r;return t}function Ai(e,r,i,n){var a=e.samples.length;if(a){var s=e.inputTimeScale;for(let t=0;t<a;t++){var o=e.samples[t];o.pts=Y(o.pts-i.baseTime*s/i.timescale,r*s)/s,o.dts=Y(o.dts-n.baseTime*s/n.timescale,r*s)/s}var t=e.samples;return e.samples=[],{samples:t}}}function _i(e,r,i){var n=e.samples.length;if(n){var a=e.inputTimeScale;for(let t=0;t<n;t++){var s=e.samples[t];s.pts=Y(s.pts-i.baseTime*a/i.timescale,r*a)/a}e.samples.sort((t,e)=>t.pts-e.pts);var t=e.samples;return e.samples=[],{samples:t}}}class Si{constructor(t,e,r,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=e,this.size=r,this.cts=i,this.flags=new Li(t)}}class Li{constructor(t){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=t?2:1,this.isNonSync=t?0:1}}function ki(t,e){t=null==t?void 0:t.codec;return t&&4<t.length?t:"hvc1"===t||"hev1"===t?"hvc1.1.6.L120.90":"av01"===t?"av01.0.04M.08":"avc1"===t||e===k?"avc1.42e01e":"mp4a.40.5"}let Ri;try{Ri=self.performance.now.bind(self.performance)}catch(t){V.debug("Unable to use Performance API on this environment"),Ri="undefined"!=typeof self&&self.Date.now}const wi=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,r,i){var n,a,s,o=this.videoTrack=c("video",1),l=this.audioTrack=c("audio",1),u=this.txtTrack=c("text",1);this.id3Track=c("id3",1),this.timeOffset=0,null!=t&&t.byteLength&&((t=$t(t)).video&&({id:n,timescale:a,codec:s}=t.video,o.id=n,o.timescale=u.timescale=a,o.codec=s),t.audio&&({id:n,timescale:a,codec:s}=t.audio,l.id=n,l.timescale=a,l.codec=s),u.id=Bt.text,o.sampleDuration=0,o.duration=l.duration=i)}resetContiguity(){this.remainderData=null}static probe(t){return 0<w(t=16384<t.length?t.subarray(0,16384):t,["moof"]).length}demux(t,e){this.timeOffset=e;let r=t;var i,n=this.videoTrack,a=this.txtTrack,s=(this.config.progressive?(this.remainderData&&(r=Vt(this.remainderData,t)),t=r,i={valid:null,remainder:null},(s=w(t,["moof"]))&&(s.length<2?i.remainder=t:(s=s[s.length-1],i.valid=St(t,0,s.byteOffset-8),i.remainder=St(t,s.byteOffset-8))),t=i,this.remainderData=t.remainder,n.samples=t.valid||new Uint8Array):n.samples=r,this.extractID3Track(n,e));return a.samples=Wt(e,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){var t=this.timeOffset,e=this.videoTrack,r=this.txtTrack,i=(e.samples=this.remainderData||new Uint8Array,this.remainderData=null,this.extractID3Track(e,this.timeOffset));return r.samples=Wt(t,e),{videoTrack:e,audioTrack:c(),id3Track:i,textTrack:c()}}extractID3Track(t,i){const n=this.id3Track;return t.samples.length&&(t=w(t.samples,["emsg"]))&&t.forEach(e=>{e=function(t){var e=t[0];let r="",i="",n=0,a=0,s=0,o=0,l=0,u=0;if(0===e){for(;"\0"!==v(t.subarray(u,u+1));)r+=v(t.subarray(u,u+1)),u+=1;for(r+=v(t.subarray(u,u+1)),u+=1;"\0"!==v(t.subarray(u,u+1));)i+=v(t.subarray(u,u+1)),u+=1;i+=v(t.subarray(u,u+1)),u+=1,n=R(t,12),a=R(t,16),o=R(t,20),l=R(t,24),u=28}else if(1===e){u+=4,n=R(t,u);var e=R(t,u+=4),h=R(t,u+=4);for(u+=4,s=2**32*e+h,Number.isSafeInteger(s)||(s=Number.MAX_SAFE_INTEGER,V.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=R(t,u),u+=4,l=R(t,u),u+=4;"\0"!==v(t.subarray(u,u+1));)r+=v(t.subarray(u,u+1)),u+=1;for(r+=v(t.subarray(u,u+1)),u+=1;"\0"!==v(t.subarray(u,u+1));)i+=v(t.subarray(u,u+1)),u+=1;i+=v(t.subarray(u,u+1)),u+=1}return e=t.subarray(u,t.byteLength),{schemeIdUri:r,value:i,timeScale:n,presentationTime:s,presentationTimeDelta:a,eventDuration:o,id:l,payload:e}}(e);if(Xr.test(e.schemeIdUri)){var r=N(e.presentationTime)?e.presentationTime/e.timeScale:i+e.presentationTimeDelta/e.timeScale;let t=4294967295===e.eventDuration?Number.POSITIVE_INFINITY:e.eventDuration/e.timeScale;t<=.001&&(t=Number.POSITIVE_INFINITY);e=e.payload;n.samples.push({data:e,len:e.byteLength,dts:r,pts:r,type:Ie,duration:t})}}),n}demuxSampleAes(t,e,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,e,r,i){this.audioCodec=e,this.videoCodec=r,this.generateInitSegment(function(t,e){if(t&&e){const i=e.keyId;i&&e.isCommonEncryption&&w(t,["moov","trak"]).forEach(t=>{t=w(t,["mdia","minf","stbl","stsd"])[0].subarray(8);let e=w(t,["enca"]);const r=0<e.length;(e=r?e:w(t,["encv"])).forEach(t=>{w(r?t.subarray(28):t.subarray(78),["sinf"]).forEach(t=>{var e,t=Kt(t);t&&!(e=t.subarray(8,24)).some(t=>0!==t)&&(V.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${g.hexDump(e)} -> `+g.hexDump(i)),t.set(i,8))})})})}return t}(t,i)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:e,videoCodec:r}=this;var i,n;null!=t&&t.byteLength?(i=this.initData=$t(t),e=e||ki(i.audio,y),r=r||ki(i.video,k),n={},i.audio&&i.video?n.audiovideo={container:"video/mp4",codec:e+","+r,initSegment:t,id:"main"}:i.audio?n.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:i.video?n.video={container:"video/mp4",codec:r,initSegment:t,id:"main"}:V.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=n):(this.initTracks=void 0,this.initData=void 0)}remux(r,i,n,a,s,o){let{initPTS:l,lastEndTime:u}=this;var h={audio:void 0,video:void 0,text:a,id3:n,initSegment:void 0},i=(N(u)||(u=this.lastEndTime=s||0),i.samples);if(null!=i&&i.length){var c={initPTS:void 0,timescale:1};let e=this.initData;if(null!=(g=e)&&g.length||(this.generateInitSegment(i),e=this.initData),null!=(g=e)&&g.length){this.emitInitSegment&&(c.tracks=this.initTracks,this.emitInitSegment=!1);var d,f,p,g=Ht(i,e),v=(d=e,w(i,["moof","traf"]).reduce((t,e)=>{const i=w(e,["tfdt"])[0],n=i[0];e=w(e,["tfhd"]).reduce((e,r)=>{r=R(r,4),r=d[r];if(r){let t=R(i,4);if(1===n){if(t===Ft)return V.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),e;t=(t*=1+Ft)+R(i,8)}r=r.timescale||9e4,r=t/r;if(isFinite(r)&&(null===e||r<e))return r}return e},null);return null!==e&&isFinite(e)&&(null===t||e<t)?e:t},null)),v=null===v?s:v,o=((function(t,e,r,i){if(null===t)return 1;i=Math.max(i,1),e-=t.baseTime/t.timescale;return Math.abs(e-r)>i}(l,v,s,g)||c.timescale!==l.timescale&&o)&&(c.initPTS=v-s,l&&1===l.timescale&&V.warn("Adjusting initPTS by "+(c.initPTS-l.baseTime)),this.initPTS=l={baseTime:c.initPTS,timescale:1}),r?v-l.baseTime/l.timescale:u),r=o+g,v=(f=e,p=l.baseTime/l.timescale,w(i,["moof","traf"]).forEach(e=>{w(e,["tfhd"]).forEach(t=>{t=R(t,4),t=f[t];if(t){const n=t.timescale||9e4;w(e,["tfdt"]).forEach(t=>{var e,r=t[0];let i=R(t,4);0===r?(i-=p*n,Gt(t,4,i=Math.max(i,0))):(i=(i=(i*=Math.pow(2,32))+R(t,8))-p*n,i=Math.max(i,0),r=Math.floor(i/(1+Ft)),e=Math.floor(i%(1+Ft)),Gt(t,4,r),Gt(t,8,e))})}})}),0<g?this.lastEndTime=r:(V.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp()),!!e.audio),g=!!e.video;let t="";v&&(t+="audio"),g&&(t+="video");i={data1:i,startPTS:o,startDTS:o,endPTS:r,endDTS:r,type:t,hasAudio:v,hasVideo:g,nb:1,dropped:0};h.audio="audio"===i.type?i:void 0,h.video="audio"!==i.type?i:void 0,h.initSegment=c,h.id3=Ai(n,s,l,l),a.samples.length&&(h.text=_i(a,s,l))}else V.warn("[passthrough-remuxer.ts]: Failed to generate initSegment.")}return h}}},{demux:ui,remux:bi},{demux:class extends $r{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,r,i){super.resetInitSegment(t,e,r,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(e){let t=(Rt(e,0)||[]).length;for(var r,i,n,a,s=e.length;t<s;t++)if(r=e,i=t,a=n=void 0,!Yr(r,i)||i+(a=Vr(r,i))>=r.length?void 0:!((n=Wr(r,i))<=a)&&((a=i+n)===r.length||Yr(r,a)))return V.log("ADTS sync word found !"),!0}return!1}canParse(t,e){return(e=e)+5<(t=t).length&&Hr(t,e)&&Wr(t,e)<=t.length-e}appendFrame(t,e,r){qr(t,this.observer,e,r,t.manifestCodec);t=Qr(t,e,r,this.basePTS,this.frameIndex);if(t&&0===t.missing)return t}},remux:bi},{demux:class extends $r{resetInitSegment(t,e,r,i){super.resetInitSegment(t,e,r,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(e){let t=(Rt(e,0)||[]).length;for(var r=e.length;t<r;t++)if(function(e,r){if(r+1<e.length&&ai(e,r)){var i=ni(e,r);let t=4;r=r+(t=null!=i&&i.frameLength?i.frameLength:t);return r===e.length||si(e,r)}}(e,t))return V.log("MPEG Audio sync word found !"),!0}return!1}canParse(t,e){return ai(t=t,e=e)&&4<=t.length-e}appendFrame(t,e,r){if(null!==this.basePTS)return ii(t,e,r,this.basePTS,this.frameIndex)}},remux:bi}];class Ii{constructor(t,e,r,i,n){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=r,this.vendor=i,this.id=n}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,r,i){var n=r.transmuxing;n.executeStart=Ri();let a=new Uint8Array(t);var{currentTransmuxState:t,transmuxConfig:s}=this,{contiguous:i,discontinuity:t,trackSwitch:o,accurateTimeOffset:l,timeOffset:u,initSegmentChange:h}=(i&&(this.currentTransmuxState=i),i||t),{audioCodec:s,videoCodec:c,defaultInitPts:d,duration:f,initSegmentData:p}=s,g=function(t,e){let r=null;0<t.byteLength&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(r=e);return r}(a,e);if(g&&"AES-128"===g.method){var v=this.getDecrypter();if(!v.isSync())return this.decryptionPromise=v.webCryptoDecrypt(a,g.key.buffer,g.iv.buffer).then(t=>{t=this.push(t,null,r);return this.decryptionPromise=null,t}),this.decryptionPromise;{let t=v.softwareDecrypt(a,g.key.buffer,g.iv.buffer);var m=-1<r.part;if(!(t=m?v.flush():t))return n.executeEnd=Ri(),Di(r);a=new Uint8Array(t)}}m=this.needsProbing(t,o);if(m){v=this.configureTransmuxer(a);if(v)return V.warn("[transmuxer] "+v.message),this.observer.emit($.ERROR,$.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:v,reason:v.message}),n.executeEnd=Ri(),Di(r)}(t||o||h||m)&&this.resetInitSegment(p,s,c,f,e),(t||h||m)&&this.resetInitialTimestamp(d),i||this.resetContiguity();v=this.transmux(a,g,u,l,r),o=this.currentTransmuxState;return o.contiguous=!0,o.discontinuity=!1,o.trackSwitch=!1,n.executeEnd=Ri(),v}flush(e){var t=e.transmuxing,{decrypter:r,currentTransmuxState:i,decryptionPromise:n}=(t.executeStart=Ri(),this);if(n)return n.then(()=>this.flush(e));const a=[];var n=i["timeOffset"],{demuxer:r,remuxer:i}=(r&&(i=r.flush())&&a.push(this.push(i,null,e)),this);return r&&i?Ci(i=r.flush(n))?i.then(t=>(this.flushRemux(a,t,e),a)):(this.flushRemux(a,i,e),a):(t.executeEnd=Ri(),[Di(e)])}flushRemux(t,e,r){var{audioTrack:e,videoTrack:i,id3Track:n,textTrack:a}=e,{accurateTimeOffset:s,timeOffset:o}=this.currentTransmuxState,e=(V.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${-1<r.part?" p: "+r.part:""} of level `+r.level),this.remuxer.remux(e,i,n,a,o,s,!0,this.id));t.push({remuxResult:e,chunkMeta:r}),r.transmuxing.executeEnd=Ri()}resetInitialTimestamp(t){var{demuxer:e,remuxer:r}=this;e&&r&&(e.resetTimeStamp(t),r.resetTimeStamp(t))}resetContiguity(){var{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,r,i,n){var{demuxer:a,remuxer:s}=this;a&&s&&(a.resetInitSegment(t,e,r,i),s.resetInitSegment(t,e,r,n))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,r,i,n){let a;return a=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,r,i,n):this.transmuxUnencrypted(t,r,i,n)}transmuxUnencrypted(t,e,r,i){var{audioTrack:t,videoTrack:n,id3Track:a,textTrack:s}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(t,n,a,s,e,r,!1,this.id),chunkMeta:i}}transmuxSampleAes(t,e,r,i,n){return this.demuxer.demuxSampleAes(t,e,r).then(t=>{return{remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,r,i,!1,this.id),chunkMeta:n}})}configureTransmuxer(r){var{config:t,observer:e,typeSupported:i,vendor:n}=this;let a;for(let t=0,e=wi.length;t<e;t++)if(wi[t].demux.probe(r)){a=wi[t];break}if(!a)return new Error("Failed to find demuxer by probing fragment data");var s=this.demuxer,o=this.remuxer,l=a.remux,u=a.demux;o&&o instanceof l||(this.remuxer=new l(e,t,i,n)),s&&s instanceof u||(this.demuxer=new u(e,t,i),this.probe=u.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t=t||(this.decrypter=new Br(this.config))}}const Di=t=>({remuxResult:{},chunkMeta:t});function Ci(t){return"then"in t&&t.then instanceof Function}class Pi{constructor(t,e,r,i,n){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=r,this.duration=i,this.defaultInitPts=n||null}}class xi{constructor(t,e,r,i,n,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=r,this.trackSwitch=i,this.timeOffset=n,this.initSegmentChange=a}}var Oi,D,t={exports:{}};function Mi(){}function Fi(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Ni(t,e,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");r=new Fi(r,i||t,n),i=D?D+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],r]:t._events[i].push(r):(t._events[i]=r,t._eventsCount++),t}function Bi(t,e){0==--t._eventsCount?t._events=new Mi:delete t._events[e]}function r(){this._events=new Mi,this._eventsCount=0}e=t,Oi=Object.prototype.hasOwnProperty,D="~",Object.create&&(Mi.prototype=Object.create(null),(new Mi).__proto__||(D=!1)),r.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)Oi.call(t,e)&&r.push(D?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},r.prototype.listeners=function(t){var t=D?D+t:t,e=this._events[t];if(!e)return[];if(e.fn)return[e.fn];for(var r=0,i=e.length,n=new Array(i);r<i;r++)n[r]=e[r].fn;return n},r.prototype.listenerCount=function(t){t=D?D+t:t,t=this._events[t];return t?t.fn?1:t.length:0},r.prototype.emit=function(t,e,r,i,n,a){var s=D?D+t:t;if(!this._events[s])return!1;var o,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,n),!0;case 6:return l.fn.call(l.context,e,r,i,n,a),!0}for(d=1,o=new Array(u-1);d<u;d++)o[d-1]=arguments[d];l.fn.apply(l.context,o)}else for(var h,c=l.length,d=0;d<c;d++)switch(l[d].once&&this.removeListener(t,l[d].fn,void 0,!0),u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,e);break;case 3:l[d].fn.call(l[d].context,e,r);break;case 4:l[d].fn.call(l[d].context,e,r,i);break;default:if(!o)for(h=1,o=new Array(u-1);h<u;h++)o[h-1]=arguments[h];l[d].fn.apply(l[d].context,o)}return!0},r.prototype.on=function(t,e,r){return Ni(this,t,e,r,!1)},r.prototype.once=function(t,e,r){return Ni(this,t,e,r,!0)},r.prototype.removeListener=function(t,e,r,i){t=D?D+t:t;if(this._events[t])if(e){var n=this._events[t];if(n.fn)n.fn!==e||i&&!n.once||r&&n.context!==r||Bi(this,t);else{for(var a=0,s=[],o=n.length;a<o;a++)(n[a].fn!==e||i&&!n[a].once||r&&n[a].context!==r)&&s.push(n[a]);s.length?this._events[t]=1===s.length?s[0]:s:Bi(this,t)}}else Bi(this,t);return this},r.prototype.removeAllListeners=function(t){return t?(t=D?D+t:t,this._events[t]&&Bi(this,t)):(this._events=new Mi,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=D,e.exports=r.EventEmitter=r;var Ui=M(t.exports);const ji=re()||{isTypeSupported:()=>!1};class Gi{constructor(t,e,r,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const n=t.config;this.hls=t,this.id=e,this.useWorker=!!n.enableWorker,this.onTransmuxComplete=r,this.onFlush=i;var a,s,t=(t,e)=>{(e=e||{}).frag=this.frag,e.id=this.id,t===$.ERROR&&(this.error=e.error),this.hls.trigger(t,e)},r=(this.observer=new Ui,this.observer.on($.FRAG_DECRYPTED,t),this.observer.on($.ERROR,t),{mp4:ji.isTypeSupported("video/mp4"),mpeg:ji.isTypeSupported("audio/mpeg"),mp3:ji.isTypeSupported('audio/mp4; codecs="mp3"')}),i=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker&&(n.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__)){try{n.workerPath?(V.log(`loading Web Worker ${n.workerPath} for "${e}"`),this.workerContext=(s=n.workerPath,s=new self.URL(s,self.location.href).href,{worker:new self.Worker(s),scriptURL:s})):(V.log(`injecting Web Worker for "${e}"`),this.workerContext=(a=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),a=self.URL.createObjectURL(a),{worker:new self.Worker(a),objectURL:a})),this.onwmsg=t=>this.onWorkerMessage(t);var o=this.workerContext["worker"];o.addEventListener("message",this.onwmsg),o.onerror=t=>{t=new Error(`${t.message}  (${t.filename}:${t.lineno})`);n.enableWorker=!1,V.warn(`Error in "${e}" Web Worker, fallback to inline`),this.hls.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})},o.postMessage({cmd:"init",typeSupported:r,vendor:i,id:e,config:JSON.stringify(n)})}catch(t){V.warn(`Error setting up "${e}" Web Worker, fallback to inline`,t),this.resetWorker(),this.error=null,this.transmuxer=new Ii(this.observer,r,n,i,e)}return}this.transmuxer=new Ii(this.observer,r,n,i,e)}resetWorker(){var t,e;this.workerContext&&({worker:t,objectURL:e}=this.workerContext,e&&self.URL.revokeObjectURL(e),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null)}destroy(){this.workerContext?(this.resetWorker(),this.onwmsg=void 0):(t=this.transmuxer)&&(t.destroy(),this.transmuxer=null);var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,e,r,i,n,a,s,o,l,u){var h=(l.transmuxing.start=self.performance.now(),this)["transmuxer"],c=(a||n).start,d=n.decryptdata,f=this.frag,p=!(f&&n.cc===f.cc),g=!(f&&l.level===f.level),v=f?l.sn-f.sn:-1,m=this.part?l.part-this.part.index:-1,y=0==v&&1<l.id&&l.id===(null==f?void 0:f.stats.chunkCount),y=!g&&(1==v||0==v&&(1==m||y&&m<=0)),E=self.performance.now(),E=((g||v||0===n.stats.parsing.start)&&(n.stats.parsing.start=E),!a||!m&&y||(a.stats.parsing.start=E),!(f&&(null==(v=n.initSegment)?void 0:v.url)===(null==(m=f.initSegment)?void 0:m.url))),v=new xi(p,y,o,g,c,E);y&&!p&&!E||(V.log(`[transmuxer-interface, ${n.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}
        discontinuity: ${p}
        trackSwitch: ${g}
        contiguous: ${y}
        accurateTimeOffset: ${o}
        timeOffset: ${c}
        initSegmentChange: `+E),f=new Pi(r,i,e,s,u),this.configureTransmuxer(f)),this.frag=n,this.part=a,this.workerContext?this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:d,chunkMeta:l,state:v},t instanceof ArrayBuffer?[t]:[]):h&&(Ci(m=h.push(t,d,l,v))?(h.async=!0,m.then(t=>{this.handleTransmuxComplete(t)}).catch(t=>{this.transmuxerError(t,l,"transmuxer-interface push error")})):(h.async=!1,this.handleTransmuxComplete(m)))}flush(e){e.transmuxing.start=self.performance.now();var r=this["transmuxer"];if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){let t=r.flush(e);Ci(t)||r.async?(t=Ci(t)?t:Promise.resolve(t)).then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}):this.handleFlushResult(t,e)}}transmuxerError(t,e,r){this.hls&&(this.error=t,this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,chunkMeta:e,fatal:!1,error:t,err:t,reason:r}))}handleFlushResult(t,e){t.forEach(t=>{this.handleTransmuxComplete(t)}),this.onFlush(e)}onWorkerMessage(t){var e=t.data,r=this.hls;switch(e.event){case"init":var i=null==(i=this.workerContext)?void 0:i.objectURL;i&&self.URL.revokeObjectURL(i);break;case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":V[e.data.logType]&&V[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}}configureTransmuxer(t){var e=this["transmuxer"];this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):e&&e.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class $i{constructor(t,e,r,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=e,this.fragmentTracker=r,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,e){var{config:r,media:i,stalled:n}=this;if(null!==i){var{currentTime:a,seeking:s}=i,o=this.seeking&&!s,l=!this.seeking&&s;if(this.seeking=s,a!==t)this.moved=!0,null!==n&&(this.stallReported&&(t=self.performance.now()-n,V.warn(`playback not stuck anymore @${a}, after ${Math.round(t)}ms`),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0);else if(l||o)this.stalled=null;else if(!(i.paused&&!s||i.ended||0===i.playbackRate)&&S.getBuffered(i).length){t=S.bufferInfo(i,a,0),l=0<t.len,o=t.nextStart||0;if(l||o){if(s){l=2<t.len,e=!o||e&&e.start<=a||2<o-a&&!this.fragmentTracker.getPartialFragment(a);if(l||e)return;this.moved=!1}if(!this.moved&&null!==this.stalled){l=Math.max(o,t.start||0)-a,e=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,o=(null==e||null==(o=e.details)?void 0:o.live)?2*e.details.targetduration:2,e=this.fragmentTracker.getPartialFragment(a);if(0<l&&(l<=o||e))return void this._trySkipBufferHole(e)}l=self.performance.now();null===n?this.stalled=l:(o=l-n,!s&&250<=o&&(this._reportStall(t),!this.media)||(e=S.bufferInfo(i,a,r.maxBufferHole),this._tryFixBufferStall(e,o)))}}}}_tryFixBufferStall(t,e){var{config:r,fragmentTracker:i,media:n}=this;if(null!==n){n=n.currentTime,i=i.getPartialFragment(n);if(i)if(this._trySkipBufferHole(i)||!this.media)return;(t.len>r.maxBufferHole||t.nextStart&&t.nextStart-n<r.maxBufferHole)&&e>1e3*r.highBufferWatchdogPeriod&&(V.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}}_reportStall(t){var{hls:e,media:r,stallReported:i}=this;!i&&r&&(this.stallReported=!0,i=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(t)})`),V.warn(i.message),e.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,fatal:!1,error:i,buffer:t.len}))}_trySkipBufferHole(e){var{config:t,hls:r,media:i}=this;if(null!==i){var n=i.currentTime,a=S.bufferInfo(i,n,0),s=n<a.start?a.start:a.nextStart;if(s){var o=a.len<=t.maxBufferHole,a=0<a.len&&a.len<1&&i.readyState<3,l=s-n;if(0<l&&(o||a)){if(l>t.maxBufferHole){var u=this["fragmentTracker"];let t=!1;if(!(t=0===n&&(o=u.getAppendedFrag(0,A))&&s<o.end?!0:t)){a=e||u.getAppendedFrag(n,A);if(a){let t=!1,e=a.end;for(;e<s;){var h=u.getPartialFragment(e);if(!h){t=!0;break}e+=h.duration}if(t)return 0}}}l=Math.max(s+.05,n+.1);return V.warn(`skipping hole, adjusting currentTime from ${n} to `+l),this.moved=!0,this.stalled=null,i.currentTime=l,e&&!e.gap&&(t=new Error(`fragment loaded with buffer holes, seeking from ${n} to `+l),r.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})),l}}}return 0}_tryNudgeBuffer(){var t,e,{config:r,hls:i,media:n,nudgeRetry:a}=this;null!==n&&(t=n.currentTime,this.nudgeRetry++,a<r.nudgeMaxRetry?(a=t+(a+1)*r.nudgeOffset,e=new Error(`Nudging 'currentTime' from ${t} to `+a),V.warn(e.message),n.currentTime=a,i.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_NUDGE_ON_STALL,error:e,fatal:!1})):(n=new Error(`Playhead still not moving while enough data buffered @${t} after ${r.nudgeMaxRetry} nudges`),V.error(n.message),i.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,error:n,fatal:!0})))}}class Ki extends jr{constructor(t,e,r){super(t,e,r,"[stream-controller]",A),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on($.ERROR,this.onError,this),t.on($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this),t.on($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off($.ERROR,this.onError,this),t.off($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off($.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this),t.off($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off($.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(t){if(this.levels){var{lastCurrentTime:e,hls:r}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=r.startLevel;-1===t&&(r.config.testBandwidth&&1<this.levels.length?(t=0,this.bitrateTest=!0):t=r.nextAutoLevel),this.level=r.nextLoadLevel=t,this.loadedmetadata=!1}0<e&&-1===t&&(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=L.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=L.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case L.WAITING_LEVEL:var{levels:t,level:e}=this,e=null==t||null==(t=t[e])?void 0:t.details;if(!e||e.live&&this.levelLastLoaded!==this.level)this.hls.nextLoadLevel!==this.level&&(this.state=L.IDLE);else{if(this.waitForCdnTuneIn(e))break;this.state=L.IDLE}break;case L.FRAG_LOADING_WAITING_RETRY:t=self.performance.now(),e=this.retryDate;(!e||e<=t||null!=(e=this.media)&&e.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=L.IDLE)}this.state===L.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){var{hls:e,levelLastLoaded:r,levels:i,media:n}=this,{config:a,nextLoadLevel:s}=e;if(null!==r&&(n||!this.startFragRequested&&a.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&null!=i&&i[s]){r=i[s],n=this.getMainFwdBufferInfo();if(null!==n){a=this.getLevelDetails();if(a&&this._streamEnded(n,a))i={},this.altAudio&&(i.type="video"),this.hls.trigger($.BUFFER_EOS,i),this.state=L.ENDED;else{e.loadLevel!==s&&-1===e.manualLevel&&this.log(`Adapting to level ${s} from level `+this.level),this.level=e.nextLoadLevel=s;a=r.details;if(!a||this.state===L.WAITING_LEVEL||a.live&&this.levelLastLoaded!==s)this.level=s,this.state=L.WAITING_LEVEL;else{i=n.len,e=this.getMaxBufferLength(r.maxBitrate);if(!(e<=i)){this.backtrackFragment&&this.backtrackFragment.start>n.end&&(this.backtrackFragment=null);var o,s=this.backtrackFragment?this.backtrackFragment.start:n.end;let t=this.getNextFragment(s,a);this.couldBacktrack&&!this.fragPrevious&&t&&"initSegment"!==t.sn&&this.fragmentTracker.getState(t)!==mr?(i=(null!=(i=this.backtrackFragment)?i:t).sn-a.startSN,(i=a.fragments[i-1])&&t.cc===i.cc&&(t=i,this.fragmentTracker.removeFragment(i))):this.backtrackFragment&&n.len&&(this.backtrackFragment=null),t&&this.isLoopLoading(t,s)&&(t.gap||(o=((i=this.audioOnly&&!this.altAudio?y:k)===k?this.videoBuffer:this.mediaBuffer)||this.media)&&this.afterBufferFlushed(o,i,A),t=this.getNextFragmentLoopLoading(t,a,n,A,e)),t&&(!t.initSegment||t.initSegment.data||this.bitrateTest||(t=t.initSegment),this.loadFragment(t,r,s))}}}}}}loadFragment(t,e,r){var i=this.fragmentTracker.getState(t);this.fragCurrent=t,i===pr||i===vr?"initSegment"===t.sn?this._loadInitSegment(t,e):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):(this.startFragRequested=!0,super.loadFragment(t,e,r)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,A)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){var{levels:e,media:r}=this;if(null!=r&&r.readyState){let t;var i=this.getAppendedFrag(r.currentTime),i=(i&&1<i.start&&this.flushMainBuffer(0,i.start-1),this.getLevelDetails());if(null!=i&&i.live){var n=this.getMainFwdBufferInfo();if(!n||n.len<2*i.targetduration)return}t=!r.paused&&e&&(n=e[this.hls.nextLoadLevel],i=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*n.maxBitrate/(1e3*i)+1:0;e=this.getBufferedFrag(r.currentTime+t);e&&(n=this.followingBufferedFrag(e))&&(this.abortCurrentFrag(),i=n.maxStartPTS||n.start,r=n.duration,n=Math.max(e.end,i+Math.min(Math.max(r-this.config.maxFragLookUpTolerance,.5*r),.75*r)),this.flushMainBuffer(n,Number.POSITIVE_INFINITY))}}abortCurrentFrag(){var t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case L.KEY_LOADING:case L.FRAG_LOADING:case L.FRAG_LOADING_WAITING_RETRY:case L.PARSING:case L.PARSED:this.state=L.IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);t=e.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),t.addEventListener("playing",this.onvplaying),t.addEventListener("seeked",this.onvseeked),this.gapController=new $i(this.config,t,this.fragmentTracker,this.hls)}onMediaDetaching(){var t=this["media"];t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){var t=this.media,t=t?t.currentTime:null,t=(N(t)&&this.log("Media seeked to "+t.toFixed(3)),this.getMainFwdBufferInfo());null===t||0===t.len?this.warn(`Main forward buffer length on "seeked" event ${t?t.len:"empty"})`):this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger($.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(t,e){let r=!1,i=!1,n;var a;e.levels.forEach(t=>{(n=t.audioCodec)&&(-1!==n.indexOf("mp4a.40.2")&&(r=!0),-1!==n.indexOf("mp4a.40.5"))&&(i=!0)}),this.audioCodecSwitch=r&&i&&!("function"==typeof(null==(a=Gr())||null==(a=a.prototype)?void 0:a.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){var r=this["levels"];r&&this.state===L.IDLE&&(!(r=r[e.level]).details||r.details.live&&this.levelLastLoaded!==e.level||this.waitForCdnTuneIn(r.details))&&(this.state=L.WAITING_LEVEL)}onLevelLoaded(t,e){var r=this["levels"],i=e.level,n=e.details,a=n.totalduration;if(r){this.log(`Level ${i} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""}, cc [${n.startCC}, ${n.endCC}] duration:`+a);a=r[i],r=this.fragCurrent;!r||this.state!==L.FRAG_LOADING&&this.state!==L.FRAG_LOADING_WAITING_RETRY||r.level===e.level&&r.urlId===a.urlId||!r.loader||this.abortCurrentFrag();let t=0;if(n.live||null!=(e=a.details)&&e.live){if(n.fragments[0]||(n.deltaUpdateFailed=!0),n.deltaUpdateFailed)return;t=this.alignPlaylists(n,a.details)}if(a.details=n,this.levelLastLoaded=i,this.hls.trigger($.LEVEL_UPDATED,{details:n,level:i}),this.state===L.WAITING_LEVEL){if(this.waitForCdnTuneIn(n))return;this.state=L.IDLE}this.startFragRequested?n.live&&this.synchronizeToLiveEdge(n):this.setStartPosition(n,t),this.tick()}else this.warn("Levels were reset while loading level "+i)}_handleFragmentLoadProgress(t){var e,r,i,n,a,s,o,{frag:t,part:l,payload:u}=t,h=this["levels"];h?(e=(h=h[t.level]).details)?(r=h.videoCodec,i=e.PTSKnown||!e.live,n=null==(n=t.initSegment)?void 0:n.data,h=this._getAudioCodec(h),a=this.transmuxer=this.transmuxer||new Gi(this.hls,A,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),o=-1!==(s=l?l.index:-1),s=new wr(t.level,t.sn,t.stats.chunkCount,u.byteLength,s,o),o=this.initPTS[t.cc],a.push(u,n,h,r,t,l,e.totalduration,i,s,o)):(this.warn(`Dropping fragment ${t.sn} of level ${t.level} after level details were reset`),this.fragmentTracker.removeFragment(t)):this.warn(`Levels were reset while fragment load was in progress. Fragment ${t.sn} of level ${t.level} will not be buffered`)}onAudioTrackSwitching(t,e){var r,i=this.altAudio;!e.url&&(this.mediaBuffer!==this.media?(this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,(r=this.fragCurrent)&&(this.log("Switching to main audio track, cancel main fragment load"),r.abortRequests(),this.fragmentTracker.removeFragment(r)),this.resetTransmuxer(),this.resetLoadingState()):this.audioOnly&&this.resetTransmuxer(),r=this.hls,i&&(r.trigger($.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),r.trigger($.AUDIO_TRACK_SWITCHED,e))}onAudioTrackSwitched(t,e){var r,e=e.id,e=!!this.hls.audioTracks[e].url;e&&(r=this.videoBuffer)&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r),this.altAudio=e,this.tick()}onBufferCreated(t,e){var r=e.tracks;let i,n,a=!1;for(const o in r){var s=r[o];"main"===s.id?(n=o,i=s,"video"===o&&(s=r[o])&&(this.videoBuffer=s.buffer)):a=!0}a&&i?(this.log(`Alternate track found, use ${n}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){var r,{frag:e,part:i}=e;e&&e.type!==A||(this.fragContextChanged(e)?(this.warn(`Fragment ${e.sn}${i?" p: "+i.index:""} of level ${e.level} finished buffering, but was aborted. state: `+this.state),this.state===L.PARSED&&(this.state=L.IDLE)):(r=(i||e).stats,this.fragLastKbps=Math.round(8*r.total/(r.buffering.end-r.loading.first)),"initSegment"!==e.sn&&(this.fragPrevious=e),this.fragBufferedComplete(e,i)))}onError(t,e){var r;if(e.fatal)this.state=L.ERROR;else switch(e.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(A,e);break;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==L.WAITING_LEVEL||(null==(r=e.context)?void 0:r.type)!==ye||(this.state=L.IDLE);break;case H.BUFFER_FULL_ERROR:e.parent&&"main"===e.parent&&this.reduceLengthAndFlushBuffer(e)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}checkBuffer(){var t,{media:e,gapController:r}=this;e&&r&&e.readyState&&(!this.loadedmetadata&&S.getBuffered(e).length||(t=this.state!==L.IDLE?this.fragCurrent:null,r.poll(this.lastCurrentTime,t)),this.lastCurrentTime=e.currentTime)}onFragLoadEmergencyAborted(){this.state=L.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:e}){var r;(e!==y||this.audioOnly&&!this.altAudio)&&(r=(e===k?this.videoBuffer:this.mediaBuffer)||this.media,this.afterBufferFlushed(r,e,A))}onLevelsUpdated(t,e){this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){var e=this["media"];if(e){var r,i=e.currentTime;let t=this.startPosition;0<=t&&i<t&&(e.seeking?this.log(`could not seek to ${t}, already seeking at `+i):(0<(r=((r=S.getBuffered(e)).length?r.start(0):0)-t)&&(r<this.config.maxBufferHole||r<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${r} to match buffer start`),t+=r,this.startPosition=t),this.log(`seek to target start position ${t} from current time `+i),e.currentTime=t))}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(i,n){i.bitrateTest=!0,this._doFragLoad(i,n).then(t=>{var e,r=this["hls"];t&&!this.fragContextChanged(i)&&(n.fragmentError=0,this.state=L.IDLE,this.startFragRequested=!1,this.bitrateTest=!1,(e=i.stats).parsing.start=e.parsing.end=e.buffering.start=e.buffering.end=self.performance.now(),r.trigger($.FRAG_LOADED,t),i.bitrateTest=!1)})}_handleTransmuxComplete(t){var e="main",r=this["hls"],{remuxResult:t,chunkMeta:i}=t,n=this.getCurrentContext(i);if(n){var{frag:n,part:a,level:s}=n,{video:o,text:l,id3:u,initSegment:h}=t,c=s["details"],d=this.altAudio?void 0:t.audio;if(this.fragContextChanged(n))this.fragmentTracker.removeFragment(n);else{if(this.state=L.PARSING,h&&(null!=h&&h.tracks&&(f=n.initSegment||n,this._bufferInitSegment(s,h.tracks,f,i),r.trigger($.FRAG_PARSING_INIT_SEGMENT,{frag:f,id:e,tracks:h.tracks})),s=h.initPTS,f=h.timescale,N(s))&&(this.initPTS[n.cc]={baseTime:s,timescale:f},r.trigger($.INIT_PTS_FOUND,{frag:n,id:e,initPTS:s,timescale:f})),o&&c&&"initSegment"!==n.sn){var h=c.fragments[n.sn-1-c.startSN],s=n.sn===c.startSN,f=!h||n.cc>h.cc;if(!1!==t.independent){var{startPTS:h,endPTS:t,startDTS:p,endDTS:g}=o;if(a)a.elementaryStreams[o.type]={startPTS:h,endPTS:t,startDTS:p,endDTS:g};else if(o.firstKeyFrame&&o.independent&&1===i.id&&!f&&(this.couldBacktrack=!0),o.dropped&&o.independent){var v=this.getMainFwdBufferInfo(),v=(v?v.end:this.getLoadPosition())+this.config.maxBufferHole,m=o.firstKeyFramePTS||h;if(!s&&v<m-this.config.maxBufferHole&&!f)return void this.backtrack(n);f&&(n.gap=!0),n.setElementaryStreamInfo(o.type,n.start,t,n.start,g,!0)}n.setElementaryStreamInfo(o.type,h,t,p,g),this.backtrackFragment&&(this.backtrackFragment=n),this.bufferFragmentData(o,n,a,i,s||f)}else{if(!s&&!f)return void this.backtrack(n);n.gap=!0}}d&&({startPTS:v,endPTS:m,startDTS:h,endDTS:t}=d,a&&(a.elementaryStreams[y]={startPTS:v,endPTS:m,startDTS:h,endDTS:t}),n.setElementaryStreamInfo(y,v,m,h,t),this.bufferFragmentData(d,n,a,i)),c&&null!=u&&null!=(p=u.samples)&&p.length&&(g={id:e,frag:n,details:c,samples:u.samples},r.trigger($.FRAG_PARSING_METADATA,g)),c&&l&&(o={id:e,frag:n,details:c,samples:l.samples},r.trigger($.FRAG_PARSING_USERDATA,o))}}else this.resetWhenMissingContext(i)}_bufferInitSegment(e,r,i,n){if(this.state===L.PARSING){this.audioOnly=!!r.audio&&!r.video,this.altAudio&&!this.audioOnly&&delete r.audio;var{audio:a,video:t,audiovideo:s}=r;if(a){let t=e.audioCodec;var o=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t=t&&(-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==a.metadata.channelCount)&&-1===o.indexOf("firefox")&&(t="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==a.container&&(t="mp4a.40.2",this.log("Android: force audio codec to "+t)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),a.levelCodec=t,a.id="main",this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${a.codec}]`)}t&&(t.levelCodec=e.videoCodec,t.id="main",this.log(`Init video buffer, container:${t.container}, codecs[level/parsed]=[${e.videoCodec||""}/${t.codec}]`)),s&&this.log(`Init audiovideo buffer, container:${s.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${s.codec}]`),this.hls.trigger($.BUFFER_CODECS,r),Object.keys(r).forEach(t=>{var e=r[t].initSegment;null!=e&&e.byteLength&&this.hls.trigger($.BUFFER_APPENDING,{type:t,data:e,frag:i,part:null,chunkMeta:n,parent:i.type})}),this.tick()}}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer||this.media,A)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=L.IDLE}checkFragmentChanged(){var t,e=this.media;let r=null;e&&1<e.readyState&&!1===e.seeking&&(t=e.currentTime,S.isBuffered(e,t)?r=this.getAppendedFrag(t):S.isBuffered(e,t+.1)&&(r=this.getAppendedFrag(t+.1)),r)&&(this.backtrackFragment=null,e=this.fragPlaying,t=r.level,e&&r.sn===e.sn&&e.level===t&&r.urlId===e.urlId||(this.fragPlaying=r,this.hls.trigger($.FRAG_CHANGED,{frag:r}),e&&e.level===t)||this.hls.trigger($.LEVEL_SWITCHED,{level:t}))}get nextLevel(){var t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){var t=this.media;if(t){var t=t.currentTime,e=this.currentFrag;if(e&&N(t)&&N(e.programDateTime))return t=e.programDateTime+1e3*(t-e.start),new Date(t)}return null}get currentLevel(){var t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){var t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class Hi{constructor(t,e=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=r}sample(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Vi{constructor(t,e,r,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Hi(t),this.fast_=new Hi(e),this.defaultTTFB_=i,this.ttfb_=new Hi(t)}update(t,e){var{slow_:r,fast_:i,ttfb_:n}=this;r.halfLife!==t&&(this.slow_=new Hi(t,r.getEstimate(),r.getTotalWeight())),i.halfLife!==e&&(this.fast_=new Hi(e,i.getEstimate(),i.getTotalWeight())),n.halfLife!==t&&(this.ttfb_=new Hi(t,n.getEstimate(),n.getTotalWeight()))}sample(t,e){t=(t=Math.max(t,this.minDelayMs_))/1e3,e=8*e/t;this.fast_.sample(t,e),this.slow_.sample(t,e)}sampleTTFB(t){var e=t/1e3,e=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(e,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class Wi{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){var{chunks:t,dataLength:e}=this;let r;return t.length?(r=1===t.length?t[0]:function(e,t){var r=new Uint8Array(t);let i=0;for(let t=0;t<e.length;t++){var n=e[t];r.set(n,i),i+=n.length}return r}(t,e),this.reset(),r):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function Yi(e,r){if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(!function(e,r){var t=e["STABLE-RENDITION-ID"];if(t)return t===r["STABLE-RENDITION-ID"];return!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(t=>e[t]!==r[t])}(e[t].attrs,r[t].attrs))return!1;return!0}class qi{constructor(i){this.buffered=void 0;const e=(t,e,r)=>{if(r-1<(e>>>=0))throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${e}) is greater than the maximum bound (${r})`);return i[e][t]};this.buffered={get length(){return i.length},end(t){return e("end",t,i.length)},start(t){return e("start",t,i.length)}}}}function zi(e){var r=[];for(let t=0;t<e.length;t++){var i=e[t];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||r.push(e[t])}return r}class Qi{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,e){var r=this.queues[e];r.push(t),1===r.length&&this.buffers[e]&&this.executeNext(e)}insertAbort(t,e){this.queues[e].unshift(t),this.executeNext(e)}appendBlocker(t){let e;var r=new Promise(t=>{e=t}),i={execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,t),r}executeNext(e){var{buffers:r,queues:i}=this,r=r[e],i=i[e];if(i.length){var n=i[0];try{n.execute()}catch(t){V.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),n.onError(t),null!=r&&r.updating||(i.shift(),this.executeNext(e))}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const Xi=re(),Ji=/([ha]vc.)(?:\.[^.,]+)+/;function Zi(t){let e=t;return tn.hasOwnProperty(t)&&(e=tn[t]),String.fromCharCode(e)}const tn={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},en=100,rn={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},nn={17:2,18:4,21:6,22:8,23:10,19:13,20:15},an={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},sn={25:2,26:4,29:6,30:8,31:10,27:13,28:15},on=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class ln{constructor(){this.time=null,this.verboseLevel=0}log(t,e){this.verboseLevel>=t&&(e="function"==typeof e?e():e,V.log(this.time+` [${t}] `+e))}}function un(e){var r=[];for(let t=0;t<e.length;t++)r.push(e[t].toString(16));return r}class hn{constructor(t,e,r,i,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=i||"black",this.flash=n||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){var r=["foreground","underline","italics","background","flash"];for(let t=0;t<r.length;t++){var i=r[t];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class cn{constructor(t,e,r,i,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new hn(e,r,i,n,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class dn{constructor(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<en;t++)this.chars.push(new cn);this.logger=t,this.pos=0,this.currPenState=new hn}equals(e){let r=!0;for(let t=0;t<en;t++)if(!this.chars[t].equals(e.chars[t])){r=!1;break}return r}copy(e){for(let t=0;t<en;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<en;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>en&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=en)}moveCursor(t){var e=this.pos+t;if(1<t)for(let t=this.pos+1;t<e+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){144<=t&&this.backSpace();const e=Zi(t);this.pos>=en?this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<en;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){var e=[];let r=!0;for(let t=0;t<en;t++){var i=this.chars[t].uchar;" "!==i&&(r=!1),e.push(i)}return r?"":e.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class fn{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<15;t++)this.rows.push(new dn(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let t=0;t<15;t++)this.rows[t].clear();this.currRow=14}equals(e){let r=!0;for(let t=0;t<15;t++)if(!this.rows[t].equals(e.rows[t])){r=!1;break}return r}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+JSON.stringify(t));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let t=0;t<15;t++)this.rows[t].clear();var r=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var n=i.rows[r].cueStartTime,a=this.logger.time;if(n&&null!==a&&n<a)for(let t=0;t<this.nrRollUpRows;t++)this.rows[e-this.nrRollUpRows+t+1].copy(i.rows[r+t])}}this.currRow=e;n=this.rows[this.currRow],null!==t.indent&&(a=t.indent,a=Math.max(a-1,0),n.setCursor(t.indent),t.color=n.chars[a].penState.foreground),n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){var t;null===this.nrRollUpRows?this.logger.log(3,"roll_up but nrRollUpRows not set yet"):(this.logger.log(1,()=>this.getDisplayText()),t=this.currRow+1-this.nrRollUpRows,(t=this.rows.splice(t,1)[0]).clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up"))}getDisplayText(e){e=e||!1;var r=[];let t="";var i;for(let t=0;t<15;t++){var n=this.rows[t].getTextString();n&&(i=t+1,r.push(e?"Row "+i+": '"+n+"'":n.trim()))}return t=0<r.length?e?"["+r.join(" | ")+"]":r.join("\n"):t}getTextAndFormat(){return this.rows}}class pn{constructor(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new fn(r),this.nonDisplayedMemory=new fn(r),this.lastOutputScreen=new fn(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory)&&this.outputDataUpdate()}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){var t;this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode&&(t=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())),this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){var e={flash:!1};e.underline=t%2==1,e.italics=46<=t,e.italics?e.foreground="white":(t=Math.floor(t/2)-16,e.foreground=["white","green","blue","cyan","red","yellow","magenta"][t]),this.logger.log(2,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){var e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){!this.outputFilter||this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t)}}class gn{constructor(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var i=new ln;this.channels=[null,new pn(t,e,i),new pn(t+1,r,i)],this.cmdHistory=yn(),this.logger=i}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){let r;let i=!1;this.logger.time=t;for(let t=0;t<e.length;t+=2){var n,a=127&e[t],s=127&e[t+1];0==a&&0==s||(this.logger.log(3,"["+un([e[t],e[t+1]])+"] -> ("+un([a,s])+")"),(r=(r=(r=(r=this.parseCmd(a,s))||this.parseMidrow(a,s))||this.parsePAC(a,s))||this.parseBackgroundAttributes(a,s))||(i=this.parseChars(a,s))&&((n=this.currentChannel)&&0<n?this.channels[n].insertChars(i):this.logger.log(2,"No channel found yet. TEXT-MODE?")),r)||i||this.logger.log(2,"Couldn't parse cleaned data "+un([a,s])+" orig: "+un([e[t],e[t+1]]))}}parseCmd(t,e){var r,i,n=this["cmdHistory"];return((20===t||28===t||21===t||29===t)&&32<=e&&e<=47||(23===t||31===t)&&33<=e&&e<=35)&&(mn(t,e,n)?(vn(null,null,n),this.logger.log(3,"Repeated command ("+un([t,e])+") is dropped")):(i=this.channels[r=20===t||21===t||23===t?1:2],20===t||21===t||28===t||29===t?32===e?i.ccRCL():33===e?i.ccBS():34===e?i.ccAOF():35===e?i.ccAON():36===e?i.ccDER():37===e?i.ccRU(2):38===e?i.ccRU(3):39===e?i.ccRU(4):40===e?i.ccFON():41===e?i.ccRDC():42===e?i.ccTR():43===e?i.ccRTD():44===e?i.ccEDM():45===e?i.ccCR():46===e?i.ccENM():47===e&&i.ccEOC():i.ccTO(e-32),vn(t,e,n),this.currentChannel=r),!0)}parseMidrow(t,e){let r=0;var i;return(17===t||25===t)&&32<=e&&e<=47&&((r=17===t?1:2)!==this.currentChannel?(this.logger.log(0,"Mismatch channel in midrow parsing"),!1):!!(i=this.channels[r])&&(i.ccMIDROW(e),this.logger.log(3,"MIDROW ("+un([t,e])+")"),!0))}parsePAC(t,e){let r;var i=this.cmdHistory;if(!((17<=t&&t<=23||25<=t&&t<=31)&&64<=e&&e<=127)&&!((16===t||24===t)&&64<=e&&e<=95))return!1;if(mn(t,e,i))vn(null,null,i);else{var n=t<=23?1:2,a=(r=(64<=e&&e<=95?1==n?rn:an:1==n?nn:sn)[t],this.channels[n]);if(!a)return!1;a.setPAC(this.interpretPAC(r,e)),vn(t,e,i),this.currentChannel=n}return!0}interpretPAC(t,e){let r;t={color:null,italics:!1,indent:null,underline:!1,row:t};return r=95<e?e-96:e-64,t.underline=1==(1&r),r<=13?t.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(t.italics=!0,t.color="white"):t.indent=4*Math.floor((r-16)/2),t}parseChars(t,e){let r,i=null,n=null;if(17<=(n=25<=t?(r=2,t-8):(r=1,t))&&n<=19){let t;t=17===n?e+80:18===n?e+112:e+144,this.logger.log(2,"Special char '"+Zi(t)+"' in channel "+r),i=[t]}else 32<=t&&t<=127&&(i=0===e?[t]:[t,e]);var a;return i&&(a=un(i),this.logger.log(3,"Char codes =  "+a.join(",")),vn(t,e,this.cmdHistory)),i}parseBackgroundAttributes(t,e){var r,i;return((16===t||24===t)&&32<=e&&e<=47||(23===t||31===t)&&45<=e&&e<=47)&&(i={},16===t||24===t?(r=Math.floor((e-32)/2),i.background=on[r],e%2==1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0)),this.channels[t<=23?1:2].setBkgData(i),vn(t,e,this.cmdHistory),!0)}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){var e=this.channels[t];e&&e.reset()}this.cmdHistory=yn()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function vn(t,e,r){r.a=t,r.b=e}function mn(t,e,r){return r.a===t&&r.b===e}function yn(){return{a:null,b:null}}class En{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Tn=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;const E=["","lr","rl"],e=["start","middle","end","left","right"];function T(t,e){return"string"==typeof e&&!!Array.isArray(t)&&(e=e.toLowerCase(),!!~t.indexOf(e))&&e}function b(t){return T(e,t)}function A(t){let e=1;for(;e<arguments.length;e++){var r=arguments[e];for(const i in r)t[i]=r[i]}return t}function t(t,e,r){var i=this,n={enumerable:!0};i.hasBeenReset=!1;let a="",s=!1,o=t,l=e,u=r,h=null,c="",d=!0,f="auto",p="start",g=50,v="middle",m=50,y="middle";Object.defineProperty(i,"id",A({},n,{get:function(){return a},set:function(t){a=""+t}})),Object.defineProperty(i,"pauseOnExit",A({},n,{get:function(){return s},set:function(t){s=!!t}})),Object.defineProperty(i,"startTime",A({},n,{get:function(){return o},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");o=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"endTime",A({},n,{get:function(){return l},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");l=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"text",A({},n,{get:function(){return u},set:function(t){u=""+t,this.hasBeenReset=!0}})),Object.defineProperty(i,"region",A({},n,{get:function(){return h},set:function(t){h=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"vertical",A({},n,{get:function(){return c},set:function(t){t=t;t=T(E,t);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");c=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"snapToLines",A({},n,{get:function(){return d},set:function(t){d=!!t,this.hasBeenReset=!0}})),Object.defineProperty(i,"line",A({},n,{get:function(){return f},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"lineAlign",A({},n,{get:function(){return p},set:function(t){t=b(t);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"position",A({},n,{get:function(){return g},set:function(t){if(t<0||100<t)throw new Error("Position must be between 0 and 100.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"positionAlign",A({},n,{get:function(){return v},set:function(t){t=b(t);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"size",A({},n,{get:function(){return m},set:function(t){if(t<0||100<t)throw new Error("Size must be between 0 and 100.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"align",A({},n,{get:function(){return y},set:function(t){t=b(t);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),i.displayState=void 0}return t.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},t}();class bn{decode(t,e){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function An(t){function e(t,e,r,i){return 3600*(0|t)+60*(0|e)+(0|r)+parseFloat(i||0)}t=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?59<parseFloat(t[2])?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class _n{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(e,r,i){for(let t=0;t<i.length;++t)if(r===i[t]){this.set(e,r);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){e=parseFloat(e);if(0<=e&&e<=100)return this.set(t,e),!0}return!1}}function Sn(t,e,r,i){var n,a=i?t.split(i):[t];for(const s in a)"string"==typeof a[s]&&2===(n=a[s].split(r)).length&&e(n[0],n[1])}const Ln=new Tn(0,0,""),kn="middle"===Ln.align?"middle":"center";function Rn(t){return t.replace(/<br(?: \/)?>/gi,"\n")}class wn{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new bn,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const i=this;function r(){var t=i.buffer;let e=0;for(t=Rn(t);e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var r=t.slice(0,e);return"\r"===t[e]&&++e,"\n"===t[e]&&++e,i.buffer=t.slice(e),r}t&&(i.buffer+=i.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var n=(t=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(null==n||!n[0])throw new Error("Malformed WebVTT signature.");i.state="HEADER"}let e=!1;for(;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(e?e=!1:t=r(),i.state){case"HEADER":/:/.test(t)?Sn(t,function(t,e){},/:/):t||(i.state="ID");continue;case"NOTE":t||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){i.state="NOTE";break}if(!t)continue;if(i.cue=new Tn(0,0,""),i.state="CUE",-1===t.indexOf("--\x3e")){i.cue.id=t;continue}case"CUE":if(!i.cue){i.state="BADCUE";continue}try{!function(r,i,n){const e=r;function t(){var t=An(r);if(null===t)throw new Error("Malformed timestamp: "+e);return r=r.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){r=r.replace(/^\s+/,"")}if(a(),i.startTime=t(),a(),"--\x3e"!==r.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+e);r=r.slice(3),a(),i.endTime=t(),a();{var s=r;const o=new _n;Sn(s,function(e,r){let t;switch(e){case"region":for(let t=n.length-1;0<=t;t--)if(n[t].id===r){o.set(e,n[t].region);break}break;case"vertical":o.alt(e,r,["rl","lr"]);break;case"line":t=r.split(","),o.integer(e,t[0]),o.percent(e,t[0])&&o.set("snapToLines",!1),o.alt(e,t[0],["auto"]),2===t.length&&o.alt("lineAlign",t[1],["start",kn,"end"]);break;case"position":t=r.split(","),o.percent(e,t[0]),2===t.length&&o.alt("positionAlign",t[1],["start",kn,"end","line-left","line-right","auto"]);break;case"size":o.percent(e,r);break;case"align":o.alt(e,r,["start",kn,"end","left","right"])}},/:/,/\s/),i.region=o.get("region",null),i.vertical=o.get("vertical","");let t=o.get("line","auto"),e=("auto"===t&&-1===Ln.line&&(t=-1),i.line=t,i.lineAlign=o.get("lineAlign","start"),i.snapToLines=o.get("snapToLines",!0),i.size=o.get("size",100),i.align=o.get("align",kn),o.get("position","auto"));"auto"===e&&50===Ln.position&&(e="start"===i.align||"left"===i.align?0:"end"===i.align||"right"===i.align?100:50),i.position=e}}(t,i.cue,i.regionList)}catch(t){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var a=-1!==t.indexOf("--\x3e");if(!t||a&&(e=!0)){i.oncue&&i.cue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}if(null===i.cue)continue;i.cue.text&&(i.cue.text+="\n"),i.cue.text+=t;continue;case"BADCUE":t||(i.state="ID")}}}catch(t){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this}flush(){var e=this;try{if(!e.cue&&"HEADER"!==e.state||(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}function In(t,e,r=0){return t.slice(r,r+e.length)===e}const Dn=/\r\n|\n\r|\n|\r/g,Cn=function(t){let e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()};function Pn(t,e,r){return Cn(t.toString())+Cn(e.toString())+Cn(r)}function xn(t,o,l,u,h,e,r){const i=new wn;var n,a,t=T(new Uint8Array(t)).trim().replace(Dn,"\n").split("\n");const c=[],d=o?([n,a=1]=[o.baseTime,o.timescale],mi(n,vi,1/a)):0;let s="00:00.000",f=0,p=0,g,v=!0;i.oncue=function(t){var r=l[u];let e=l.ccOffset;var i,n=(f-d)/9e4;if(null!=r&&r.new)if(void 0!==p)e=l.ccOffset=r.start;else{var a=l;r=u;var s=n;let t=a[r],e=a[t.prevCC];if(!e||!e.new&&t.new)a.ccOffset=a.presentationOffset=t.start,t.new=!1;else{for(;null!=(i=e)&&i.new;)a.ccOffset+=t.start-e.start,t.new=!1,e=a[(t=e).prevCC];a.presentationOffset=s}}if(n){if(!o)return void(g=new Error("Missing initPTS for VTT MPEGTS"));e=n-l.presentationOffset}r=t.endTime-t.startTime,s=Y(9e4*(t.startTime+e-p),9e4*h)/9e4,t.startTime=Math.max(s,0),t.endTime=Math.max(s+r,0),n=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(n)),t.id||(t.id=Pn(t.startTime,t.endTime,n)),0<t.endTime&&c.push(t)},i.onparsingerror=function(t){g=t},i.onflush=function(){g?r(g):e(c)},t.forEach(t=>{if(v){if(In(t,"X-TIMESTAMP-MAP=")){v=!1,t.slice(16).split(",").forEach(t=>{In(t,"LOCAL:")?s=t.slice(6):In(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))});try{p=function(t){var e=parseInt(t.slice(-3)),r=parseInt(t.slice(-6,-4)),i=parseInt(t.slice(-9,-7)),n=9<t.length?parseInt(t.substring(0,t.indexOf(":"))):0;if(N(e)&&N(r)&&N(i)&&N(n))return(e+=1e3*r)+6e4*i+36e5*n;throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t)}(s)/1e3}catch(t){g=t}return}""===t&&(v=!1)}i.parse(t+"\n")}),i.flush()}const On="stpp.ttml.im1t",Mn=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Fn=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Nn={left:"start",center:"center",right:"end",start:"start",end:"end"};function Bn(t,e,r,i){t=w(new Uint8Array(t),["mdat"]);if(0===t.length)i(new Error("Could not parse IMSC1 mdat"));else{var n,a,s,t=t.map(t=>T(t));[e,n,a=1,s=!1]=[e.baseTime,1,e.timescale];const o=mi(e,n,1/a,s);try{t.forEach(t=>r(function(t,a){const e=new DOMParser,r=e.parseFromString(t,"text/xml"),i=r.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(n).reduce((t,e)=>(t[e]=i.getAttribute("ttp:"+e)||n[e],t),{}),o="preserve"!==i.getAttribute("xml:space"),l=jn(Un(i,"styling","style")),u=jn(Un(i,"layout","region")),h=Un(i,"body","[begin]");return[].map.call(h,t=>{var e=function i(t,n){return[].slice.call(t.childNodes).reduce((t,e,r)=>{return"br"===e.nodeName&&r?t+"\n":null!=(r=e.childNodes)&&r.length?i(e,n):n?t+e.textContent.trim().replace(/\s+/g," "):t+e.textContent},"")}(t,o);if(!e||!t.hasAttribute("begin"))return null;var r=Kn(t.getAttribute("begin"),s),i=Kn(t.getAttribute("dur"),s);let n=Kn(t.getAttribute("end"),s);if(null===r)throw $n(t);if(null===n){if(null===i)throw $n(t);n=r+i}i=new Tn(r-a,n-a,e),i.id=Pn(i.startTime,i.endTime,i.text),r=u[t.getAttribute("region")],e=function(i,n,t){const a="http://www.w3.org/ns/ttml#styling";let s=null;var e=null!=i&&i.hasAttribute("style")?i.getAttribute("style"):null;e&&t.hasOwnProperty(e)&&(s=t[e]);return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((t,e)=>{var r=Gn(n,a,e)||Gn(i,a,e)||Gn(s,a,e);return r&&(t[e]=r),t},{})}(r,l[t.getAttribute("style")],l),r=e.textAlign;return r&&((t=Nn[r])&&(i.lineAlign=t),i.align=r),G(i,e),i}).filter(t=>null!==t)}(t,o)))}catch(t){i(t)}}}function Un(t,e,r){t=t.getElementsByTagName(e)[0];return t?[].slice.call(t.querySelectorAll(r)):[]}function jn(t){return t.reduce((t,e)=>{var r=e.getAttribute("xml:id");return r&&(t[r]=e),t},{})}function Gn(t,e,r){return t&&t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function $n(t){return new Error("Could not parse ttml timestamp "+t)}function Kn(t,e){if(!t)return null;let r=An(t);var i,n,a;return null===r&&(Mn.test(t)?r=(i=t,n=e,i=Mn.exec(i),a=(0|i[4])+(0|i[5])/n.subFrameRate,3600*(0|i[1])+60*(0|i[2])+(0|i[3])+a/n.frameRate):Fn.test(t)&&(r=function(t,e){var t=Fn.exec(t),r=Number(t[1]),t=t[2];switch(t){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}(t,e))),r}function Hn(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Vn{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){var t=this["hls"];t.on($.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.BUFFER_CODECS,this.onBufferCodecs,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){var t=this["hls"];t.off($.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.BUFFER_CODECS,this.onBufferCodecs,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){e=this.hls.levels[e.droppedLevel];this.isLevelAllowed(e)&&this.restrictedLevels.push({bitrate:e.bitrate,height:e.height,width:e.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null}onManifestParsed(t,e){var r=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,r.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){var t,e;this.media&&0<this.mediaHeight&&0<this.mediaWidth&&(t=this.hls.levels).length&&((e=this.hls).autoLevelCapping=this.getMaxLevel(t.length-1),e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping)}getMaxLevel(r){var t=this.hls.levels;return t.length?(t=t.filter((t,e)=>this.isLevelAllowed(t)&&e<=r),this.clientRect=null,Vn.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)):-1}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){var t,e,r;return this.clientRect||(e={width:0,height:0},(t=this.media)&&(r=t.getBoundingClientRect(),e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)),this.clientRect=e)}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(t){}return t}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,r,i){if(null==e||!e.length)return-1;var n;let a=e.length-1;for(let t=0;t<e.length;t+=1){var s=e[t];if((s.width>=r||s.height>=i)&&(s=s,!(n=e[t+1])||s.width!==n.width||s.height!==n.height)){a=t;break}}return a}}const Wn="[eme]";class Yn{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Yn.CDMCleanupPromise?[Yn.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=V.debug.bind(V,Wn),this.log=V.log.bind(V,Wn),this.warn=V.warn.bind(V,Wn),this.error=V.error.bind(V,Wn),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();var t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off($.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){var{drmSystems:e,widevineLicenseUrl:r}=this.config,e=e[t];if(e)return e.licenseUrl;if(t===p.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){var e=this.config["drmSystems"],e=e[t];if(e)return e.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){var e=this.hls.levels,r=(t,e,r)=>!!t&&r.indexOf(t)===e;const s=e.map(t=>t.audioCodec).filter(r),o=e.map(t=>t.videoCodec).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise((i,n)=>{const a=e=>{const r=e.shift();this.getMediaKeysPromise(r,s,o).then(t=>i({keySystem:r,mediaKeys:t})).catch(t=>{e.length?a(e):t instanceof h?n(t):n(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};a(t)})}requestMediaKeySystemAccess(t,e){var r=this.config["requestMediaKeySystemAccessFunc"];if("function"==typeof r)return r(t,e);{let t="Configured requestMediaKeySystemAccess is not a function "+r;return null===_t&&"http:"===self.location.protocol&&(t="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(t))}}getMediaKeysPromise(i,t,e){t=function(t,e,r,i){let n;switch(t){case p.FAIRPLAY:n=["cenc","sinf"];break;case p.WIDEVINE:case p.PLAYREADY:n=["cenc"];break;case p.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+t)}var a=n,s=i;return[a={initDataTypes:a,persistentState:s.persistentState||"not-allowed",distinctiveIdentifier:s.distinctiveIdentifier||"not-allowed",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:e.map(t=>({contentType:`audio/mp4; codecs="${t}"`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null})),videoCapabilities:r.map(t=>({contentType:`video/mp4; codecs="${t}"`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null}))}]}(i,t,e,this.config.drmSystemOptions);const r=this.keySystemAccessPromises[i];let n=null==r?void 0:r.keySystemAccess;if(n)return n.then(()=>r.mediaKeys);{this.log(`Requesting encrypted media "${i}" key-system access with config: `+JSON.stringify(t)),n=this.requestMediaKeySystemAccess(i,t);const a=this.keySystemAccessPromises[i]={keySystemAccess:n};return n.catch(t=>{this.log(`Failed to obtain access to key-system "${i}": `+t)}),n.then(t=>{this.log(`Access for key-system "${t.keySystem}" obtained`);const r=this.fetchServerCertificate(i);return this.log(`Create media-keys for "${i}"`),a.mediaKeys=t.createMediaKeys().then(e=>(this.log(`Media-keys created for "${i}"`),r.then(t=>t?this.setMediaKeysServerCertificate(e,i,t):e))),a.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${i}"}: `+t)}),a.mediaKeys})}}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:r}){this.log(`Creating key-system session "${e}" keyId: `+g.hexDump(t.keyId||[]));var i=r.createSession(),t={decryptdata:t,keySystem:e,mediaKeys:r,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(t),t}renewKeySession(t){var e,r,i=t.decryptdata;i.pssh?(e=this.createMediaKeySessionContext(t),r=this.getKeyIdString(i),this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(e,"cenc",i.pssh,"expired")):this.warn("Could not renew expired session. Missing pssh initData."),this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return g.hexDump(t.keyId)}updateKeySession(t,e){var r=t.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${g.hexDump((null==(t=t.decryptdata)?void 0:t.keyId)||[])}
      } (data length: ${e&&e.byteLength})`),r.update(e)}selectKeySystemFormat(t){var e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats `+e.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(n){return new Promise((r,i)=>{const e=At(this.config);var t=n.map(Et).filter(t=>!!t&&-1!==e.indexOf(t));return this.getKeySystemSelectionPromise(t).then(({keySystem:t})=>{var e=bt(t);e?r(e):i(new Error(`Unable to find format for key-system "${t}"`))}).catch(i)})}loadKey(t){const i=t.keyInfo.decryptdata;var e=this.getKeyIdString(i);const n=`(keyId: ${e} format: "${i.keyFormat}" method: ${i.method} uri: ${i.uri})`;this.log("Starting session for key "+n);let r=this.keyIdToKeySessionPromise[e];return r||(r=this.keyIdToKeySessionPromise[e]=this.getKeySystemForKeyPromise(i).then(({keySystem:e,mediaKeys:r})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key `+n),this.attemptSetMediaKeys(e,r).then(()=>{this.throwIfDestroyed();var t=this.createMediaKeySessionContext({keySystem:e,mediaKeys:r,decryptdata:i});return this.generateRequestWithPreferredKeySession(t,"cenc",i.pssh,"playlist-key")})))).catch(t=>this.handleError(t)),r}throwIfDestroyed(t=0){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof h?this.hls.trigger($.ERROR,t.data):this.hls.trigger($.ERROR,{type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){var e=this.getKeyIdString(t),e=this.keyIdToKeySessionPromise[e];return e||(t=(e=Et(t.keyFormat))?[e]:At(this.config),this.attemptKeySystemAccess(t))}getKeySystemSelectionPromise(t){if(0===(t=t.length?t:At(this.config)).length)throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(t)}_onMediaEncrypted(e){const{initDataType:a,initData:s}=e;if(this.debug(`"${e.type}" event: init data type: "${a}"`),null!==s){let n,t;if("sinf"===a&&this.config.drmSystems[p.FAIRPLAY]){e=v(new Uint8Array(s));try{var r=ct(JSON.parse(e).sinf),i=Kt(new Uint8Array(r));if(!i)return;n=i.subarray(8,24),t=p.FAIRPLAY}catch(t){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var r={version:0,systemId:"",kids:null,data:null},t=new DataView(e),i=t.getUint32(0);if(e.byteLength!==i&&44<i)return null;if(1886614376!==t.getUint32(4))return null;if(r.version=t.getUint32(8)>>>24,1<r.version)return null;r.systemId=g.hexDump(new Uint8Array(e,12,16));var n=t.getUint32(28);if(0===r.version){if(i-32<n)return null;r.data=new Uint8Array(e,32,n)}else if(1===r.version){r.kids=[];for(let t=0;t<n;t++)r.kids.push(new Uint8Array(e,32+16*t,16))}return r}(s);if(null===e)return;0===e.version&&e.systemId===Tt&&e.data&&(n=e.data.subarray(8,24)),t=function(t){if(t===Tt)return p.WIDEVINE}(e.systemId)}if(t&&n){const c=g.hexDump(n);var{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this;let e=o[c];for(let t=0;t<l.length;t++){const d=l[t];var u=d.decryptdata;if(!u.pssh&&u.keyId){var h=g.hexDump(u.keyId);if(c===h||-1!==u.uri.replace(/-/g,"").indexOf(c)){e=o[h],delete o[h],u.pssh=new Uint8Array(s),u.keyId=n,e=o[c]=e.then(()=>this.generateRequestWithPreferredKeySession(d,a,s,"encrypted-event-key-match"));break}}}(e=e||(o[c]=this.getKeySystemSelectionPromise([t]).then(({keySystem:e,mediaKeys:r})=>{var t;this.throwIfDestroyed();const i=new Xt("ISO-23001-7",c,null!=(t=bt(e))?t:"");return i.pssh=new Uint8Array(s),i.keyId=n,this.attemptSetMediaKeys(e,r).then(()=>{this.throwIfDestroyed();var t=this.createMediaKeySessionContext({decryptdata:i,keySystem:e,mediaKeys:r});return this.generateRequestWithPreferredKeySession(t,a,s,"encrypted-event-no-match")})}))).catch(t=>this.handleError(t))}}}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,e){const r=this.setMediaKeysQueue.slice(),i=(this.log(`Setting media-keys for "${t}"`),Promise.all(r).then(()=>{if(this.media)return this.media.setMediaKeys(e);throw new Error("Attempted to set mediaKeys without media element attached")}));return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${t}"`),r.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(t=>-1===r.indexOf(t))})}generateRequestWithPreferredKeySession(i,t,e,r){var n=null==(n=this.config.drmSystems)||null==(n=n[i.keySystem])?void 0:n.generateRequest;if(n)try{var a=n.call(this.hls,t,e,i);if(!a)throw new Error("Invalid response from configured generateRequest filter");t=a.initDataType,e=i.decryptdata.pssh=a.initData?new Uint8Array(a.initData):null}catch(t){if(this.warn(t.message),null!=(n=this.hls)&&n.config.debug)throw t}if(null===e)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(i);const s=this.getKeyIdString(i.decryptdata),o=(this.log(`Generating key-session request for "${r}": ${s} (init data type: ${t} length: ${e?e.byteLength:null})`),new Ui),l=(i.mediaKeysSession.onmessage=t=>{var e,r=i.mediaKeysSession;r?({messageType:t,message:e}=t,this.log(`"${t}" message event for session "${r.sessionId}" message size: `+e.byteLength),"license-request"===t||"license-renewal"===t?this.renewLicense(i,e).catch(t=>{this.handleError(t),o.emit("error",t)}):"license-release"===t?i.keySystem===p.FAIRPLAY&&(this.updateKeySession(i,pt("acknowledged")),this.removeSession(i)):this.warn(`unhandled media key message type "${t}"`)):o.emit("error",new Error("invalid state"))},i.mediaKeysSession.onkeystatuseschange=t=>{var e;i.mediaKeysSession?(this.onKeyStatusChange(i),e=i.keyStatus,o.emit("keyStatus",e),"expired"===e&&(this.warn(i.keySystem+" expired for key "+s),this.renewKeySession(i))):o.emit("error",new Error("invalid state"))},new Promise((e,r)=>{o.on("error",r),o.on("keyStatus",t=>{t.startsWith("usable")?e():"output-restricted"===t?r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===t?r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${t}"`)):"expired"===t?r(new Error("key expired while generating request")):this.warn(`unhandled key status change "${t}"`)})}));return i.mediaKeysSession.generateRequest(t,e).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=i.mediaKeysSession)?void 0:t.sessionId}" keyId: `+s)}).catch(t=>{throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_SESSION,error:t,fatal:!1},"Error generating key-session request: "+t)}).then(()=>l).catch(t=>{throw o.removeAllListeners(),this.removeSession(i),t}).then(()=>(o.removeAllListeners(),i))}onKeyStatusChange(r){r.mediaKeysSession.keyStatuses.forEach((t,e)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${g.hexDump("buffer"in e?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e))} session keyId: ${g.hexDump(new Uint8Array(r.decryptdata.keyId||[]))} uri: `+r.decryptdata.uri),r.keyStatus=t})}fetchServerCertificate(o){const r=this.config;const i=new r.loader(r),l=this.getServerCertificateUrl(o);return l?(this.log(`Fetching serverCertificate for "${o}"`),new Promise((n,a)=>{const s={responseType:"arraybuffer",url:l};var t=r.certLoadPolicy.default,t={loadPolicy:t,timeout:t.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},e={onSuccess:(t,e,r,i)=>{n(t.data)},onError:(t,e,r,i)=>{a(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:f({url:s.url,data:void 0},t)},`"${o}" certificate request failed (${l}). Status: ${t.code} (${t.text})`))},onTimeout:(t,e,r)=>{a(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:s.url,data:void 0}},`"${o}" certificate request timed out (${l})`))},onAbort:(t,e,r)=>{a(new Error("aborted"))}};i.load(s,t,e)})):Promise.resolve()}setMediaKeysServerCertificate(i,n,a){return new Promise((e,r)=>{i.setServerCertificate(a).then(t=>{this.log(`setServerCertificate ${t?"success":"not supported by CDM"} (${null==a?void 0:a.byteLength}) on "${n}"`),e(i)}).catch(t=>{r(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(t=>{throw new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:t,fatal:!0},t.message)}))}setupLicenseXHR(e,r,i,n){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(i.decryptdata)return a.call(this.hls,e,r,i,n);throw new Error("Key removed")}).catch(t=>{if(i.decryptdata)return e.open("POST",r,!0),a.call(this.hls,e,r,i,n);throw t}).then(t=>{return e.readyState||e.open("POST",r,!0),{xhr:e,licenseChallenge:t||n}}):(e.open("POST",r,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(a,s){const o=this.config.keyLoadPolicy.default;return new Promise((r,t)=>{const i=this.getLicenseServerUrl(a.keySystem),n=(this.log("Sending license request to URL: "+i),new XMLHttpRequest);n.responseType="arraybuffer",n.onreadystatechange=()=>{if(!this.hls||!a.mediaKeysSession)return t(new Error("invalid state"));if(4===n.readyState)if(200===n.status){this._requestLicenseFailureCount=0;let t=n.response;this.log("License received "+(t instanceof ArrayBuffer?t.byteLength:t));var e=this.config.licenseResponseCallback;if(e)try{t=e.call(this.hls,n,i,a)}catch(t){this.error(t)}r(t)}else{var e=o.errorRetry,e=e?e.maxNumRetry:0;this._requestLicenseFailureCount++,this._requestLicenseFailureCount>e||400<=n.status&&n.status<500?t(new h({type:K.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:i,data:void 0,code:n.status,text:n.statusText}},`License Request XHR failed (${i}). Status: ${n.status} (${n.statusText})`)):(e=e-this._requestLicenseFailureCount+1,this.warn(`Retrying license request, ${e} attempts left`),this.requestLicense(a,s).then(r,t))}},a.licenseXhr&&a.licenseXhr.readyState!==XMLHttpRequest.DONE&&a.licenseXhr.abort(),a.licenseXhr=n,this.setupLicenseXHR(n,i,a,s).then(({xhr:t,licenseChallenge:e})=>{t.send(e)})})}onMediaAttached(t,e){this.config.emeEnabled&&(e=e.media,(this.media=e).addEventListener("encrypted",this.onMediaEncrypted),e.addEventListener("waitingforkey",this.onWaitingForKey))}onMediaDetached(){const e=this.media,t=this.mediaKeySessions,r=(e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Xt.clearKeyUriToKeyIdMap(),t.length);Yn.CDMCleanupPromise=Promise.all(t.map(t=>this.removeSession(t)).concat(null==e?void 0:e.setMediaKeys(null).catch(t=>{this.log(`Could not clear media keys: ${t}. media.src: `+(null==e?void 0:e.src))}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: `+(null==e?void 0:e.src))})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:e}){e&&this.config.emeEnabled&&(this.keyFormatPromise||(e=e.reduce((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t),[]),this.log("Selecting key-system from session-keys "+e.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(e)))}removeSession(t){const{mediaKeysSession:e,licenseXhr:r}=t;if(e)return this.log("Remove licenses and keys and close session "+e.sessionId),e.onmessage=null,e.onkeystatuseschange=null,r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0,-1<(t=this.mediaKeySessions.indexOf(t))&&this.mediaKeySessions.splice(t,1),e.remove().catch(t=>{this.log("Could not remove session: "+t)}).then(()=>e.close()).catch(t=>{this.log("Could not close session: "+t)})}}Yn.CDMCleanupPromise=void 0;class h extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),(this.data=t).err=t.error}}var qn="m",zn="a",Qn="v",Xn="av",Jn="i",Zn="tt";class ta{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:qn,su:!this.initialized})}catch(t){V.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=t=>{try{var e=t.frag,r=this.hls.levels[e.level],i=this.getObjectType(e),n={d:1e3*e.duration,ot:i};i!==Qn&&i!==zn&&i!=Xn||(n.br=r.bitrate/1e3,n.tb=this.getTopBandwidth(i)/1e3,n.bl=this.getBufferLength(i)),this.apply(t,n)}catch(t){V.warn("Could not generate segment CMCD data.",t)}},this.hls=t;var t=this.config=t.config,e=t["cmcd"];null!=e&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||ta.uuid(),this.cid=e.contentId,this.useHeaders=!0===e.useHeaders,this.registerListeners())}registerListeners(){var t=this.hls;t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHED,this.onMediaDetached,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){var t=this.hls;t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHED,this.onMediaDetached,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var r;this.audioBuffer=null==(r=e.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(r=e.tracks.video)?void 0:r.buffer}createData(){var t;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){G(e,this.createData());var r=e.ot===Jn||e.ot===Qn||e.ot===Xn;this.starved&&r&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering),this.useHeaders?(r=ta.toHeaders(e),Object.keys(r).length&&(t.headers||(t.headers={}),G(t.headers,r))):(r=ta.toQuery(e))&&(t.url=ta.appendQueryToUri(t.url,r))}getObjectType(t){var e=t["type"];return"subtitle"===e?Zn:"initSegment"===t.sn?Jn:"audio"===e?zn:"main"===e?this.hls.audioTracks.length?Qn:Xn:void 0}getTopBandwidth(t){let e=0,r;var i=this.hls;for(const n of r=t===zn?i.audioTracks:(t=-1<(t=i.maxAutoLevel)?t+1:i.levels.length,i.levels.slice(0,t)))n.bitrate>e&&(e=n.bitrate);return 0<e?e:NaN}getBufferLength(t){var e=this.hls.media,t=t===zn?this.audioBuffer:this.videoBuffer;return t&&e?1e3*S.bufferInfo(t,e.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){var t=this.config["pLoader"];const i=this.applyPlaylistData,e=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new e(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,e,r){i(t),this.loader.load(t,e,r)}}}createFragmentLoader(){var t=this.config["fLoader"];const i=this.applyFragmentData,e=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new e(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,e,r){i(t),this.loader.load(t,e,r)}}}static uuid(){var t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}static serialize(t){var r=[];const e=t=>Math.round(t);var i=t=>100*e(t/100),n={br:e,d:e,bl:i,dl:i,mtp:i,nor:t=>encodeURIComponent(t),rtp:i,tb:e};for(const s of Object.keys(t||{}).sort()){let e=t[s];if((a=e,!Number.isNaN(a)&&null!=a&&""!==a&&!1!==a)&&!("v"===s&&1===e||"pr"==s&&1===e)){var a=n[s],a=typeof(e=a?a(e):e);let t;t="ot"===s||"sf"===s||"st"===s?s+"="+e:"boolean"==a?s:"number"==a?s+"="+e:s+"="+JSON.stringify(e),r.push(t)}}return r.join(",")}static toHeaders(t){var e={},r=["Object","Request","Session","Status"],i=[{},{},{},{}],n={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const s of Object.keys(t))i[null!=n[s]?n[s]:1][s]=t[s];for(let t=0;t<i.length;t++){var a=ta.serialize(i[t]);a&&(e["CMCD-"+r[t]]=a)}return e}static toQuery(t){return"CMCD="+encodeURIComponent(ta.serialize(t))}static appendQueryToUri(t,e){var r;return e?(r=t.includes("?")?"&":"?",t+r+e):t}}function ea(e,i,n,a){e&&Object.keys(i).forEach(r=>{var t=e.filter(t=>t.groupId===r).map(t=>{var e=G({},t);return e.details=void 0,e.attrs=new B(e.attrs),e.url=e.attrs.URI=ra(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),e.groupId=e.attrs["GROUP-ID"]=i[r],e.attrs["PATHWAY-ID"]=a,e});e.push(...t)})}function ra(t,e,r,i){const{HOST:n,PARAMS:a,[r]:s}=i;let o;e&&(o=null==s?void 0:s[e])&&(t=o);const l=new self.URL(t);return n&&!o&&(l.host=n),a&&Object.keys(a).sort().forEach(t=>{t&&l.searchParams.set(t,a[t])}),l.href}const ia=/^age:\s*[\d.]+\s*$/im;class na{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new at,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState)&&(this.stats.aborted=!0,t.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(t){const r=this.loader=new self.XMLHttpRequest,i=this.stats,n=(i.loading.first=0,i.loaded=0,i.aborted=!1,this.xhrSetup);n?Promise.resolve().then(()=>{if(!this.stats.aborted)return n(r,e.url)}).catch(t=>(r.open("GET",e.url,!0),n(r,e.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(r,e,t)}).catch(t=>{this.callbacks.onError({code:r.status,text:t.message},e,r,i)}):this.openAndSendXhr(r,e,t)}}openAndSendXhr(t,e,r){t.readyState||t.open("GET",e.url,!0);var i=this.context.headers,{maxTimeToFirstByteMs:n,maxLoadTimeMs:a}=r.loadPolicy;if(i)for(const s in i)t.setRequestHeader(s,i[s]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),r.timeout=n&&N(n)?n:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),t.send()}readystatechange(){var t,e,r,i,{context:n,loader:a,stats:s}=this;n&&a&&(e=a.readyState,t=this.config,s.aborted||2<=e&&(0===s.loading.first&&(s.loading.first=Math.max(self.performance.now(),s.loading.start),t.timeout!==t.loadPolicy.maxLoadTimeMs)&&(self.clearTimeout(this.requestTimeout),t.timeout=t.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.loadPolicy.maxLoadTimeMs-(s.loading.first-s.loading.start))),4===e)&&(self.clearTimeout(this.requestTimeout),a.onreadystatechange=null,a.onprogress=null,e=a.status,i="text"!==a.responseType,200<=e&&e<300&&(i&&a.response||null!==a.responseText)?(s.loading.end=Math.max(self.performance.now(),s.loading.first),i=i?a.response:a.responseText,r="arraybuffer"===a.responseType?i.byteLength:i.length,s.loaded=s.total=r,s.bwEstimate=8e3*s.total/(s.loading.end-s.loading.first),this.callbacks&&((r=this.callbacks.onProgress)&&r(s,n,i,a),this.callbacks)&&(r={url:a.responseURL,data:i,code:e},this.callbacks.onSuccess(r,s,n,a))):Je(i=t.loadPolicy.errorRetry,s.retry,!1,e)?this.retry(i):(V.error(e+" while loading "+n.url),this.callbacks.onError({code:e,text:a.statusText},n,a,s))))}loadtimeout(){var t=null==(t=this.config)?void 0:t.loadPolicy.timeoutRetry;Je(t,this.stats.retry,!0)?this.retry(t):(V.warn("timeout while loading "+this.context.url),(t=this.callbacks)&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader)))}retry(t){var{context:e,stats:r}=this;this.retryDelay=Qe(t,r.retry),r.retry++,V.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${e.url}, retrying ${r.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){var e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;var e;return this.loader&&ia.test(this.loader.getAllResponseHeaders())&&(e=this.loader.getResponseHeader("age"),t=e?parseFloat(e):null),t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const aa=/(\d+)-(\d+)\/(\d+)/;class sa{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||oa,this.controller=new self.AbortController,this.stats=new at}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){var t=this.response;null!=t&&t.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(i,n,a){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();var t=function(t,e){e={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(G({},t.headers))};t.rangeEnd&&e.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1));return e}(i,this.controller.signal);const o=a.onProgress,l="arraybuffer"===i.responseType,u=l?"byteLength":"length",{maxTimeToFirstByteMs:e,maxLoadTimeMs:h}=n.loadPolicy;this.context=i,this.config=n,this.callbacks=a,this.request=this.fetchSetup(i,t),self.clearTimeout(this.requestTimeout),n.timeout=e&&N(e)?e:h,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(s,i,this.response)},n.timeout),self.fetch(this.request).then(t=>{this.response=this.loader=t;var e,r=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),n.timeout=h,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(s,i,this.response)},h-(r-s.loading.start)),t.ok)return s.loading.first=r,s.total=function(t){var e=t.get("Content-Range");if(e){e=function(t){t=aa.exec(t);if(t)return parseInt(t[2])-parseInt(t[1])+1}(e);if(N(e))return e}e=t.get("Content-Length");if(e)return parseInt(e)}(t.headers)||s.total,o&&N(n.highWaterMark)?this.loadProgressively(t,s,i,n.highWaterMark,o):l?t.arrayBuffer():"json"===i.responseType?t.json():t.text();throw{status:r,statusText:e}=t,new la(e||"fetch, bad network response",r,t)}).then(t=>{var e=this["response"],r=(self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first),t[u]),r=(r&&(s.loaded=s.total=r),{url:e.url,data:t,code:e.status});o&&!N(n.highWaterMark)&&o(s,i,t,e),a.onSuccess(r,s,i,e)}).catch(t=>{var e,r;self.clearTimeout(this.requestTimeout),s.aborted||(e=t&&t.code||0,r=t?t.message:null,a.onError({code:e,text:r},i,t?t.details:null,s))})}getCacheAge(){let t=null;var e;return this.response&&(e=this.response.headers.get("age"),t=e?parseFloat(e):null),t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(r,i,n,a=0,s){const o=new Wi,t=r.body.getReader(),l=()=>t.read().then(t=>{var e;return t.done?(o.dataLength&&s(i,n,o.flush(),r),Promise.resolve(new ArrayBuffer(0))):(e=(t=t.value).length,i.loaded+=e,e<a||o.dataLength?(o.push(t),o.dataLength>=a&&s(i,n,o.flush(),r)):s(i,n,t,r),l())}).catch(()=>Promise.reject());return l()}}function oa(t,e){return new self.Request(t.url,e)}class la extends Error{constructor(t,e,r){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=r}}const ua=/\s/,ha={newCue(e,r,i,n){var a,s=[];let o,l,u;var h,c=self.VTTCue||self.TextTrackCue;for(let t=0;t<n.rows.length;t++)if(a=n.rows[t],o=!0,l=0,u="",!a.isEmpty()){for(let t=0;t<a.chars.length;t++)ua.test(a.chars[t].uchar)&&o?l++:(u+=a.chars[t].uchar,o=!1);(a.cueStartTime=r)===i&&(i+=1e-4),16<=l?l--:l++;var d=Rn(u.trim()),f=Pn(r,i,d);null!=e&&null!=(h=e.cues)&&h.getCueById(f)||((h=new c(r,i,d)).id=f,h.line=t+1,h.align="left",h.position=10+Math.min(80,10*Math.floor(8*l/32)),s.push(h))}return e&&s.length&&(s.sort((t,e)=>"auto"===t.line||"auto"===e.line?0:8<t.line&&8<e.line?e.line-t.line:t.line-e.line),s.forEach(t=>Se(e,t))),s}};const ca=f(f({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:na,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0;t=(this.hls=t).config;this.bwEstimator=new Vi(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){var t=this["hls"];t.on($.FRAG_LOADING,this.onFragLoading,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){var t=this["hls"];t.off($.FRAG_LOADING,this.onFragLoading,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(t,e){var r=e.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(r=e.part)?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(t,e){this.clearTimer()}getTimeToLoadFrag(t,e,r,i){return t+r/e+(i?this.lastLevelLoadSec:0)}onLevelLoaded(t,e){var r=this.hls.config,{total:i,bwEstimate:n}=e.stats;N(i)&&N(n)&&(this.lastLevelLoadSec=8*i/n),e.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}_abandonRulesCheck(){var{fragCurrent:r,partCurrent:i,hls:n}=this,{autoLevelEnabled:a,media:s}=n;if(r&&s){var o=performance.now(),l=(i||r).stats,u=(i||r).duration,o=o-l.loading.start;if(l.aborted||l.loaded&&l.loaded===l.total||0===r.level)this.clearTimer(),this._nextAutoLevel=-1;else if(a&&!s.paused&&s.playbackRate&&s.readyState){a=n.mainForwardBufferInfo;if(null!==a){var h=this.bwEstimator.getEstimateTTFB(),s=Math.abs(s.playbackRate);if(!(o<=Math.max(h,u/(2*s)*1e3))){var c=a.len/s;if(!(2*u/s<=c)){var a=l.loading.first?l.loading.first-l.loading.start:-1,s=l.loaded&&-1<a,d=this.bwEstimator.getEstimate(),{levels:f,minAutoLevel:p}=n,g=f[r.level],g=l.total||Math.max(l.loaded,Math.round(u*g.maxBitrate/8));let t=o-a;t<1&&s&&(t=Math.min(o,8*l.loaded/d));var v=s?1e3*l.loaded/t:0,g=v?(g-l.loaded)/v:8*g/d+h/1e3;if(!(g<=c)){var m=v?8*v:d;let t=Number.POSITIVE_INFINITY,e;for(e=r.level-1;e>p;e--){var y=f[e].maxBitrate;if((t=this.getTimeToLoadFrag(h/1e3,m,u*y,!f[e].details))<c)break}t>=g||t>10*u||(n.nextLoadLevel=e,s?this.bwEstimator.sample(o-Math.min(h,a),l.loaded):this.bwEstimator.sampleTTFB(o),this.clearTimer(),V.warn(`[abr] Fragment ${r.sn}${i?" part "+i.index:""} of level ${r.level} is loading too slowly;
      Time to underbuffer: ${c.toFixed(3)} s
      Estimated load time for current fragment: ${g.toFixed(3)} s
      Estimated load time for down switch fragment: ${t.toFixed(3)} s
      TTFB estimate: ${a}
      Current BW estimate: ${N(d)?(d/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level `+e),r.loader&&(this.fragCurrent=this.partCurrent=null,r.abortRequests()),n.trigger($.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:i,stats:l}))}}}}}}}onFragLoaded(t,{frag:e,part:r}){var i,n,a,s=(r||e).stats;e.type===A&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),this.ignoreFragment(e)||(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate&&(n=(r||e).duration,i=((a=this.hls.levels[e.level]).loaded?a.loaded.bytes:0)+s.loaded,n=(a.loaded?a.loaded.duration:0)+n,a.loaded={bytes:i,duration:n},a.realBitrate=Math.round(8*i/n)),e.bitrateTest&&(a={stats:s,frag:e,part:r,id:e.type},this.onFragBuffered($.FRAG_BUFFERED,a),e.bitrateTest=!1))}onFragBuffered(t,e){var r,{frag:e,part:i}=e,i=(null!=i&&i.stats.loaded?i:e).stats;i.aborted||this.ignoreFragment(e)||(r=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB()),this.bwEstimator.sample(r,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),e.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0)}ignoreFragment(t){return t.type!==A||"initSegment"===t.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){var t=this._nextAutoLevel,e=this.bwEstimator;if(-1!==t&&!e.canEstimate())return t;let r=this.getNextABRAutoLevel();if(-1!==t){e=this.hls.levels;if(e.length>Math.max(t,r)&&e[t].loadError<=e[r].loadError)return t}return r=-1!==t?Math.min(t,r):r}getNextABRAutoLevel(){var t,{fragCurrent:e,partCurrent:r,hls:i}=this,{maxAutoLevel:n,config:a,minAutoLevel:s,media:o}=i,r=r?r.duration:e?e.duration:0,e=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,o=this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,i=i.mainForwardBufferInfo,i=(i?i.len:0)/e,e=this.findBestLevel(o,s,n,i,a.abrBandWidthFactor,a.abrBandWidthUpFactor);if(0<=e)return e;V.trace(`[abr] ${i?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let l=r?Math.min(r,a.maxStarvationDelay):a.maxStarvationDelay,u=a.abrBandWidthFactor,h=a.abrBandWidthUpFactor;return i||(t=this.bitrateTestDelay)&&(r=r?Math.min(r,a.maxLoadingDelay):a.maxLoadingDelay,l=r-t,V.trace(`[abr] bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*l)} ms`),u=h=1),e=this.findBestLevel(o,s,n,i+l,u,h),Math.max(e,0)}findBestLevel(r,t,i,n,a,s){var e,{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:u}=this,h=this.hls["levels"],c=h[u],d=!(null==c||null==(e=c.details)||!e.live),f=null==c?void 0:c.codecSet,p=l?l.duration:o?o.duration:0,g=this.bwEstimator.getEstimateTTFB()/1e3;let v=t,m=-1;for(let e=i;e>=t;e--){var y=h[e];if(!y||f&&y.codecSet!==f)y&&(v=Math.min(e,v),m=Math.max(e,m));else{-1!==m&&V.trace(`[abr] Skipped level(s) ${v}-${m} with CODECS:"${h[m].attrs.CODECS}"; not compatible with "${c.attrs.CODECS}"`);var y=y.details,E=(l?null==y?void 0:y.partTarget:null==y?void 0:y.averagetargetduration)||p;let t;t=e<=u?a*r:s*r;var T=h[e].maxBitrate,y=this.getTimeToLoadFrag(g,t,T*E,void 0===y);if(V.trace(`[abr] level:${e} adjustedbw-bitrate:${Math.round(t-T)} avgDuration:${E.toFixed(1)} maxFetchDuration:${n.toFixed(1)} fetchDuration:`+y.toFixed(1)),t>T&&(0===y||!N(y)||d&&!this.bitrateTestDelay||y<n))return e}}return-1}set nextAutoLevel(t){this._nextAutoLevel=t}},bufferController:class{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{var{media:t,mediaSource:e}=this;V.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger($.MEDIA_ATTACHED,{media:t})),e&&e.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{V.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{V.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{var{media:t,_objectUrl:e}=this;t&&t.src!==e&&V.error(`Media element src was set while attaching MediaSource (${e} > ${t.src})`)},this.hls=t,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return 0<this.getSourceBufferTypes().length||0<Object.keys(this.pendingTracks).length}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.BUFFER_RESET,this.onBufferReset,this),t.on($.BUFFER_APPENDING,this.onBufferAppending,this),t.on($.BUFFER_CODECS,this.onBufferCodecs,this),t.on($.BUFFER_EOS,this.onBufferEos,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this),t.on($.FRAG_PARSED,this.onFragParsed,this),t.on($.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.BUFFER_RESET,this.onBufferReset,this),t.off($.BUFFER_APPENDING,this.onBufferAppending,this),t.off($.BUFFER_CODECS,this.onBufferCodecs,this),t.off($.BUFFER_EOS,this.onBufferEos,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this),t.off($.FRAG_PARSED,this.onFragParsed,this),t.off($.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Qi(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){let r=2;(!e.audio||e.video)&&e.altAudio||(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,V.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")}onMediaAttaching(t,e){var r,e=this.media=e.media;e&&Xi&&((r=this.mediaSource=new Xi).addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(r),this._objectUrl=e.src,e.addEventListener("emptied",this._onMediaEmptied))}onMediaDetaching(){var{media:t,mediaSource:e,_objectUrl:r}=this;if(e){if(V.log("[buffer-controller]: media source detaching"),"open"===e.readyState)try{e.endOfStream()}catch(t){V.warn(`[buffer-controller]: onMediaDetaching: ${t.message} while calling endOfStream`)}this.onBufferReset(),e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(t.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),t.src===r?(t.removeAttribute("src"),t.load()):V.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger($.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{var t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){V.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}}),this._initSourceBuffer()}onBufferCodecs(t,u){const h=this.getSourceBufferTypes().length;Object.keys(u).forEach(t=>{var e,r,i,n,a,s,o,l;h?(e=this.tracks[t])&&"function"==typeof e.buffer.changeType&&({id:r,codec:i,levelCodec:n,container:a,metadata:s}=u[t],(o=(e.levelCodec||e.codec).replace(Ji,"$1"))!==(l=(n||i).replace(Ji,"$1")))&&(this.appendChangeType(t,a+";codecs="+(n||i)),V.log(`[buffer-controller]: switching codec ${o} to `+l),this.tracks[t]={buffer:e.buffer,codec:i,container:a,levelCodec:n,metadata:s,id:r}):this.pendingTracks[t]=u[t]}),h||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,r){const i=this["operationQueue"];i.append({execute:()=>{var t=this.sourceBuffer[e];t&&(V.log(`[buffer-controller]: changing ${e} sourceBuffer type to `+r),t.changeType(r)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{V.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}},e)}onBufferAppending(t,e){const{hls:r,operationQueue:i,tracks:n}=this,{data:a,type:s,frag:o,part:l,chunkMeta:u}=e,h=u.buffering[s];e=self.performance.now();h.start=e;const c=o.stats.buffering,d=l?l.stats.buffering:null;0===c.start&&(c.start=e),d&&0===d.start&&(d.start=e);e=n.audio;let f=!1;"audio"===s&&"audio/mpeg"===(null==e?void 0:e.container)&&(f=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const p=o.start;i.append({execute:()=>{var t,e;h.executeStart=self.performance.now(),f&&(t=this.sourceBuffer[s])&&(e=p-t.timestampOffset,.1<=Math.abs(e))&&(V.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${p} (delta: ${e}) sn: ${o.sn})`),t.timestampOffset=p),this.appendExecutor(a,s)},onStart:()=>{},onComplete:()=>{var t=self.performance.now(),e=(h.executeEnd=h.end=t,0===c.first&&(c.first=t),d&&0===d.first&&(d.first=t),this)["sourceBuffer"],r={};for(const s in e)r[s]=S.getBuffered(e[s]);this.appendError=0,this.hls.trigger($.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:r})},onError:t=>{V.error(`[buffer-controller]: Error encountered while trying to append to the ${s} SourceBuffer`,t);var e={type:K.MEDIA_ERROR,parent:o.type,details:H.BUFFER_APPEND_ERROR,frag:o,part:l,chunkMeta:u,error:t,err:t,fatal:!1};t.code===DOMException.QUOTA_EXCEEDED_ERR?e.details=H.BUFFER_FULL_ERROR:(this.appendError++,e.details=H.BUFFER_APPEND_ERROR,this.appendError>r.config.appendErrorMaxRetry&&(V.error(`[buffer-controller]: Failed ${r.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),e.fatal=!0)),r.trigger($.ERROR,e)}},s)}onBufferFlushing(t,r){const e=this["operationQueue"],i=e=>({execute:this.removeExecutor.bind(this,e,r.startOffset,r.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger($.BUFFER_FLUSHED,{type:e})},onError:t=>{V.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});r.type?e.append(i(r.type),r.type):this.getSourceBufferTypes().forEach(t=>{e.append(i(t),t)})}onFragParsed(t,e){const{frag:r,part:i}=e;var e=[],n=(i||r).elementaryStreams;n[st]?e.push("audiovideo"):(n[y]&&e.push("audio"),n[k]&&e.push("video"));0===e.length&&V.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: `+r.sn),this.blockBuffers(()=>{var t=self.performance.now(),t=(r.stats.buffering.end=t,i&&(i.stats.buffering.end=t),(i||r).stats);this.hls.trigger($.FRAG_BUFFERED,{frag:r,part:i,stats:t,id:r.type})},e)}onFragChanged(t,e){this.flushBackBuffer()}onBufferEos(t,i){this.getSourceBufferTypes().reduce((t,e)=>{var r=this.sourceBuffer[e];return!r||i.type&&i.type!==e||(r.ending=!0,r.ended)||(r.ended=!0,V.log(`[buffer-controller]: ${e} sourceBuffer now EOS`)),t&&!(r&&!r.ended)},!0)&&(V.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(t=>{t=this.sourceBuffer[t];t&&(t.ending=!1)});var t=this["mediaSource"];t&&"open"===t.readyState?(V.log("[buffer-controller]: Calling mediaSource.endOfStream()"),t.endOfStream()):t&&V.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+t.readyState)}))}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:i,details:n,media:t,sourceBuffer:a}=this;if(t&&null!==n){var e=this.getSourceBufferTypes();if(e.length){var r=n.live&&null!==i.config.liveBackBufferLength?i.config.liveBackBufferLength:i.config.backBufferLength;if(N(r)&&!(r<0)){const s=t.currentTime,o=n.levelTargetDuration;r=Math.max(r,o);const l=Math.floor(s/o)*o-r;e.forEach(t=>{var e=a[t];if(e){var r=S.getBuffered(e);if(0<r.length&&l>r.start(0)){if(i.trigger($.BACK_BUFFER_REACHED,{bufferEnd:l}),n.live)i.trigger($.LIVE_BACK_BUFFER_REACHED,{bufferEnd:l});else if(e.ended&&r.end(r.length-1)-s<2*o)return void V.info(`[buffer-controller]: Cannot flush ${t} back buffer while SourceBuffer is in ended state`);i.trigger($.BUFFER_FLUSHING,{startOffset:0,endOffset:l,type:t})}}})}}}}updateMediaElementDuration(){var t,e,r,i,n,a;this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState&&({details:t,hls:e,media:n,mediaSource:r}=this,i=t.fragments[0].start+t.totalduration,n=n.duration,a=N(r.duration)?r.duration:0,t.live&&e.config.liveDurationInfinity?(V.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(t)):(a<i&&n<i||!N(n))&&(V.log("[buffer-controller]: Updating Media Source duration to "+i.toFixed(3)),r.duration=i))}updateSeekableRange(t){var e=this.mediaSource,r=t.fragments;r.length&&t.live&&null!=e&&e.setLiveSeekableRange&&(r=Math.max(0,r[0].start),t=Math.max(r,r+t.totalduration),e.setLiveSeekableRange(r,t))}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:e,pendingTracks:r}=this;var i=Object.keys(r).length;(i&&!t||2===i)&&(this.createSourceBuffers(r),this.pendingTracks={},(i=this.getSourceBufferTypes()).length?(this.hls.trigger($.BUFFER_CREATED,{tracks:this.tracks}),i.forEach(t=>{e.executeNext(t)})):(i=new Error("could not create source buffer for media codec(s)"),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:i,reason:i.message})))}createSourceBuffers(t){var{sourceBuffer:e,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const l in t)if(!e[l]){var i=t[l];if(!i)throw Error(`source buffer exists for track ${l}, however track does not`);var n=i.levelCodec||i.codec,a=i.container+";codecs="+n;V.log(`[buffer-controller]: creating sourceBuffer(${a})`);try{var s=e[l]=r.addSourceBuffer(a),o=l;this.addBufferListener(o,"updatestart",this._onSBUpdateStart),this.addBufferListener(o,"updateend",this._onSBUpdateEnd),this.addBufferListener(o,"error",this._onSBUpdateError),this.tracks[l]={buffer:s,codec:n,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id}}catch(t){V.error("[buffer-controller]: error while trying to add sourceBuffer: "+t.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:t,mimeType:a})}}}_onSBUpdateStart(t){var e=this["operationQueue"];e.current(t).onStart()}_onSBUpdateEnd(t){var e=this["operationQueue"];e.current(t).onComplete(),e.shiftAndExecuteNext(t)}_onSBUpdateError(t,e){var r=new Error(t+" SourceBuffer error"),r=(V.error("[buffer-controller]: "+r,e),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.BUFFER_APPENDING_ERROR,error:r,fatal:!1}),this.operationQueue.current(t));r&&r.onError(e)}removeExecutor(t,e,r){var{media:i,mediaSource:n,operationQueue:a,sourceBuffer:s}=this,s=s[t];i&&n&&s?(i=N(i.duration)?i.duration:1/0,n=N(n.duration)?n.duration:1/0,(e=Math.max(0,e))<(r=Math.min(r,i,n))&&!s.ending?(s.ended=!1,V.log(`[buffer-controller]: Removing [${e},${r}] from the ${t} SourceBuffer`),s.remove(e,r)):a.shiftAndExecuteNext(t)):(V.warn(`[buffer-controller]: Attempting to remove from the ${t} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(t))}appendExecutor(t,e){var{operationQueue:r,sourceBuffer:i}=this,i=i[e];i?(i.ended=!1,i.appendBuffer(t)):(V.warn(`[buffer-controller]: Attempting to append to the ${e} SourceBuffer, but it does not exist`),r.shiftAndExecuteNext(e))}blockBuffers(t,e=this.getSourceBufferTypes()){if(e.length){const i=this["operationQueue"];var r=e.map(t=>i.appendBlocker(t));Promise.all(r).then(()=>{t(),e.forEach(t=>{var e=this.sourceBuffer[t];null!=e&&e.updating||i.shiftAndExecuteNext(t)})})}else V.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t)}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,e,r){var i=this.sourceBuffer[t];i&&(r=r.bind(this,t),this.listeners[t].push({event:e,listener:r}),i.addEventListener(e,r))}removeBufferListeners(t){const e=this.sourceBuffer[t];e&&this.listeners[t].forEach(t=>{e.removeEventListener(t.event,t.listener)})}},capLevelController:Vn,errorController:class{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=V.log.bind(V,"[info]:"),this.warn=V.warn.bind(V,"[warning]:"),this.error=V.error.bind(V,"[error]:"),this.registerListeners()}registerListeners(){var t=this.hls;t.on($.ERROR,this.onError,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){var t=this.hls;t&&(t.off($.ERROR,this.onError,this),t.off($.ERROR,this.onErrorOut,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){this.playlistError=0}stopLoad(){}getVariantLevelIndex(t){return(null==t?void 0:t.type)===A?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,e){if(!e.fatal){var r,i=this.hls,n=e.context;switch(e.details){case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case H.FRAG_PARSING_ERROR:if(null!=(a=e.frag)&&a.gap)return void(e.errorAction={action:ir,flags:sr});case H.FRAG_GAP:case H.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=nr);case H.LEVEL_EMPTY_ERROR:case H.LEVEL_PARSING_ERROR:var a=e.parent===A?e.level:i.loadLevel;return void(e.details===H.LEVEL_EMPTY_ERROR&&null!=(s=e.context)&&null!=(s=s.levelDetails)&&s.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,a):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,a)));case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==n?void 0:n.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.level)));case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.SUBTITLE_LOAD_ERROR:case H.SUBTITLE_TRACK_LOAD_TIMEOUT:if(n){var s=i.levels[i.loadLevel];if(s&&(n.type===E&&n.groupId===s.audioGroupId||n.type===b&&n.groupId===s.textGroupId))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,i.loadLevel),e.errorAction.action=nr,void(e.errorAction.flags=or)}return;case H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var a=i.levels[i.loadLevel],s=null==a?void 0:a.attrs["HDCP-LEVEL"];return void(s&&(e.errorAction={action:nr,flags:lr,hdcpLevel:s}));case H.BUFFER_ADD_CODEC_ERROR:case H.REMUX_ALLOC_ERROR:return void(e.errorAction=this.getLevelSwitchAction(e,null!=(a=e.level)?a:i.loadLevel));case H.INTERNAL_EXCEPTION:case H.BUFFER_APPENDING_ERROR:case H.BUFFER_APPEND_ERROR:case H.BUFFER_FULL_ERROR:case H.LEVEL_SWITCH_ERROR:case H.BUFFER_STALLED_ERROR:case H.BUFFER_SEEK_OVER_HOLE:case H.BUFFER_NUDGE_ON_STALL:return void(e.errorAction={action:ir,flags:sr})}e.type===K.KEY_SYSTEM_ERROR&&(r=this.getVariantLevelIndex(e.frag),e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,r))}}getPlaylistRetryOrSwitchAction(t,e){var r=ze(this.hls.config.playlistLoadPolicy,t),i=this.playlistError++,n=null==(n=t.response)?void 0:n.code;return Je(r,i,qe(t),n)?{action:ar,flags:sr,retryConfig:r,retryCount:i}:(n=this.getLevelSwitchAction(t,e),r&&(n.retryConfig=r,n.retryCount=i),n)}getFragRetryOrSwitchAction(t){var e=this.hls,r=this.getVariantLevelIndex(t.frag),i=e.levels[r],{fragLoadPolicy:n,keyLoadPolicy:a}=e.config,a=ze(t.details.startsWith("key")?a:n,t),n=e.levels.reduce((t,e)=>t+e.fragmentError,0);if(i){t.details!==H.FRAG_GAP&&i.fragmentError++;i=null==(e=t.response)?void 0:e.code;if(Je(a,n,qe(t),i))return{action:ar,flags:sr,retryConfig:a,retryCount:n}}e=this.getLevelSwitchAction(t,r);return a&&(e.retryConfig=a,e.retryCount=n),e}getLevelSwitchAction(r,t){var i=this.hls,n=(null==t&&(t=i.loadLevel),this.hls.levels[t]);if(n&&(n.loadError++,i.autoLevelEnabled)){let e=-1;var{levels:a,loadLevel:s,minAutoLevel:o,maxAutoLevel:l}=i,u=null==(t=r.frag)?void 0:t.type,{type:h,groupId:c}=null!=(t=r.context)?t:{};for(let t=a.length;t--;){var d=(t+s)%a.length;if(d!==s&&o<=d&&d<=l&&0===a[d].loadError){var f=a[d];if(r.details===H.FRAG_GAP&&r.frag){var p=a[d].details;if(p){p=er(r.frag,p.fragments,r.frag.start);if(null!=p&&p.gap)continue}}else{if(h===E&&c===f.audioGroupId||h===b&&c===f.textGroupId)continue;if(u===_&&n.audioGroupId===f.audioGroupId||u===Ee&&n.textGroupId===f.textGroupId)continue}e=d;break}}if(-1<e&&i.loadLevel!==e)return r.levelRetry=!0,this.playlistError=0,{action:nr,flags:sr,nextAutoLevel:e}}return{action:nr,flags:or}}onErrorOut(t,e){var r;switch(null==(r=e.errorAction)?void 0:r.action){case ir:break;case nr:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===H.FRAG_GAP||(e.fatal=!0)}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){var e=this.hls,r=t.errorAction;if(r){var{flags:i,hdcpLevel:n,nextAutoLevel:a}=r;switch(i){case sr:this.switchLevel(t,a);break;case or:r.resolved||(r.resolved=this.redundantFailover(t));break;case lr:n&&(e.maxHdcpLevel=Me[Me.indexOf(n)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`)}r.resolved||this.switchLevel(t,a)}}switchLevel(t,e){void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after `+t.details),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){var{hls:r,penalizedRenditions:i}=this,n=e.parent===A?e.level:r.loadLevel,a=r.levels[n],s=a.url.length,o=(e.frag||a).urlId;a.urlId!==o||e.frag&&!a.details||this.penalizeRendition(a,e);for(let t=1;t<s;t++){const u=(o+t)%s;var l=i[u];if(!l||function(t,e,r){if(3e5<performance.now()-t.lastErrorPerfMs)return 1;var i=t.details;if(e.details===H.FRAG_GAP&&i&&e.frag){var n=e.frag.start,n=er(null,i.fragments,n);if(n&&!n.gap)return 1}if(r&&t.errors.length<r.errors.length){n=t.errors[t.errors.length-1];if(i&&n.frag&&e.frag&&Math.abs(n.frag.start-e.frag.start)>3*i.targetduration)return 1}return}(l,e,i[o]))return this.warn(`Switching to Redundant Stream ${1+u}/${s}: "${a.url[u]}" after `+e.details),this.playlistError=0,r.levels.forEach(t=>{t.urlId=u}),r.nextLoadLevel=n,!0}return!1}penalizeRendition(t,e){var r=this["penalizedRenditions"],i=r[t.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};i.lastErrorPerfMs=performance.now(),i.errors.push(e),i.details=t.details,r[t.urlId]=i}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on($.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off($.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){var r=this.hls.config;r.capLevelOnFPSDrop&&(e=e.media instanceof self.HTMLVideoElement?e.media:null,(this.media=e)&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod))}checkFPS(t,e,r){var i,n,a,s,o=performance.now();e&&(this.lastTime&&(s=o-this.lastTime,i=r-this.lastDroppedFrames,n=e-this.lastDecodedFrames,s=1e3*i/s,(a=this.hls).trigger($.FPS_DROP,{currentDropped:i,currentDecoded:n,totalDroppedFrames:r}),0<s)&&i>a.config.fpsDroppedMonitoringThreshold*n&&(s=a.currentLevel,V.warn("drop FPS ratio greater than max allowed value for currentLevel: "+s),0<s)&&(-1===a.autoLevelCapping||a.autoLevelCapping>=s)&&(s-=1,a.trigger($.FPS_DROP_LEVEL_CAPPING,{level:s,droppedLevel:a.currentLevel}),a.autoLevelCapping=s,this.streamController.nextLevelSwitch()),this.lastTime=o,this.lastDroppedFrames=r,this.lastDecodedFrames=e)}checkFPSInterval(){var t,e=this.media;e&&(this.isVideoPlaybackQualityAvailable?(t=e.getVideoPlaybackQuality(),this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount))}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:_t,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:ha,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends jr{constructor(t,e,r){super(t,e,r,"[subtitle-stream-controller]",Ee),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.ERROR,this.onError,this),t.on($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on($.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on($.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.ERROR,this.onError,this),t.off($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off($.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off($.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=L.IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,r){var{frag:r,success:i}=r;if(this.fragPrevious=r,this.state=L.IDLE,i){var n=this.tracksBuffered[this.currentTrackId];if(n){let e;var a=r.start;for(let t=0;t<n.length;t++)if(a>=n[t].start&&a<=n[t].end){e=n[t];break}i=r.start+r.duration;e?e.end=i:(e={start:a,end:i},n.push(e)),this.fragmentTracker.fragBuffered(r)}}}onBufferFlushing(t,e){var{startOffset:r,endOffset:i}=e;if(0===r&&i!==Number.POSITIVE_INFINITY){const n=i-1;n<=0||(e.endOffsetSubtitles=Math.max(0,n),this.tracksBuffered.forEach(e=>{for(let t=0;t<e.length;)if(e[t].end<=n)e.shift();else{if(!(e[t].start<n))break;e[t].start=n,t++}}),this.fragmentTracker.removeFragmentsInRange(r,n,Ee))}}onFragBuffered(t,e){this.loadedmetadata||e.frag.type!==A||null!=(e=this.media)&&e.buffered.length&&(this.loadedmetadata=!0)}onError(t,e){e=e.frag;(null==e?void 0:e.type)===Ee&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==L.STOPPED)&&(this.state=L.IDLE)}onSubtitleTracksUpdated(t,{subtitleTracks:e}){Yi(this.levels,e)?this.levels=e.map(t=>new je(t)):(this.tracksBuffered=[],this.levels=e.map(t=>{t=new je(t);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Ee),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){this.currentTrackId=e.id,this.levels.length&&-1!==this.currentTrackId?(null!=(e=this.levels[this.currentTrackId])&&e.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,e&&this.setInterval(500)):this.clearInterval()}onSubtitleTrackLoaded(t,e){var{details:e,id:r}=e,{currentTrackId:i,levels:n}=this;if(n.length){var a=n[i];if(!(r>=n.length||r!==i)&&a){this.mediaBuffer=this.mediaBufferTimeRanges;let t=0;if(e.live||null!=(n=a.details)&&n.live){i=this.mainDetails;if(e.deltaUpdateFailed||!i)return;n=i.fragments[0];a.details?0===(t=this.alignPlaylists(e,a.details))&&n&&Ve(e,t=n.start):e.hasProgramDateTime&&i.hasProgramDateTime?(Or(e,i),t=e.fragments[0].start):n&&Ve(e,t=n.start)}a.details=e,this.levelLastLoaded=r,this.startFragRequested||!this.mainDetails&&e.live||this.setStartPosition(a.details,t),this.tick(),e.live&&!this.fragCurrent&&this.media&&this.state===L.IDLE&&!er(null,e.fragments,this.media.currentTime,0)&&(this.warn("Subtitle playlist not aligned with playback"),a.details=void 0)}}}_handleFragmentLoadComplete(t){const{frag:r,payload:e}=t;t=r.decryptdata;const i=this.hls;if(!this.fragContextChanged(r)&&e&&0<e.byteLength&&t&&t.key&&t.iv&&"AES-128"===t.method){const n=performance.now();this.decrypter.decrypt(new Uint8Array(e),t.key.buffer,t.iv.buffer).catch(t=>{throw i.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:r}),t}).then(t=>{var e=performance.now();i.trigger($.FRAG_DECRYPTED,{frag:r,payload:t,stats:{tstart:n,tdecrypt:e}})}).catch(t=>{this.warn(t.name+": "+t.message),this.state=L.IDLE})}}doTick(){if(this.media){if(this.state===L.IDLE){var{currentTrackId:e,levels:r}=this,e=r[e];if(r.length&&e&&e.details){var r=this["config"],i=this.getLoadPosition(),{end:i,len:n}=S.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,r.maxBufferHole),a=this.getFwdBufferInfo(this.media,A),s=e.details,a=this.getMaxBufferLength(null==a?void 0:a.len)+s.levelTargetDuration;if(!(a<n)){var a=s.fragments,n=a.length,o=s.edge;let t=null;var l=this.fragPrevious;i<o?(r=o-(o=r.maxFragLookUpTolerance)<i?0:o,!(t=er(l,a,Math.max(a[0].start,i),r))&&l&&l.start<a[0].start&&(t=a[0])):t=a[n-1],t&&("initSegment"!==(t=this.mapToInitFragWhenRequired(t)).sn&&(o=a[t.sn-s.startSN-1])&&o.cc===t.cc&&this.fragmentTracker.getState(o)===pr&&(t=o),this.fragmentTracker.getState(t)===pr)&&this.loadFragment(t,e,i)}}}}else this.state=L.IDLE}getMaxBufferLength(t){var e=super.getMaxBufferLength();return t?Math.max(e,t):e}loadFragment(t,e,r){"initSegment"===(this.fragCurrent=t).sn?this._loadInitSegment(t,e):(this.startFragRequested=!0,super.loadFragment(t,e,r))}get mediaBufferTimeRanges(){return new qi(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends ur{constructor(t){super(t,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,-1<this.trackId&&this.toggleTrackModes(this.trackId)}registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off($.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(-1<this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),-1<this.trackId&&(this.queuedDefaultTrack=this.trackId),zi(this.media.textTracks).forEach(t=>{Le(t)}),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){var r,{id:i,details:n}=e,a=this["trackId"],a=this.tracksInGroup[a];a?(r=a.details,a.details=e.details,this.log(`subtitle track ${i} loaded [${n.startSN}-${n.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,r)):this.warn("Invalid subtitle track id "+i)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){t=this.hls.levels[t];if(null!=t&&t.textGroupIds){const n=t.textGroupIds[t.urlId];var e,r,i,t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.groupId!==n?(e=this.tracks.filter(t=>!n||t.groupId===n),this.tracksInGroup=e,r=this.findTrackId(null==t?void 0:t.name)||this.findTrackId(),this.groupId=n||null,i={subtitleTracks:e},this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${n}" group-id`),this.hls.trigger($.SUBTITLE_TRACKS_UPDATED,i),-1!==r&&this.setSubtitleTrack(r,t)):this.shouldReloadPlaylist(t)&&this.setSubtitleTrack(this.trackId,t)}}findTrackId(e){var r=this.tracksInGroup;for(let t=0;t<r.length;t++){var i=r[t];if((!this.selectDefaultTrack||i.default)&&(!e||e===i.name))return i.id}return-1}onError(t,e){!e.fatal&&e.context&&e.context.type===b&&e.context.id===this.trackId&&e.context.groupId===this.groupId&&this.checkRetry(e)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1;var e=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,e)}loadPlaylist(e){super.loadPlaylist();var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var i=r.id,n=r.groupId;let t=r.url;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}this.log("Loading subtitle playlist for id "+i),this.hls.trigger($.SUBTITLE_TRACK_LOADING,{url:t,id:i,groupId:n,deliveryDirectives:e||null})}}toggleTrackModes(t){var e,{media:r,trackId:i}=this;r&&(e=(r=zi(r.textTracks)).filter(t=>t.groupId===this.groupId),-1===t?[].slice.call(r).forEach(t=>{t.mode="disabled"}):(r=e[i])&&(r.mode="disabled"),i=e[t])&&(i.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(t,e){var r,i,n,a,s,o=this.tracksInGroup;this.media?(this.trackId!==t&&this.toggleTrackModes(t),this.trackId===t&&(-1===t||null!=(r=o[t])&&r.details)||t<-1||t>=o.length||(this.clearTimer(),r=o[t],this.log("Switching to subtitle-track "+t+(r?` "${r.name}" lang:${r.lang} group:`+r.groupId:"")),this.trackId=t,r?({id:o,groupId:i="",name:n,type:a,url:s}=r,this.hls.trigger($.SUBTITLE_TRACK_SWITCH,{id:o,groupId:i,name:n,type:a,url:s}),o=this.switchParams(r.url,null==e?void 0:e.details),this.loadPlaylist(o)):this.hls.trigger($.SUBTITLE_TRACK_SWITCH,{id:t}))):this.queuedDefaultTrack=t}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){let e=-1;var r=zi(this.media.textTracks);for(let t=0;t<r.length;t++)if("hidden"===r[t].mode)e=t;else if("showing"===r[t].mode){e=t;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}},timelineController:class{constructor(t){var e,r,i,n;this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Hn(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions&&(e=new En(this,"textTrack1"),r=new En(this,"textTrack2"),i=new En(this,"textTrack3"),n=new En(this,"textTrack4"),this.cea608Parser1=new gn(1,e,r),this.cea608Parser2=new gn(3,i,n)),t.on($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on($.FRAG_LOADING,this.onFragLoading,this),t.on($.FRAG_LOADED,this.onFragLoaded,this),t.on($.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on($.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on($.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on($.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){var t=this["hls"];t.off($.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off($.FRAG_LOADING,this.onFragLoading,this),t.off($.FRAG_LOADED,this.onFragLoaded,this),t.off($.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off($.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off($.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off($.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(t,e,r,i,n){let a=!1;for(let t=n.length;t--;){var s=n[t],o=(l=s[0],o=s[1],u=e,Math.min(o,r)-Math.max(l,u));if(0<=o&&(s[0]=Math.min(s[0],e),s[1]=Math.max(s[1],r),a=!0,.5<o/(r-e)))return}var l,o,u,h;a||n.push([e,r]),this.config.renderTextTracksNatively?(h=this.captionsTracks[t],this.Cues.newCue(h,e,r,i)):(h=this.Cues.newCue(null,e,r,i),this.hls.trigger($.CUES_PARSED,{type:"captions",cues:h,track:t}))}onInitPtsFound(t,{frag:e,id:r,initPTS:i,timescale:n}){var a=this["unparsedVttFrags"];"main"===r&&(this.initPTS[e.cc]={baseTime:i,timescale:n}),a.length&&(this.unparsedVttFrags=[],a.forEach(t=>{this.onFragLoaded($.FRAG_LOADED,t)}))}getExistingTrack(e){var r=this["media"];if(r)for(let t=0;t<r.textTracks.length;t++){var i=r.textTracks[t];if(i[e])return i}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){var e,r,i,n,a;this.captionsTracks[t]||({captionsProperties:i,captionsTracks:e,media:r}=this,{label:i,languageCode:n}=i[t],(a=this.getExistingTrack(t))?(e[t]=a,Le(e[t]),_e(e[t],r)):(a=this.createTextTrack("captions",i,n))&&(a[t]=!0,e[t]=a))}createNonNativeTrack(t){var e;this.nonNativeCaptionsTracks[t]||(e=this.captionsProperties[t])&&(e={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media},this.nonNativeCaptionsTracks[t]=e,this.hls.trigger($.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[e]}))}createTextTrack(t,e,r){var i=this.media;if(i)return i.addTextTrack(t,e,r)}onMediaAttaching(t,e){this.media=e.media,this._cleanTracks()}onMediaDetaching(){const e=this["captionsTracks"];Object.keys(e).forEach(t=>{Le(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Hn(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){var t=this["media"];if(t){var e=t.textTracks;if(e)for(let t=0;t<e.length;t++)Le(e[t])}}onSubtitleTracksUpdated(t,e){var e=e.subtitleTracks||[],r=e.some(t=>t.textCodec===On);if(this.config.enableWebVTT||r&&this.config.enableIMSC1)if(Yi(this.tracks,e))this.tracks=e;else if(this.textTracks=[],this.tracks=e,this.config.renderTextTracksNatively){const s=this.media?this.media.textTracks:null;this.tracks.forEach((r,t)=>{let i;if(s&&t<s.length){let e=null;for(let t=0;t<s.length;t++)if(n=s[t],a=r,n&&n.label===a.name&&!n.textTrack1&&!n.textTrack2){e=s[t];break}e&&(i=e)}var n,a;i?Le(i):(t=this._captionsOrSubtitlesFromCharacteristics(r),(i=this.createTextTrack(t,r.name,r.lang))&&(i.mode="disabled")),i&&(i.groupId=r.groupId,this.textTracks.push(i))})}else this.tracks.length&&(r=this.tracks.map(t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t})),this.hls.trigger($.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:r}))}_captionsOrSubtitlesFromCharacteristics(t){if(t.attrs.CHARACTERISTICS){var e=/transcribes-spoken-dialog/gi.test(t.attrs.CHARACTERISTICS),t=/describes-music-and-sound/gi.test(t.attrs.CHARACTERISTICS);if(e&&t)return"captions"}return"subtitles"}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(t=>{var e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);e&&(e="textTrack"+e[1],e=this.captionsProperties[e])&&(e.label=t.name,t.lang&&(e.languageCode=t.lang),e.media=t)})}closedCaptionsForLevel(t){t=this.hls.levels[t.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){var r,{cea608Parser1:i,cea608Parser2:n,lastSn:a,lastPartIndex:s}=this;this.enabled&&i&&n&&e.frag.type===A&&(r=e.frag.sn,e=null!=(e=null==e||null==(e=e.part)?void 0:e.index)?e:-1,r===a+1||r===a&&e===s+1||(i.reset(),n.reset()),this.lastSn=r,this.lastPartIndex=e)}onFragLoaded(t,e){var r,i,{frag:n,payload:a}=e;n.type===Ee&&(a.byteLength?(r=n.decryptdata,i="stats"in e,null!=r&&r.encrypted&&!i||(r=this.tracks[n.level],(i=this.vttCCs)[n.cc]||(i[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),r&&r.textCodec===On?this._parseIMSC1(n,a):this._parseVTTs(e))):this.hls.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")}))}_parseIMSC1(e,t){const r=this.hls;Bn(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),r.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{V.log("Failed to parse IMSC1: "+t),r.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(r){var t;const{frag:i,payload:n}=r,{initPTS:e,unparsedVttFrags:a}=this,s=e.length-1;if(e[i.cc]||-1!=s){const o=this.hls;xn(null!=(t=i.initSegment)&&t.data?Vt(i.initSegment.data,new Uint8Array(n)):n,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,t=>{this._appendCues(t,i.level),o.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},t=>{var e="Missing initPTS for VTT MPEGTS"===t.message;e?a.push(r):this._fallbackToIMSC1(i,n),V.log("Failed to parse VTT cue: "+t),e&&s>i.cc||o.trigger($.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t})})}else a.push(r)}_fallbackToIMSC1(t,e){const r=this.tracks[t.level];r.textCodec||Bn(e,this.initPTS[t.cc],()=>{r.textCodec=On,this._parseIMSC1(t,e)},()=>{r.textCodec="wvtt"})}_appendCues(t,e){var r=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[e];n&&"disabled"!==n.mode&&t.forEach(t=>Se(n,t))}else{var i=this.tracks[e];i&&(i=i.default?"default":"subtitles"+e,r.trigger($.CUES_PARSED,{type:"subtitles",cues:t,track:i}))}}onFragDecrypted(t,e){var r=e["frag"];r.type===Ee&&this.onFragLoaded($.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){var{cea608Parser1:r,cea608Parser2:i}=this;if(this.enabled&&r&&i){var{frag:e,samples:n}=e;if(e.type!==A||"NONE"!==this.closedCaptionsForLevel(e))for(let t=0;t<n.length;t++){var a=n[t].bytes;a&&(a=this.extractCea608Data(a),r.addData(n[t].pts,a[0]),i.addData(n[t].pts,a[1]))}}}onBufferFlushing(t,{startOffset:e,endOffset:r,endOffsetSubtitles:i,type:n}){var a=this["media"];if(a&&!(a.currentTime<r)){if(!n||"video"===n){const s=this["captionsTracks"];Object.keys(s).forEach(t=>ke(s[t],e,r))}if(this.config.renderTextTracksNatively&&0===e&&void 0!==i){const o=this["textTracks"];Object.keys(o).forEach(t=>ke(o[t],e,i))}}}extractCea608Data(e){var r=[[],[]],i=31&e[0];let n=2;for(let t=0;t<i;t++){var a=e[n++],s=127&e[n++],o=127&e[n++];0==s&&0==o||!(0!=(4&a))||0!=(a=3&a)&&1!=a||(r[a].push(s),r[a].push(o))}return r}},audioStreamController:class extends jr{constructor(t,e,r){super(t,e,r,"[audio-stream-controller]",_),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){var t=this["hls"];t.on($.MEDIA_ATTACHED,this.onMediaAttached,this),t.on($.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.LEVEL_LOADED,this.onLevelLoaded,this),t.on($.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on($.ERROR,this.onError,this),t.on($.BUFFER_RESET,this.onBufferReset,this),t.on($.BUFFER_CREATED,this.onBufferCreated,this),t.on($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on($.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){var t=this["hls"];t.off($.MEDIA_ATTACHED,this.onMediaAttached,this),t.off($.MEDIA_DETACHING,this.onMediaDetaching,this),t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.LEVEL_LOADED,this.onLevelLoaded,this),t.off($.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off($.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off($.ERROR,this.onError,this),t.off($.BUFFER_RESET,this.onBufferReset,this),t.off($.BUFFER_CREATED,this.onBufferCreated,this),t.off($.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off($.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off($.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:e,id:r,initPTS:i,timescale:n}){"main"===r&&(r=e.cc,this.initPTS[e.cc]={baseTime:i,timescale:n},this.log(`InitPTS for cc: ${r} found from main: `+i),this.videoTrackCC=r,this.state===L.WAITING_INIT_PTS)&&this.tick()}startLoad(t){var e;this.levels?(e=this.lastCurrentTime,this.stopLoad(),this.setInterval(100),0<e&&-1===t?(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e,this.state=L.IDLE):(this.loadedmetadata=!1,this.state=L.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()):(this.startPosition=t,this.state=L.STOPPED)}doTick(){switch(this.state){case L.IDLE:this.doTickIdle();break;case L.WAITING_TRACK:var{levels:t,trackId:e}=this,e=null==t||null==(t=t[e])?void 0:t.details;if(e){if(this.waitForCdnTuneIn(e))break;this.state=L.WAITING_INIT_PTS}break;case L.FRAG_LOADING_WAITING_RETRY:t=performance.now(),e=this.retryDate;(!e||e<=t||null!=(e=this.media)&&e.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=L.IDLE);break;case L.WAITING_INIT_PTS:var r,i,t=this.waitingData;t?({frag:e,part:t,cache:r,complete:i}=t,void 0!==this.initPTS[e.cc]?(this.waitingData=null,this.waitingVideoCC=-1,this.state=L.FRAG_LOADING,t={frag:e,part:t,payload:r.flush(),networkDetails:null},this._handleFragmentLoadProgress(t),i&&super._handleFragmentLoadComplete(t)):this.videoTrackCC!==this.waitingVideoCC?(this.log(`Waiting fragment cc (${e.cc}) cancelled because video is at cc `+this.videoTrackCC),this.clearWaitingFragment()):(r=this.getLoadPosition(),rr((i=S.bufferInfo(this.mediaBuffer,r,this.config.maxBufferHole)).end,this.config.maxFragLookUpTolerance,e)<0&&(this.log(`Waiting fragment cc (${e.cc}) @ ${e.start} cancelled because another fragment at ${i.end} is needed`),this.clearWaitingFragment()))):this.state=L.IDLE}this.onTickEnd()}clearWaitingFragment(){var t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=L.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){var t=this["media"];null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var{hls:i,levels:n,media:a,trackId:s}=this,o=i.config;if(null!=n&&n[s]&&(a||!this.startFragRequested&&o.startFragPrefetch)){o=n[s],n=o.details;if(!n||n.live&&this.levelLastLoaded!==s||this.waitForCdnTuneIn(n))this.state=L.WAITING_TRACK;else{s=this.mediaBuffer||this.media,s=(this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,y,_)),this.getFwdBufferInfo(s,_));if(null!==s){var{bufferedTrack:l,switchingTrack:u}=this;if(!u&&this._streamEnded(s,n))i.trigger($.BUFFER_EOS,{type:"audio"}),this.state=L.ENDED;else{var i=this.getFwdBufferInfo(this.videoBuffer||this.media,A),h=s.len,c=this.getMaxBufferLength(null==i?void 0:i.len);if(!(c<=h)||u){var d,h=n.fragments[0].start;let t=s.end,e=(u&&a&&(d=this.getLoadPosition(),l&&u.attrs!==l.attrs&&(t=d),n.PTSKnown)&&d<h&&(s.end>h||s.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=h+.05),this.getNextFragment(t,n)),r=!1;if(e&&this.isLoopLoading(e,t)&&(r=!!e.gap,e=this.getNextFragmentLoopLoading(e,n,s,A,c)),e){u=i&&e.start>i.end+n.targetduration;if(u||(null==i||!i.len)&&s.len){l=this.getAppendedFrag(e.start,A);if(null===l)return;if(r=r||!!l.gap||!!u&&0===i.len,u&&!r||r&&s.nextStart&&s.nextStart<l.end)return}this.loadFragment(e,o,t)}else this.bufferFlushed=!0}}}}}}getMaxBufferLength(t){var e=super.getMaxBufferLength();return t?Math.min(Math.max(e,t),this.config.maxMaxBufferLength):e}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map(t=>new je(t))}onAudioTrackSwitching(t,e){var r=!!e.url,i=(this.trackId=e.id,this)["fragCurrent"];i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),r?this.setInterval(100):this.resetTransmuxer(),r?(this.switchingTrack=e,this.state=L.IDLE):(this.switchingTrack=null,this.bufferedTrack=e,this.state=L.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,e){this.mainDetails=e.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger($.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,e){if(null==this.mainDetails)this.cachedTrackLoadedData=e;else{var r=this["levels"],{details:e,id:i}=e;if(r){this.log(`Track ${i} loaded [${e.startSN},${e.endSN}]${e.lastPartSn?`[part-${e.lastPartSn}-${e.lastPartIndex}]`:""},duration:`+e.totalduration);r=r[i];let t=0;if(e.live||null!=(n=r.details)&&n.live){var n=this.mainDetails;if(e.fragments[0]||(e.deltaUpdateFailed=!0),e.deltaUpdateFailed||!n)return;t=!r.details&&e.hasProgramDateTime&&n.hasProgramDateTime?(Or(e,n),e.fragments[0].start):this.alignPlaylists(e,r.details)}r.details=e,this.levelLastLoaded=i,this.startFragRequested||!this.mainDetails&&e.live||this.setStartPosition(r.details,t),this.state!==L.WAITING_TRACK||this.waitForCdnTuneIn(e)||(this.state=L.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+i)}}_handleFragmentLoadProgress(e){var{frag:e,part:r,payload:i}=e,{config:n,trackId:a,levels:s}=this;if(s){s=s[a];if(s){var o=s.details;if(o){n=n.defaultAudioCodec||s.audioCodec||"mp4a.40.2";let t=this.transmuxer;t=t||(this.transmuxer=new Gi(this.hls,_,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var l,u,s=this.initPTS[e.cc],h=null==(h=e.initSegment)?void 0:h.data;void 0!==s?(u=-1!==(l=r?r.index:-1),l=new wr(e.level,e.sn,e.stats.chunkCount,i.byteLength,l,u),t.push(i,h,n,"",e,r,o.totalduration,!1,l,s)):(this.log(`Unknown video PTS for cc ${e.cc}, waiting for video PTS before demuxing audio frag ${e.sn} of [${o.startSN} ,${o.endSN}],track `+a),u=(this.waitingData=this.waitingData||{frag:e,part:r,cache:new Wi,complete:!1})["cache"],u.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=L.WAITING_INIT_PTS)}else this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(e.start)}else this.warn("Audio track is undefined on fragment load progress")}else this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${e.sn} of level ${e.level} will not be buffered`)}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,e){var r=e.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer||null)}onFragBuffered(t,e){var r,{frag:e,part:i}=e;e.type!==_?this.loadedmetadata||e.type!==A||(r=this.videoBuffer||this.media)&&S.getBuffered(r).length&&(this.loadedmetadata=!0):this.fragContextChanged(e)?this.warn(`Fragment ${e.sn}${i?" p: "+i.index:""} of level ${e.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: `+(this.switchingTrack?this.switchingTrack.name:"false")):("initSegment"!==e.sn&&(this.fragPrevious=e,r=this.switchingTrack)&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger($.AUDIO_TRACK_SWITCHED,f({},r))),this.fragBufferedComplete(e,i))}onError(t,e){var r;if(e.fatal)this.state=L.ERROR;else switch(e.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(_,e);break;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==L.WAITING_TRACK||(null==(r=e.context)?void 0:r.type)!==E||(this.state=L.IDLE);break;case H.BUFFER_FULL_ERROR:e.parent&&"audio"===e.parent&&this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushed(t,{type:e}){e===y&&(this.bufferFlushed=!0,this.state===L.ENDED)&&(this.state=L.IDLE)}_handleTransmuxComplete(t){var e,r,i,n,a,s,o,l,u=this["hls"],{remuxResult:t,chunkMeta:h}=t,c=this.getCurrentContext(h);c?({frag:c,part:e,level:r}=c,r=r.details,{audio:t,text:i,id3:n,initSegment:o}=t,this.fragContextChanged(c)||!r?this.fragmentTracker.removeFragment(c):(this.state=L.PARSING,this.switchingTrack&&t&&this.completeAudioSwitch(this.switchingTrack),null!=o&&o.tracks&&(a=c.initSegment||c,this._bufferInitSegment(o.tracks,a,h),u.trigger($.FRAG_PARSING_INIT_SEGMENT,{frag:a,id:"audio",tracks:o.tracks})),t&&({startPTS:a,endPTS:o,startDTS:l,endDTS:s}=t,e&&(e.elementaryStreams[y]={startPTS:a,endPTS:o,startDTS:l,endDTS:s}),c.setElementaryStreamInfo(y,a,o,l,s),this.bufferFragmentData(t,c,e,h)),null!=n&&null!=(a=n.samples)&&a.length&&(o=G({id:"audio",frag:c,details:r},n),u.trigger($.FRAG_PARSING_METADATA,o)),i&&(l=G({id:"audio",frag:c,details:r},i),u.trigger($.FRAG_PARSING_USERDATA,l)))):this.resetWhenMissingContext(h)}_bufferInitSegment(t,e,r){var i;this.state===L.PARSING&&(t.video&&delete t.video,i=t.audio)&&(i.levelCodec=i.codec,i.id="audio",this.log(`Init audio buffer, container:${i.container}, codecs[parsed]=[${i.codec}]`),this.hls.trigger($.BUFFER_CODECS,t),null!=(t=i.initSegment)&&t.byteLength&&(i={type:"audio",frag:e,part:null,chunkMeta:r,parent:e.type,data:t},this.hls.trigger($.BUFFER_APPENDING,i)),this.tick())}loadFragment(t,e,r){var i=this.fragmentTracker.getState(t);this.fragCurrent=t,this.switchingTrack||i===pr||i===vr?"initSegment"===t.sn?this._loadInitSegment(t,e):null!=(i=e.details)&&i.live&&!this.initPTS[t.cc]?(this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level `+this.trackId),this.state=L.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(t,e,r)):this.clearTrackerIfNeeded(t)}completeAudioSwitch(t){var{hls:e,media:r,bufferedTrack:i}=this,i=null==i?void 0:i.attrs,n=t.attrs;r&&i&&(i.CHANNELS!==n.CHANNELS||i.NAME!==n.NAME||i.LANGUAGE!==n.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=t,this.switchingTrack=null,e.trigger($.AUDIO_TRACK_SWITCHED,f({},t))}},audioTrackController:class extends ur{constructor(t){super(t,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){var t=this["hls"];t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.LEVEL_LOADING,this.onLevelLoading,this),t.on($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this["hls"];t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.LEVEL_LOADING,this.onLevelLoading,this),t.off($.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off($.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off($.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){var r,{id:i,groupId:n,details:a}=e,s=this.tracksInGroup[i];s&&s.groupId===n?(r=s.details,s.details=e.details,this.log(`audio-track ${i} "${s.name}" lang:${s.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,e,r)):this.warn(`Track with id:${i} and group:${n} not found in active group `+s.groupId)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){var e,t=this.hls.levels[t];if(null!=t&&t.audioGroupIds){const r=t.audioGroupIds[t.urlId];this.groupId!==r?(this.groupId=r||null,t=this.tracks.filter(t=>!r||t.groupId===r),this.selectDefaultTrack&&!t.some(t=>t.default)&&(this.selectDefaultTrack=!1),e={audioTracks:this.tracksInGroup=t},this.log(`Updating audio tracks, ${t.length} track(s) found in group:`+r),this.hls.trigger($.AUDIO_TRACKS_UPDATED,e),this.selectInitialTrack()):this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}}onError(t,e){!e.fatal&&e.context&&e.context.type===E&&e.context.id===this.trackId&&e.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(e))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioTrack(t){var e,r,i,n=this.tracksInGroup;t<0||t>=n.length?this.warn("Invalid id passed to audio-track controller"):(this.clearTimer(),e=this.currentTrack,n[this.trackId],{groupId:r,name:i}=n=n[t],this.log(`Switching to audio-track ${t} "${i}" lang:${n.lang} group:`+r),this.trackId=t,this.currentTrack=n,this.selectDefaultTrack=!1,this.hls.trigger($.AUDIO_TRACK_SWITCHING,f({},n)),n.details&&!n.details.live||(i=this.switchParams(n.url,null==e?void 0:e.details),this.loadPlaylist(i)))}selectInitialTrack(){var t=this.tracksInGroup,e=this.findTrackId(this.currentTrack)|this.findTrackId(null);-1!=e?this.setAudioTrack(e):(e=new Error(`No track found for running audio group-ID: ${this.groupId} track count: `+t.length),this.warn(e.message),this.hls.trigger($.ERROR,{type:K.MEDIA_ERROR,details:H.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e}))}findTrackId(e){var r=this.tracksInGroup;for(let t=0;t<r.length;t++){var i=r[t];if(!this.selectDefaultTrack||i.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===i.attrs["STABLE-RENDITION-ID"])return i.id;if(e.name===i.name&&e.lang===i.lang)return i.id}}return-1}loadPlaylist(e){super.loadPlaylist();var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var i=r.id,n=r.groupId;let t=r.url;if(e)try{t=e.addDirectives(t)}catch(t){this.warn("Could not construct new URL with HLS Delivery Directives: "+t)}this.log(`loading audio-track playlist ${i} "${r.name}" lang:${r.lang} group:`+n),this.clearTimer(),this.hls.trigger($.AUDIO_TRACK_LOADING,{url:t,id:i,groupId:n,deliveryDirectives:e||null})}}},emeController:Yn,cmcdController:ta,contentSteeringController:class{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=V.log.bind(V,"[content-steering]:"),this.registerListeners()}registerListeners(){var t=this.hls;t.on($.MANIFEST_LOADING,this.onManifestLoading,this),t.on($.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($.MANIFEST_PARSED,this.onManifestParsed,this),t.on($.ERROR,this.onError,this)}unregisterListeners(){var t=this.hls;t&&(t.off($.MANIFEST_LOADING,this.onManifestLoading,this),t.off($.MANIFEST_LOADED,this.onManifestLoaded,this),t.off($.MANIFEST_PARSED,this.onManifestParsed,this),t.off($.ERROR,this.onError,this))}startLoad(){var t;this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri&&(this.updated?(t=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0),this.scheduleRefresh(this.uri,t)):this.loadSteeringManifest(this.uri))}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){var t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){e=e.contentSteering;null!==e&&(this.pathwayId=e.pathwayId,this.uri=e.uri,this.started)&&this.startLoad()}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){e=e.errorAction;if((null==e?void 0:e.action)===nr&&e.flags===or){let t=this.pathwayPriority;var r=this.pathwayId;this.penalizedPathways[r]||(this.penalizedPathways[r]=performance.now()),(t=!t&&this.levels?this.levels.reduce((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t),[]):t)&&1<t.length&&(this.updatePathwayPriority(t),e.resolved=this.pathwayId!==r)}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);var r;return 0===e.length&&(r=t[0].pathwayId,this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),e=this.getLevelsForPathway(r),this.pathwayId=r),e.length!==t.length?(this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e):t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;const r=this.penalizedPathways,i=performance.now();Object.keys(r).forEach(t=>{3e5<i-r[t]&&delete r[t]});for(let t=0;t<e.length;t++){var n=e[t];if(!r[n]){if(n===this.pathwayId)return;var a,s=this.hls.nextLoadLevel,o=this.hls.levels[s];if(0<(a=this.getLevelsForPathway(n)).length){this.log(`Setting Pathway to "${n}"`),this.pathwayId=n,this.hls.trigger($.LEVELS_UPDATED,{levels:a});n=this.hls.levels[s];o&&n&&this.levels&&(n.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&n.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to `+n.bitrate),this.hls.nextLoadLevel=s);break}}}}clonePathways(t){const r=this.levels;if(r){const s={},o={};t.forEach(t=>{const{ID:n,"BASE-ID":e,"URI-REPLACEMENT":a}=t;r.some(t=>t.pathwayId===n)||(t=this.getLevelsForPathway(e).map(t=>{var e=G({},t),t=(e.details=void 0,e.url=ra(t.uri,t.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",a),new B(t.attrs)),r=(t["PATHWAY-ID"]=n,t.AUDIO&&t.AUDIO+"_clone_"+n),i=t.SUBTITLES&&t.SUBTITLES+"_clone_"+n,t=(r&&(s[t.AUDIO]=r,t.AUDIO=r),i&&(o[t.SUBTITLES]=i,t.SUBTITLES=i),e.attrs=t,new je(e));return dr(t,"audio",r),dr(t,"text",i),t}),r.push(...t),ea(this.audioTracks,s,a,n),ea(this.subtitleTracks,o,a,n))})}}loadSteeringManifest(e){var t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let s;try{s=new self.URL(e)}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}"data:"!==s.protocol&&(r=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate),s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+r));e={responseType:"json",url:s.href},r=t.steeringManifestLoadPolicy.default,t=r.errorRetry||r.timeoutRetry||{},r={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:t.maxNumRetry||0,retryDelay:t.retryDelayMs||0,maxRetryDelay:t.maxRetryDelayMs||0},t={onSuccess:(e,t,r,i)=>{this.log(`Loaded steering manifest: "${s}"`);e=e.data;if(1!==e.VERSION)this.log(`Steering VERSION ${e.VERSION} not supported!`);else{this.updated=performance.now(),this.timeToLoad=e.TTL;var{"RELOAD-URI":e,"PATHWAY-CLONES":n,"PATHWAY-PRIORITY":a}=e;if(e)try{this.uri=new self.URL(e,s).href}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: "+e)}this.scheduleRefresh(this.uri||r.url),n&&this.clonePathways(n),a&&this.updatePathwayPriority(a)}},onError:(e,r,t,i)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${r.url})`),this.stopLoad(),410===e.code)this.enabled=!1,this.log(`Steering manifest ${r.url} no longer available`);else{let t=1e3*this.timeToLoad;429===e.code?("function"==typeof(null==(e=this.loader)?void 0:e.getResponseHeader)&&(e=e.getResponseHeader("Retry-After"))&&(t=1e3*parseFloat(e)),this.log(`Steering manifest ${r.url} rate limited`)):this.scheduleRefresh(this.uri||r.url,t)}},onTimeout:(t,e,r)=>{this.log(`Timeout loading steering manifest (${e.url})`),this.scheduleRefresh(this.uri||e.url)}};this.log("Requesting steering manifest: "+s),this.loader.load(e,r,t)}scheduleRefresh(t,e=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(t)},e)}}});function da(r){return r&&"object"==typeof r?Array.isArray(r)?r.map(da):Object.keys(r).reduce((t,e)=>(t[e]=da(r[e]),t),{}):r}function fa(t){var e=t.loader;e!==sa&&e!==na?(V.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1}()&&(t.loader=sa,t.progressive=!0,t.enableSoftwareAES=!0,V.log("[config]: Progressive streaming enabled, using FetchLoader"))}class C{static get version(){return"1.4.10"}static isSupported(){return!!(e=re())&&(t=Gr(),e=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove,!!e)&&!!t;var t,e}static get Events(){return $}static get ErrorTypes(){return K}static get ErrorDetails(){return H}static get DefaultConfig(){return C.defaultConfig||ca}static set DefaultConfig(t){C.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ui,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var e=t.debug||!1,r="Hls instance";if(self.console&&!0===e||"object"==typeof e){et(e,"debug","log","info","warn","error");try{tt.log(`Debug logs enabled for "${r}" in hls.js version 1.4.10`)}catch(t){tt=Z}}else tt=Z;var e=this.config=function(t,l){if((l.liveSyncDurationCount||l.liveMaxLatencyDurationCount)&&(l.liveSyncDuration||l.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==l.liveMaxLatencyDurationCount&&(void 0===l.liveSyncDurationCount||l.liveMaxLatencyDurationCount<=l.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==l.liveMaxLatencyDuration&&(void 0===l.liveSyncDuration||l.liveMaxLatencyDuration<=l.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const u=da(t),e=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(n=>{const a=`${"level"===n?"playlist":n}LoadPolicy`,s=void 0===l[a],o=[];e.forEach(t=>{var e=n+"Loading"+t,r=l[e];if(void 0!==r&&s){o.push(e);var i=u[a].default;switch(l[a]={default:i},t){case"TimeOut":i.maxLoadTimeMs=r,i.maxTimeToFirstByteMs=r;break;case"MaxRetry":i.errorRetry.maxNumRetry=r,i.timeoutRetry.maxNumRetry=r;break;case"RetryDelay":i.errorRetry.retryDelayMs=r,i.timeoutRetry.retryDelayMs=r;break;case"MaxRetryTimeout":i.errorRetry.maxRetryDelayMs=r,i.timeoutRetry.maxRetryDelayMs=r}}}),o.length&&V.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${a}": `+JSON.stringify(l[a]))}),f(f({},u),l)}(C.DefaultConfig,t),{abrController:r,bufferController:t,capLevelController:i,errorController:n,fpsController:a}=(this.userConfig=t,this._autoLevelCapping=-1,e.progressive&&fa(e),e),n=new n(this),r=this.abrController=new r(this),t=this.bufferController=new t(this),i=this.capLevelController=new i(this),a=new a(this),s=new Ae(this),o=new xe(this),l=e.contentSteeringController,l=l?new l(this):null,u=this.levelController=new cr(this,l),h=new yr(this),c=new kr(this.config),d=this.streamController=new Ki(this,h,c),s=(i.setStreamController(d),a.setStreamController(d),[s,u,d]),u=(l&&s.splice(1,0,l),this.networkControllers=s,[r,t,i,a,o,h]),d=(this.audioTrackController=this.createController(e.audioTrackController,s),e.audioStreamController),l=(d&&s.push(new d(this,h,c)),this.subtitleTrackController=this.createController(e.subtitleTrackController,s),e.subtitleStreamController),r=(l&&s.push(new l(this,h,c)),this.createController(e.timelineController,u),c.emeController=this.emeController=this.createController(e.emeController,u),this.cmcdController=this.createController(e.cmcdController,u),this.latencyController=this.createController(Oe,u),this.coreComponents=u,s.push(n),n.onErrorOut);"function"==typeof r&&this.on($.ERROR,r,n)}createController(t,e){return t?(t=new t(this),e&&e.push(t),t):null}on(t,e,r=this){this._emitter.on(t,e,r)}once(t,e,r=this){this._emitter.once(t,e,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,r=this,i){this._emitter.off(t,e,r,i)}listeners(t){return this._emitter.listeners(t)}emit(t,e,r){return this._emitter.emit(t,e,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){V.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger($.ERROR,{type:K.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){V.log("destroy"),this.trigger($.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;var t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){V.log("attachMedia"),this._media=t,this.trigger($.MEDIA_ATTACHING,{media:t})}detachMedia(){V.log("detachMedia"),this.trigger($.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();var e=this.media,r=this.url,i=this.url=Q.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});V.log("loadSource:"+i),e&&r&&(r!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger($.MANIFEST_LOADING,{url:t})}startLoad(e=-1){V.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){V.log("stopLoad"),this.networkControllers.forEach(t=>{t.stopLoad()})}swapAudioCodec(){V.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){V.log("recoverMediaError");var t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,e=0){this.levelController.removeLevel(t,e)}get levels(){var t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){V.log("set currentLevel:"+t),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){V.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){V.log("set loadLevel:"+t),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){V.log("set firstLevel:"+t),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){V.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){t=!!t;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){var t=this.abrController["bwEstimator"];return t?t.getEstimate():NaN}get ttfbEstimate(){var t=this.abrController["bwEstimator"];return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(V.log("set autoLevelCapping:"+t),this._autoLevelCapping=t)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){-1<Me.indexOf(t)&&(this._maxHdcpLevel=t)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){var{levels:e,config:{minAutoBitrate:r}}=this;if(e){var i=e.length;for(let t=0;t<i;t++)if(e[t].maxBitrate>=r)return t}return 0}get maxAutoLevel(){var{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let i;if(i=-1===t&&e&&e.length?e.length-1:t,r)for(let t=i;t--;){var n=e[t].attrs["HDCP-LEVEL"];if(n&&n<=r)return t}return i}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){var t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){var t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}get subtitleTracks(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}function pa(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function ga(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(r),!0).forEach(function(t){n()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pa(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function va(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=O()(r);return t=i?(t=O()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),x()(this,t)}}C.defaultConfig=void 0;var ma=u.f.now,ya=u.f.assign,Ea=u.f.listContainsIgnoreCase,Ta=(u.a.register("PLAYBACK_FRAGMENT_CHANGED"),u.a.register("PLAYBACK_FRAGMENT_PARSING_METADATA"),function(t){P()(a,t);var n=va(a);function a(){var t;o()(this,a);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=n.call.apply(n,[this].concat(r))).options.playback=ga(ga({},t.options),t.options.playback),t.options.hlsPlayback=ga(ga({},t.defaultOptions),t.options.hlsPlayback),t._minDvrSize=void 0===t.options.hlsMinimumDvrSize?60:t.options.hlsMinimumDvrSize,t._extrapolatedWindowNumSegments=t.options.playback&&void 0!==t.options.playback.extrapolatedWindowNumSegments?t.options.playback.extrapolatedWindowNumSegments:2,t._playbackType=u.d.VOD,t._lastTimeUpdate={current:0,total:0},t._lastDuration=null,t._playableRegionStartTime=0,t._localStartTimeCorrelation=null,t._localEndTimeCorrelation=null,t._playableRegionDuration=0,t._programDateTime=0,t._durationExcludesAfterLiveSyncPoint=!1,t._segmentTargetDuration=null,t._playlistType=null,t._recoverAttemptsRemaining=t.options.hlsRecoverAttempts||16,t}return l()(a,[{key:"name",get:function(){return"hls"}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(u.a.PLAYBACK_LEVEL_SWITCH_START),this.options.playback.hlsUseNextLevel?this._hls.nextLevel=this._currentLevel:this._hls.currentLevel=this._currentLevel}},{key:"isReady",get:function(){return this._isReadyState}},{key:"_startTime",get:function(){return this._playbackType===u.d.LIVE&&"EVENT"!==this._playlistType?this._extrapolatedStartTime:this._playableRegionStartTime}},{key:"_now",get:function(){return ma()}},{key:"_extrapolatedStartTime",get:function(){var t,e;return this._localStartTimeCorrelation?(e=this._localStartTimeCorrelation,t=this._now-e.local,e=(e.remote+t)/1e3,Math.min(e,this._playableRegionStartTime+this._extrapolatedWindowDuration)):this._playableRegionStartTime}},{key:"_extrapolatedEndTime",get:function(){var t,e,r=this._playableRegionStartTime+this._playableRegionDuration;return this._localEndTimeCorrelation?(e=this._localEndTimeCorrelation,t=this._now-e.local,e=(e.remote+t)/1e3,Math.max(r-this._extrapolatedWindowDuration,Math.min(e,r))):r}},{key:"_duration",get:function(){return this._extrapolatedEndTime-this._startTime}},{key:"_extrapolatedWindowDuration",get:function(){return null===this._segmentTargetDuration?0:this._extrapolatedWindowNumSegments*this._segmentTargetDuration}},{key:"bandwidthEstimate",get:function(){return this._hls&&this._hls.bandwidthEstimate}},{key:"defaultOptions",get:function(){return{preload:!1}}},{key:"customListeners",get:function(){return this.options.hlsPlayback&&this.options.hlsPlayback.customListeners||[]}},{key:"_setup",value:function(){var r=this;this._manifestParsed=!1,this._ccIsSetup=!1,this._ccTracksUpdated=!1,this._hls&&this._hls.destroy(),this._hls=new C(ya({},this.options.playback.hlsjsConfig)),this._hls.once(C.Events.MEDIA_ATTACHED,function(){r.options.hlsPlayback.preload&&r._hls.loadSource(r.options.src)}),this._hls.on(C.Events.MANIFEST_PARSED,function(){r._manifestParsed=!0}),this._hls.on(C.Events.LEVEL_LOADED,function(t,e){return r._updatePlaybackType(t,e)}),this._hls.on(C.Events.LEVEL_UPDATED,function(t,e){return r._onLevelUpdated(t,e)}),this._hls.on(C.Events.LEVEL_SWITCHING,function(t,e){return r._onLevelSwitch(t,e)}),this._hls.on(C.Events.FRAG_CHANGED,function(t,e){return r._onFragmentChanged(t,e)}),this._hls.on(C.Events.FRAG_LOADED,function(t,e){return r._onFragmentLoaded(t,e)}),this._hls.on(C.Events.FRAG_PARSING_METADATA,function(t,e){return r._onFragmentParsingMetadata(t,e)}),this._hls.on(C.Events.ERROR,function(t,e){return r._onHLSJSError(t,e)}),this._hls.on(C.Events.SUBTITLE_TRACK_LOADED,function(t,e){return r._onSubtitleLoaded(t,e)}),this._hls.on(C.Events.SUBTITLE_TRACKS_UPDATED,function(){return r._ccTracksUpdated=!0}),this.bindCustomListeners(),this.checkIfCritical(),this._hls.attachMedia(this.el)}},{key:"bindCustomListeners",value:function(){var i=this;this.customListeners.forEach(function(t){var e=t.eventName,r=t.once?"once":"on";e&&i._hls["".concat(r)](e,t.callback)})}},{key:"unbindCustomListeners",value:function(){var r=this;this.customListeners.forEach(function(t){var e=t.eventName;e&&r._hls.off(e,t.callback)})}},{key:"_onFragmentParsingMetadata",value:function(t,e){this.trigger(u.a.Custom.PLAYBACK_FRAGMENT_PARSING_METADATA,{evt:t,data:e})}},{key:"render",value:function(){return this._ready(),d()(O()(a.prototype),"render",this).call(this)}},{key:"_ready",value:function(){this._isReadyState||(this._hls||this._setup(),this._isReadyState=!0,this.trigger(u.a.PLAYBACK_READY,this.name))}},{key:"_recover",value:function(t,e,r){var i=this;this._recoveredDecodingError?this._recoveredAudioCodecError?(u.c.error("hlsjs: failed to recover",{evt:t,data:e}),r.level=u.e.Levels.FATAL,t=this.createError(r),this.trigger(u.a.PLAYBACK_ERROR,t),this.stop()):(this._recoveredAudioCodecError=!0,this._hls.swapAudioCodec(),this._hls.recoverMediaError(),this.$el[0].play().then(function(){i._recoveredAudioCodecError=!1})):(this._recoveredDecodingError=!0,this._hls.recoverMediaError(),this.$el[0].play())}},{key:"_setupSrc",value:function(t){}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer||(this._timeUpdateTimer=setInterval(function(){t._onDurationChange(),t._onTimeUpdate()},100))}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&(clearInterval(this._timeUpdateTimer),this._timeUpdateTimer=null)}},{key:"getProgramDateTime",value:function(){return this._programDateTime}},{key:"getDuration",value:function(){return this._duration}},{key:"getCurrentTime",value:function(){return Math.max(0,this.el.currentTime-this._startTime)}},{key:"getStartTimeOffset",value:function(){return this._startTime}},{key:"seekPercentage",value:function(t){var e=this._duration;0<t&&(e=this._duration*(t/100)),this.seek(e)}},{key:"seek",value:function(t){t<0&&(u.c.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this.getDuration()),this.dvrEnabled&&this._updateDvr(t<this.getDuration()-3),t+=this._startTime,this.el.currentTime=t}},{key:"seekToLivePoint",value:function(){this.seek(this.getDuration())}},{key:"_updateDvr",value:function(t){this.trigger(u.a.PLAYBACK_DVR,t),this.trigger(u.a.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"_updateSettings",value:function(){this._playbackType===u.d.VOD?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(u.a.PLAYBACK_SETTINGSUPDATE)}},{key:"_onHLSJSError",value:function(t,e){var r,i={code:"".concat(e.type,"_").concat(e.details),description:"".concat(this.name," error: type: ").concat(e.type,", details: ").concat(e.details),raw:e};if(e.response&&(i.description+=", response: ".concat(JSON.stringify(e.response))),e.fatal)if(0<this._recoverAttemptsRemaining)switch(--this._recoverAttemptsRemaining,e.type){case C.ErrorTypes.NETWORK_ERROR:switch(e.details){case C.ErrorDetails.MANIFEST_LOAD_ERROR:case C.ErrorDetails.MANIFEST_LOAD_TIMEOUT:case C.ErrorDetails.MANIFEST_PARSING_ERROR:case C.ErrorDetails.LEVEL_LOAD_ERROR:case C.ErrorDetails.LEVEL_LOAD_TIMEOUT:u.c.error("hlsjs: unrecoverable network fatal error.",{evt:t,data:e}),r=this.createError(i),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop();break;default:u.c.warn("hlsjs: trying to recover from network error.",{evt:t,data:e}),i.level=u.e.Levels.WARN,this._hls.startLoad()}break;case C.ErrorTypes.MEDIA_ERROR:u.c.warn("hlsjs: trying to recover from media error.",{evt:t,data:e}),i.level=u.e.Levels.WARN,this._recover(t,e,i);break;default:u.c.error("hlsjs: could not recover from error.",{evt:t,data:e}),r=this.createError(i),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop()}else u.c.error("hlsjs: could not recover from error after maximum number of attempts.",{evt:t,data:e}),r=this.createError(i),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop();else this.options.playback.triggerFatalErrorOnResourceDenied&&this._keyIsDenied(e)?(u.c.error("hlsjs: could not load decrypt key.",{evt:t,data:e}),r=this.createError(i),this.trigger(u.a.PLAYBACK_ERROR,r),this.stop()):(i.level=u.e.Levels.WARN,u.c.warn("hlsjs: non-fatal error occurred",{evt:t,data:e}))}},{key:"_keyIsDenied",value:function(t){return t.type===C.ErrorTypes.NETWORK_ERROR&&t.details===C.ErrorDetails.KEY_LOAD_ERROR&&t.response&&400<=t.response.code}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()};this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total||(this._lastTimeUpdate=t,this.trigger(u.a.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,d()(O()(a.prototype),"_onDurationChange",this).call(this))}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var t=[],e=0,r=0;r<this.el.buffered.length;r++)t=[].concat(s()(t),[{start:Math.max(0,this.el.buffered.start(r)-this._playableRegionStartTime),end:Math.max(0,this.el.buffered.end(r)-this._playableRegionStartTime)}]),this.el.currentTime>=t[r].start&&this.el.currentTime<=t[r].end&&(e=r);var i={start:t[e].start,current:t[e].end,total:this.getDuration()};this.trigger(u.a.PLAYBACK_PROGRESS,i,t)}}},{key:"play",value:function(){this._hls||this._setup(),this._manifestParsed||this.options.hlsPlayback.preload||this._hls.loadSource(this.options.src),d()(O()(a.prototype),"play",this).call(this),this._startTimeUpdateTimer()}},{key:"pause",value:function(){this._hls&&(this.el.pause(),this.dvrEnabled)&&this._updateDvr(!0)}},{key:"stop",value:function(){this._stopTimeUpdateTimer(),this._hls&&(d()(O()(a.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls)}},{key:"destroy",value:function(){this._stopTimeUpdateTimer(),this._hls&&(this._hls.destroy(),delete this._hls),d()(O()(a.prototype),"destroy",this).call(this)}},{key:"_updatePlaybackType",value:function(t,e){this._playbackType=e.details.live?u.d.LIVE:u.d.VOD,this._onLevelUpdated(t,e),this._ccTracksUpdated&&this._playbackType===u.d.LIVE&&this.hasClosedCaptionsTracks&&this._onSubtitleLoaded()}},{key:"_fillLevels",value:function(){this._levels=this._hls.levels.map(function(t,e){return{id:e,level:t,label:"".concat(t.bitrate/1e3,"Kbps")}}),this.trigger(u.a.PLAYBACK_LEVELS_AVAILABLE,this._levels)}},{key:"_onLevelUpdated",value:function(t,e){this._segmentTargetDuration=e.details.targetduration,this._playlistType=e.details.type||null;var r,i,n=!1,a=!1,s=e.details.fragments,o=this._playableRegionStartTime,l=this._playableRegionDuration;0!==s.length&&(s[0].rawProgramDateTime&&(this._programDateTime=s[0].rawProgramDateTime),this._playableRegionStartTime!==s[0].start&&(n=!0,this._playableRegionStartTime=s[0].start),n&&(this._localStartTimeCorrelation?(r=this._localStartTimeCorrelation,i=this._now-r.local,(r=(r.remote+i)/1e3)<s[0].start?this._localStartTimeCorrelation={local:this._now,remote:1e3*s[0].start}:r>o+this._extrapolatedWindowDuration&&(this._localStartTimeCorrelation={local:this._now,remote:1e3*Math.max(s[0].start,o+this._extrapolatedWindowDuration)})):this._localStartTimeCorrelation={local:this._now,remote:1e3*(s[0].start+this._extrapolatedWindowDuration/2)}),i=e.details.totalduration,this._playbackType===u.d.LIVE&&((r=e.details.targetduration*((this.options.playback.hlsjsConfig||{}).liveSyncDurationCount||C.DefaultConfig.liveSyncDurationCount))<=i?(i-=r,this._durationExcludesAfterLiveSyncPoint=!0):this._durationExcludesAfterLiveSyncPoint=!1),i!==this._playableRegionDuration&&(a=!0,this._playableRegionDuration=i),(e=s[0].start+i)!==(r=o+l)&&(!this._localEndTimeCorrelation||(s=this._localEndTimeCorrelation,i=this._now-s.local,e<(o=(s.remote+i)/1e3))?this._localEndTimeCorrelation={local:this._now,remote:1e3*e}:o<e-this._extrapolatedWindowDuration?this._localEndTimeCorrelation={local:this._now,remote:1e3*(e-this._extrapolatedWindowDuration)}:r<o&&(this._localEndTimeCorrelation={local:this._now,remote:1e3*r})),a&&this._onDurationChange(),n)&&this._onProgress()}},{key:"_onFragmentChanged",value:function(t,e){var r=this.options.onTagCallback;r&&r(e.frag.tagList),this.trigger(u.a.Custom.PLAYBACK_FRAGMENT_CHANGED,e)}},{key:"_onFragmentLoaded",value:function(t,e){this.trigger(u.a.PLAYBACK_FRAGMENT_LOADED,e)}},{key:"_onSubtitleLoaded",value:function(){var t;this._ccIsSetup||(this.trigger(u.a.PLAYBACK_SUBTITLE_AVAILABLE),t=this._playbackType===u.d.LIVE?-1:this.closedCaptionsTrackId,this.closedCaptionsTrackId=t,this._ccIsSetup=!0)}},{key:"_onLevelSwitch",value:function(t,e){this.levels.length||this._fillLevels(),this.trigger(u.a.PLAYBACK_LEVEL_SWITCH_END),this.trigger(u.a.PLAYBACK_LEVEL_SWITCH,e);var r=this._hls.levels[e.level];r&&(this.highDefinition=720<=r.height||2e3<=r.bitrate/1e3,this.trigger(u.a.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(u.a.PLAYBACK_BITRATE,{height:r.height,width:r.width,bandwidth:r.bitrate,bitrate:r.bitrate,level:e.level}))}},{key:"dvrEnabled",get:function(){return this._durationExcludesAfterLiveSyncPoint&&this._duration>=this._minDvrSize&&this.getPlaybackType()===u.d.LIVE}},{key:"getPlaybackType",value:function(){return this._playbackType}},{key:"isSeekEnabled",value:function(){return this._playbackType===u.d.VOD||this.dvrEnabled}},{key:"checkIfCritical",value:function(){var r=this;this._options.mediaInfo.then(function(t){var e=t.criticalError,t=t.errorCodec;e&&(r._isReadyState=!1,r.stop(),r.trigger(u.a.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}}),r._hls)&&r._hls.destroy()})}}],[{key:"HLSJS",get:function(){return C}}]),a}(u.b));Ta.canPlay=function(t,e){t=t.split("?")[0].match(/.*\.(.*)$/)||[],t=1<t.length&&"m3u8"===t[1].toLowerCase()||Ea(e,["application/vnd.apple.mpegurl","application/x-mpegURL"]);return!(!C.isSupported()||!t)}},function(t,e){var r,i,t=t.exports={};function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:n}catch(t){r=n}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===n||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var o,l=[],u=!1,h=-1;function c(){u&&o&&(u=!1,o.length?l=o.concat(l):h=-1,l.length)&&d()}function d(){if(!u){for(var t=s(c),e=(u=!0,l.length);e;){for(o=l,l=[];++h<e;)o&&o[h].run();h=-1,e=l.length}o=null,u=!1,!function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return(i=clearTimeout)(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var i,d=SyntaxError,n=Function,f=TypeError,a=function(t){try{return n('"use strict"; return ('+t+").constructor;")()}catch(t){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(t){p=null}function s(){throw new f}var o=p?function(){try{return s}catch(t){try{return p(arguments,"callee").get}catch(t){return s}}}():s,l=r(365)(),u=r(367)(),h=Object.getPrototypeOf||(u?function(t){return t.__proto__}:null),g={},u="undefined"!=typeof Uint8Array&&h?h(Uint8Array):i,v={"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":l&&h?h([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":g,"%AsyncGenerator%":g,"%AsyncGeneratorFunction%":g,"%AsyncIteratorPrototype%":g,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?i:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":n,"%GeneratorFunction%":g,"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l&&h?h(h([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l&&h?h((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l&&h?h((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l&&h?h(""[Symbol.iterator]()):i,"%Symbol%":l?Symbol:i,"%SyntaxError%":d,"%ThrowTypeError%":o,"%TypedArray%":u,"%TypeError%":f,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet};if(h)try{null.error}catch(t){l=h(h(t));v["%Error.prototype%"]=l}function m(t){var e,r;return"%AsyncFunction%"===t?e=a("async function () {}"):"%GeneratorFunction%"===t?e=a("function* () {}"):"%AsyncGeneratorFunction%"===t?e=a("async function* () {}"):"%AsyncGenerator%"===t?(r=m("%AsyncGeneratorFunction%"))&&(e=r.prototype):"%AsyncIteratorPrototype%"===t&&(r=m("%AsyncGenerator%"))&&h&&(e=h(r.prototype)),v[t]=e}var y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},o=r(118),E=r(369),T=o.call(Function.call,Array.prototype.concat),b=o.call(Function.apply,Array.prototype.splice),A=o.call(Function.call,String.prototype.replace),_=o.call(Function.call,String.prototype.slice),S=o.call(Function.call,RegExp.prototype.exec),L=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g;t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new f("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof e)throw new f('"allowMissing" argument must be a boolean');if(null===S(/^%?[^%]*%?$/,t))throw new d("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(t){var e=_(t,0,1),r=_(t,-1);if("%"===e&&"%"!==r)throw new d("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new d("invalid intrinsic syntax, expected opening `%`");var n=[];return A(t,L,function(t,e,r,i){n[n.length]=r?A(i,k,"$1"):e||t}),n}(t),i=0<r.length?r[0]:"",n=function(t,e){var r,i=t;if(E(y,i)&&(i="%"+(r=y[i])[0]+"%"),E(v,i)){var n=v[i];if(void 0!==(n=n===g?m(i):n)||e)return{alias:r,name:i,value:n};throw new f("intrinsic "+t+" exists, but is not available. Please file an issue!")}throw new d("intrinsic "+t+" does not exist!")}("%"+i+"%",e),a=(n.name,n.value),s=!1,n=n.alias;n&&(i=n[0],b(r,T([0,1],n)));for(var o=1,l=!0;o<r.length;o+=1){var u=r[o],h=_(u,0,1),c=_(u,-1);if(('"'===h||"'"===h||"`"===h||'"'===c||"'"===c||"`"===c)&&h!==c)throw new d("property names with quotes must have matching quotes");if("constructor"!==u&&l||(s=!0),E(v,h="%"+(i+="."+u)+"%"))a=v[h];else if(null!=a){if(!(u in a)){if(e)return;throw new f("base intrinsic for "+t+" exists, but the property is not available.")}a=p&&o+1>=r.length?(l=!!(c=p(a,u)))&&"get"in c&&!("originalValue"in c.get)?c.get:a[u]:(l=E(a,u),a[u]),l&&!s&&(v[h]=a)}}return a}},function(t,e,r){"use strict";r=r(368);t.exports=Function.prototype.bind||r},function(t,e,r){"use strict";var i=String.prototype.replace,n=/%20/g,a="RFC1738",s="RFC3986";t.exports={default:s,formatters:{RFC1738:function(t){return i.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:a,RFC3986:s}},function(t,e,r){"use strict";
/*!
 * parseurl
 * Copyright(c) 2014 Jonathan Ong
 * Copyright(c) 2014-2017 Douglas Christopher Wilson
 * MIT Licensed
 */var r=r(360),s=r.parse,o=r.Url;function i(t){var e,r=t.url;if(void 0!==r)return a(r,e=t._parsedUrl)?e:((e=n(r))._raw=r,t._parsedUrl=e)}function n(t){if("string"!=typeof t||47!==t.charCodeAt(0))return s(t);for(var e=t,r=null,i=null,n=1;n<t.length;n++)switch(t.charCodeAt(n)){case 63:null===i&&(e=t.substring(0,n),r=t.substring(n+1),i=t.substring(n));break;case 9:case 10:case 12:case 13:case 32:case 35:case 160:case 65279:return s(t)}var a=void 0!==o?new o:{};return a.path=t,a.href=t,a.pathname=e,null!==i&&(a.query=r,a.search=i),a}function a(t,e){return"object"==typeof e&&null!==e&&(void 0===o||e instanceof o)&&e._raw===t}t.exports=i,t.exports.original=function(t){var e=t.originalUrl;if("string"!=typeof e)return i(t);var r=t._parsedOriginalUrl;if(a(e,r))return r;return(r=n(e))._raw=e,t._parsedOriginalUrl=r}},function(t,e,r){var i,n,a,s,o,l,u,h,c,d,f,p,g,v,m,y,E;function T(t,e){return t.test(e)}function b(t){var e=(t=t||navigator.userAgent).split("[FBAN");if(void 0!==(e=(t=void 0!==e[1]?e[0]:t).split("Twitter"))[1]&&(t=e[0]),this.apple={phone:T(a,t),ipod:T(s,t),tablet:!T(a,t)&&T(o,t),device:T(a,t)||T(s,t)||T(o,t)},this.amazon={phone:T(h,t),tablet:!T(h,t)&&T(c,t),device:T(h,t)||T(c,t)},this.android={phone:T(h,t)||T(l,t),tablet:!T(h,t)&&!T(l,t)&&(T(c,t)||T(u,t)),device:T(h,t)||T(c,t)||T(l,t)||T(u,t)},this.windows={phone:T(d,t),tablet:T(f,t),device:T(d,t)||T(f,t)},this.other={blackberry:T(p,t),blackberry10:T(g,t),opera:T(v,t),firefox:T(y,t),chrome:T(m,t),device:T(p,t)||T(g,t)||T(v,t)||T(y,t)||T(m,t)},this.seven_inch=T(E,t),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this}function A(){var t=new b;return t.Class=b,t}
/**
 * isMobile.js v0.4.1
 *
 * A simple library to detect Apple phones and tablets,
 * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),
 * and any kind of seven inch device, via user agent sniffing.
 *
 * @author: Kai Mallea (kmallea@gmail.com)
 *
 * @license: http://creativecommons.org/publicdomain/zero/1.0/
 */
n=this,a=/iPhone/i,s=/iPod/i,o=/iPad/i,l=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,u=/Android/i,h=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,c=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,d=/Windows Phone/i,f=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,g=/BB10/i,v=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,y=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,E=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),t.exports&&"undefined"==typeof window?t.exports=b:t.exports&&"undefined"!=typeof window?t.exports=A():(i=[],n=n.isMobile=A(),void 0!==(e="function"==typeof n?n.apply(e,i):n)&&(t.exports=e))},function(t,e,r){"use strict";r.d(e,"a",function(){return y});var e=r(87),i=r.n(e),e=r(62),s=r.n(e),e=r(17),n=r.n(e),e=r(5),o=r.n(e),e=r(6),l=r.n(e),e=r(7),u=r.n(e),e=r(8),h=r.n(e),e=r(9),a=r.n(e),e=r(3),c=r.n(e),e=r(63),d=r.n(e),f=r(1),e=r(91),p=r.n(e);function g(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){n()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c()(r);return t=i?(t=c()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),a()(this,t)}}var y=function(t){h()(a,t);var e,n=m(a);function a(){var t;o()(this,a);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=n.call.apply(n,[this].concat(r))).options.playback=v(v({},t.options),t.options.playback),t.mustDestroy=!1,t._paused=!1,t.firstPlay=!0,t}return l()(a,[{key:"name",get:function(){return"mseld"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(t){this._currentLevel=t,this.trigger(f.Events.PLAYBACK_LEVEL_SWITCH_START),this.setTracks(t)}},{key:"init",value:function(){var n=this,t=this.options.src,t=p.a.replaceHttpByWS(t);return this.options.autoplay&&!this.options.mute&&(this.el.autoplay=!1,this.el.muted=!0,this.el.volume=0),this.MSE=new p.a(this.el,t,{debug:!0,connectionRetries:0,errorsBeforeStop:0,onCrashTryVideoOnly:!1,wsReconnect:!1,statsSendEnable:!1,onError:function(t){var e;t&&!t.type&&n.trigger(f.Events.PLAYBACK_ERROR,t),t&&(e=t.error,t=t.code,"WebSocket lost connection"===e)&&1e3===t&&(n.playingStarted=!1,n.stop())},onMediaInfo:function(t){var e,r;(e=n.options.onMediaInfo)&&"function"==typeof e&&((r=t.streams||t.tracks)&&0<r.length&&(n._levels=r.filter(function(t){return t.content&&"audio"===t.content&&(n.audio=t),!(!t.content||"video"!==t.content)}).map(function(t,e){return{id:e,level:t.size||0,label:"".concat(t.bitrate,"Kbps"),bitrate:t.bitrate,track_id:t.track_id}}),n.trigger(f.Events.PLAYBACK_LEVELS_AVAILABLE,n._levels)),e(t))},onProgress:function(){n.playingStarted=!0,n.trigger(f.Events.PLAYBACK_BUFFERFULL);var r,i,t=n.options.tracks;t&&2<=t.length&&!1!==n.firstPlay&&(r=s()(t),i=[],r.forEach(function(t,e){(e+1)%2==0&&i.push(r[e-1]+r[e])}),n.MSE.setTracks(i),n.firstPlay=!1)},onStartStalling:function(){n.trigger(f.Events.PLAYBACK_BUFFERING)},onEndStalling:function(){n.trigger(f.Events.PLAYBACK_BUFFERFULL)},onPause:function(){n.trigger(f.Events.PLAYBACK_STOP)},onEvent:function(t){}}),this.MSE}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._timeUpdateTimer=setInterval(function(){t._onTimeUpdate()},100)}},{key:"_onTimeUpdate",value:function(){var t={current:this.getCurrentTime(),total:this.getDuration()};this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current||(this._lastTimeUpdate=t,this.trigger(f.Events.PLAYBACK_TIMEUPDATE,t,this.name))}},{key:"_updateSettings",value:function(){this.settings.left=["playstop"],this.trigger(f.Events.PLAYBACK_SETTINGSUPDATE)}},{key:"_onDurationChange",value:function(){var t=this.getDuration();this._lastDuration!==t&&(this._lastDuration=t,u()(c()(a.prototype),"_onDurationChange",this).call(this))}},{key:"_stopTimeUpdateTimer",value:function(){clearInterval(this._timeUpdateTimer)}},{key:"getPlaybackType",value:function(){return f.Playback.LIVE}},{key:"destroy",value:function(){var t=this;this.playPromise?(this.playPromise.catch(function(){t.stop()}).finally(function(){t.stop()}),this._stopTimeUpdateTimer(),u()(c()(a.prototype),"destroy",this).call(this)):this.mustDestroy=!0}},{key:"resolveRedirect",value:function(e){return fetch(e,{method:"OPTIONS"}).catch(function(t){return e}).then(function(t){return t.headers&&t.headers.get("location")?t.headers.get("location"):e})}},{key:"getStartTimeOffset",value:function(){return this.getCurrentTime()}},{key:"_handleBufferingEvents",value:function(){}},{key:"isSeekEnabled",value:function(){return!1}},{key:"attemptAutoPlay",value:(e=i()(d.a.mark(function t(){var e=this;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkIfCritical().then(function(){e.criticalError||e.MSE||(e.init(),e._onProgress=e.MSE.onProgress.bind(e),e.play())});case 2:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"_onError",value:function(){}},{key:"play",value:function(){var t=this;this.criticalError||this.playingStarted||(this.trigger(f.Events.PLAYBACK_PLAY_INTENT),this.MSE||this.init(),this.playPromise=this.MSE.play(),this.playPromise&&this.playPromise.then(function(){t._ready(),t.playingStarted=!0,t._stopped=!1,t.trigger(f.Events.PLAYBACK_BUFFERING),t.mustDestroy&&t.destroy()}).catch(function(){t.mustDestroy&&t.destroy()}).finally(function(){t.trigger(f.Events.MEDIACONTROL_PLAYING)}),this._startTimeUpdateTimer())}},{key:"pause",value:function(){this.MSE&&(this._paused?(this.MSE.play(),this._paused=!1):(this.MSE.pause(),this._paused=!0))}},{key:"isPlaying",value:function(){return this.playingStarted||!1}},{key:"setTracks",value:function(t){var e,r,t=-1===t?0:t;this.MSE&&(this.audio&&this.audio.track_id&&(e=this.audio.track_id),r=[],this._levels[t]&&r.push(this._levels[t].track_id),void 0!==e&&r.push(e),0<r.length)&&this.MSE.setTracks(r),this.trigger(f.Events.PLAYBACK_LEVEL_SWITCH_END)}},{key:"getStats",value:function(){return this.MSE.getStats()}},{key:"_ready",value:function(){this.trigger(f.Events.PLAYBACK_READY)}},{key:"setWaitStatus",value:function(t){this._waitStatus=t}},{key:"stop",value:function(){this.MSE?(this.MSE.stop(),u()(c()(a.prototype),"stop",this).call(this),this.trigger(f.Events.PLAYBACK_STOP),this.playingStarted=!1,this.MSE=void 0):this.mustDestroy=!0}},{key:"checkIfCritical",value:function(){var i=this;return new Promise(function(r,t){i._options.mediaInfo.then(function(t){var e=t.criticalError,t=t.errorCodec;return e&&(i.destroy(),i.criticalError=!0,i.stop(),i.trigger(f.Events.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}})),r()})})}}],[{key:"MSELD",get:function(){return a}}]),a}(f.HTML5Video);y.isSupported=function(){return p.a.isSupported()},y.canPlay=function(t,e){return(-1!==t.indexOf("mse_ld")||"application/x-flussonic-mse"===e)&&y.isSupported()}},function(t,e,r){var i=r(61).default,n=r(198);t.exports=function(t){return t=n(t,"string"),"symbol"===i(t)?t:String(t)},t.exports.__esModule=!0,t.exports.default=t.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(153);t.exports=function(t,e){var r;if(t)return"string"==typeof t?i(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";function o(t,e){for(var r=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)void 0!==t[i]&&(r[i]=t[i]);return r}var u=r(119),l=Object.prototype.hasOwnProperty,g=Array.isArray,h=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}();t.exports={arrayToObject:o,assign:function(t,r){return Object.keys(r).reduce(function(t,e){return t[e]=r[e],t},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],r=[],i=0;i<e.length;++i)for(var n=e[i],a=n.obj[n.prop],s=Object.keys(a),o=0;o<s.length;++o){var l=s[o],u=a[l];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(e.push({obj:a,prop:l}),r.push(u))}for(var h=e;1<h.length;){var c=h.pop(),d=c.obj[c.prop];if(g(d)){for(var f=[],p=0;p<d.length;++p)void 0!==d[p]&&f.push(d[p]);c.obj[c.prop]=f}}return t},decode:function(e,t,r){e=e.replace(/\+/g," ");if("iso-8859-1"===r)return e.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(e)}catch(t){return e}},encode:function(t,e,r,i,n){if(0===t.length)return t;var a=t;if("symbol"==typeof t?a=Symbol.prototype.toString.call(t):"string"!=typeof t&&(a=String(t)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var s="",o=0;o<a.length;++o){var l=a.charCodeAt(o);45===l||46===l||95===l||126===l||48<=l&&l<=57||65<=l&&l<=90||97<=l&&l<=122||n===u.RFC1738&&(40===l||41===l)?s+=a.charAt(o):l<128?s+=h[l]:l<2048?s+=h[192|l>>6]+h[128|63&l]:l<55296||57344<=l?s+=h[224|l>>12]+h[128|l>>6&63]+h[128|63&l]:(o+=1,l=65536+((1023&l)<<10|1023&a.charCodeAt(o)),s+=h[240|l>>18]+h[128|l>>12&63]+h[128|l>>6&63]+h[128|63&l])}return s},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(g(t)){for(var r=[],i=0;i<t.length;i+=1)r.push(e(t[i]));return r}return e(t)},merge:function i(n,a,s){if(!a)return n;if("object"!=typeof a){if(g(n))n.push(a);else{if(!n||"object"!=typeof n)return[n,a];(s&&(s.plainObjects||s.allowPrototypes)||!l.call(Object.prototype,a))&&(n[a]=!0)}return n}var t;return n&&"object"==typeof n?(g(t=n)&&!g(a)&&(t=o(n,s)),g(n)&&g(a)?(a.forEach(function(t,e){var r;l.call(n,e)?(r=n[e])&&"object"==typeof r&&t&&"object"==typeof t?n[e]=i(r,t,s):n.push(t):n[e]=t}),n):Object.keys(a).reduce(function(t,e){var r=a[e];return l.call(t,e)?t[e]=i(t[e],r,s):t[e]=r,t},t)):[n].concat(a)}}},function(t,e){t.exports=function(t){var e;return t.webpackPolyfill||((e=Object.create(t)).children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1),e}},function(t,e,r){"use strict";r.d(e,"a",function(){return s});var e=r(87),o=r.n(e),e=r(17),i=r.n(e),e=r(6),e=r.n(e),n=r(5),l=r.n(n),n=r(63),u=r.n(n),h=r(159),c=r(26);function a(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach(function(t){i()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var s=e()(function t(e){l()(this,t);var r=c.h(e),i=c.g(e),n=c.c(e),a=c.e(e),e=d(d(d(d({},e),a),{duration:n}),{authToken:i}),s=Object(h.pickBy)(e,function(t){return void 0!==t});this.get=c.b(s,r).bind(this),this.constructSource=function(){return c.f(s,!(0<arguments.length&&void 0!==arguments[0])||arguments[0])},this.getMediaInfo=o()(u.a.mark(function t(){var e,r,i;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.d(s),r=c.i(),i={criticalError:!1},t.next=5,fetch(e).then(function(t){return t.json()}).then(function(t){i=d(d({},i),t),t.tracks.forEach(function(t){var e=t.codec;if(e)switch(e){case"mp2v":i.criticalError=!0,i.errorCodec=e;break;case"hevc":r||(i.criticalError=!0,i.errorCodec=e)}})});case 5:return t.abrupt("return",i);case 6:case"end":return t.stop()}},t)}))})},function(t,D,C){!function(R,w){var I;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */!function(){var ja,Ga="Expected a function",vs="__lodash_hash_undefined__",ms="__lodash_placeholder__",$a=9007199254740991,ys=NaN,Ka=4294967295,Es=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Ha="[object Arguments]",Ts="[object Array]",Va="[object Boolean]",Wa="[object Date]",bs="[object Error]",As="[object Function]",_s="[object GeneratorFunction]",Ya="[object Map]",qa="[object Number]",za="[object Object]",Ss="[object Promise]",Qa="[object RegExp]",Xa="[object Set]",Ja="[object String]",Ls="[object Symbol]",Za="[object WeakMap]",ts="[object ArrayBuffer]",es="[object DataView]",ks="[object Float32Array]",Rs="[object Float64Array]",ws="[object Int8Array]",Is="[object Int16Array]",Ds="[object Int32Array]",Cs="[object Uint8Array]",Ps="[object Uint8ClampedArray]",xs="[object Uint16Array]",Os="[object Uint32Array]",Ms=/\b__p \+= '';/g,Fs=/\b(__p \+=) '' \+/g,Ns=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Bs=/&(?:amp|lt|gt|quot|#39);/g,Us=/[&<>"']/g,js=RegExp(Bs.source),Gs=RegExp(Us.source),$s=/<%-([\s\S]+?)%>/g,Ks=/<%([\s\S]+?)%>/g,Hs=/<%=([\s\S]+?)%>/g,Vs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ws=/^\w*$/,Ys=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qs=/[\\^$.*+?()[\]{}|]/g,zs=RegExp(qs.source),Qs=/^\s+/,s=/\s/,Xs=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Js=/\{\n\/\* \[wrapped with (.+)\] \*/,Zs=/,? & /,to=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,eo=/[()=,{}\[\]\/\s]/,ro=/\\(\\)?/g,io=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,no=/\w*$/,ao=/^[-+]0x[0-9a-f]+$/i,so=/^0b[01]+$/i,oo=/^\[object .+?Constructor\]$/,lo=/^0o[0-7]+$/i,uo=/^(?:0|[1-9]\d*)$/,ho=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,co=/($^)/,fo=/['\n\r\u2028\u2029\\]/g,o="\\ud800-\\udfff",l="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",t="\\u2700-\\u27bf",e="a-z\\xdf-\\xf6\\xf8-\\xff",r="A-Z\\xc0-\\xd6\\xd8-\\xde",u="\\ufe0e\\ufe0f",i="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",n="["+o+"]",h="["+i+"]",c="["+l+"]",d="["+t+"]",f="["+e+"]",i="[^"+o+i+"\\d+"+t+e+r+"]",t="\\ud83c[\\udffb-\\udfff]",e="[^"+o+"]",p="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",r="["+r+"]",g="(?:"+f+"|"+i+")",i="(?:"+r+"|"+i+")",v="(?:['’](?:d|ll|m|re|s|t|ve))?",m="(?:['’](?:D|LL|M|RE|S|T|VE))?",y="(?:"+c+"|"+t+")"+"?",E="["+u+"]?",E=E+y+("(?:\\u200d(?:"+[e,p,a].join("|")+")"+E+y+")*"),y="(?:"+[d,p,a].join("|")+")"+E,d="(?:"+[e+c+"?",c,p,a,n].join("|")+")",po=RegExp("['’]","g"),go=RegExp(c,"g"),T=RegExp(t+"(?="+t+")|"+d+E,"g"),vo=RegExp([r+"?"+f+"+"+v+"(?="+[h,r,"$"].join("|")+")",i+"+"+m+"(?="+[h,r+g,"$"].join("|")+")",r+"?"+g+"+"+v,r+"+"+m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",y].join("|"),"g"),b=RegExp("[\\u200d"+o+l+u+"]"),mo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,yo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Eo=-1,rs={},is=(rs[ks]=rs[Rs]=rs[ws]=rs[Is]=rs[Ds]=rs[Cs]=rs[Ps]=rs[xs]=rs[Os]=!0,rs[Ha]=rs[Ts]=rs[ts]=rs[Va]=rs[es]=rs[Wa]=rs[bs]=rs[As]=rs[Ya]=rs[qa]=rs[za]=rs[Qa]=rs[Xa]=rs[Ja]=rs[Za]=!1,{}),A=(is[Ha]=is[Ts]=is[ts]=is[es]=is[Va]=is[Wa]=is[ks]=is[Rs]=is[ws]=is[Is]=is[Ds]=is[Ya]=is[qa]=is[za]=is[Qa]=is[Xa]=is[Ja]=is[Ls]=is[Cs]=is[Ps]=is[xs]=is[Os]=!0,is[bs]=is[As]=is[Za]=!1,{"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"}),To=parseFloat,bo=parseInt,e="object"==typeof R&&R&&R.Object===Object&&R,p="object"==typeof self&&self&&self.Object===Object&&self,ns=e||p||Function("return this")(),a=D&&!D.nodeType&&D,_=a&&"object"==typeof w&&w&&!w.nodeType&&w,Ao=_&&_.exports===a,S=Ao&&e.process,n=function(){try{var t=_&&_.require&&_.require("util").types;return t?t:S&&S.binding&&S.binding("util")}catch(t){}}(),_o=n&&n.isArrayBuffer,So=n&&n.isDate,Lo=n&&n.isMap,ko=n&&n.isRegExp,Ro=n&&n.isSet,wo=n&&n.isTypedArray;function as(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Io(t,e,r,i){for(var n=-1,a=null==t?0:t.length;++n<a;){var s=t[n];e(i,s,r(s),t)}return i}function ss(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););return t}function Do(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function Co(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(!e(t[r],r,t))return!1;return!0}function os(t,e){for(var r=-1,i=null==t?0:t.length,n=0,a=[];++r<i;){var s=t[r];e(s,r,t)&&(a[n++]=s)}return a}function Po(t,e){return!!(null==t?0:t.length)&&-1<hs(t,e,0)}function xo(t,e,r){for(var i=-1,n=null==t?0:t.length;++i<n;)if(r(e,t[i]))return!0;return!1}function ls(t,e){for(var r=-1,i=null==t?0:t.length,n=Array(i);++r<i;)n[r]=e(t[r],r,t);return n}function us(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function Oo(t,e,r,i){var n=-1,a=null==t?0:t.length;for(i&&a&&(r=t[++n]);++n<a;)r=e(r,t[n],n,t);return r}function Mo(t,e,r,i){var n=null==t?0:t.length;for(i&&n&&(r=t[--n]);n--;)r=e(r,t[n],n,t);return r}function Fo(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}var L=$o("length");function No(t,i,e){var n;return e(t,function(t,e,r){if(i(t,e,r))return n=e,!1}),n}function Bo(t,e,r,i){for(var n=t.length,a=r+(i?1:-1);i?a--:++a<n;)if(e(t[a],a,t))return a;return-1}function hs(t,e,r){if(e!=e)return Bo(t,jo,r);for(var i=t,n=e,a=r-1,s=i.length;++a<s;)if(i[a]===n)return a;return-1}function Uo(t,e,r,i){for(var n=r-1,a=t.length;++n<a;)if(i(t[n],e))return n;return-1}function jo(t){return t!=t}function Go(t,e){var r=null==t?0:t.length;return r?Ho(t,e)/r:ys}function $o(e){return function(t){return null==t?ja:t[e]}}function k(e){return function(t){return null==e?ja:e[t]}}function Ko(t,i,n,a,e){return e(t,function(t,e,r){n=a?(a=!1,t):i(n,t,e,r)}),n}function Ho(t,e){for(var r,i=-1,n=t.length;++i<n;){var a=e(t[i]);a!==ja&&(r=r===ja?a:r+a)}return r}function Vo(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function Wo(t){return t&&t.slice(0,il(t)+1).replace(Qs,"")}function cs(e){return function(t){return e(t)}}function Yo(e,t){return ls(t,function(t){return e[t]})}function qo(t,e){return t.has(e)}function zo(t,e){for(var r=-1,i=t.length;++r<i&&-1<hs(e,t[r],0););return r}function Qo(t,e){for(var r=t.length;r--&&-1<hs(e,t[r],0););return r}var Xo=k({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Jo=k({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Zo(t){return"\\"+A[t]}function ds(t){return b.test(t)}function tl(t){var r=-1,i=Array(t.size);return t.forEach(function(t,e){i[++r]=[e,t]}),i}function el(e,r){return function(t){return e(r(t))}}function fs(t,e){for(var r=-1,i=t.length,n=0,a=[];++r<i;){var s=t[r];s!==e&&s!==ms||(t[r]=ms,a[n++]=r)}return a}function rl(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function ps(t){return(ds(t)?function(t){var e=T.lastIndex=0;for(;T.test(t);)++e;return e}:L)(t)}function gs(t){return ds(t)?t.match(T)||[]:t.split("")}function il(t){for(var e=t.length;e--&&s.test(t.charAt(e)););return e}var nl=k({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var al=function n(t){var A=(t=null==t?ns:al.defaults(ns.Object(),t,al.pick(ns,yo))).Array,a=t.Date,P=t.Error,x=t.Function,O=t.Math,g=t.Object,M=t.RegExp,$=t.String,_=t.TypeError,K=A.prototype,H=x.prototype,V=g.prototype,W=t["__core-js_shared__"],Y=H.toString,F=V.hasOwnProperty,q=0,z=(H=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",Q=V.toString,X=Y.call(g),J=ns._,Z=M("^"+Y.call(F).replace(qs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),H=Ao?t.Buffer:ja,e=t.Symbol,tt=t.Uint8Array,et=H?H.allocUnsafe:ja,rt=el(g.getPrototypeOf,g),it=g.create,nt=V.propertyIsEnumerable,at=K.splice,st=e?e.isConcatSpreadable:ja,ot=e?e.iterator:ja,lt=e?e.toStringTag:ja,ut=function(){try{var t=Xr(g,"defineProperty");return t({},"",{}),t}catch(t){}}(),ht=t.clearTimeout!==ns.clearTimeout&&t.clearTimeout,ct=a&&a.now!==ns.Date.now&&a.now,dt=t.setTimeout!==ns.setTimeout&&t.setTimeout,ft=O.ceil,pt=O.floor,gt=g.getOwnPropertySymbols,H=H?H.isBuffer:ja,vt=t.isFinite,mt=K.join,yt=el(g.keys,g),S=O.max,L=O.min,Et=a.now,Tt=t.parseInt,bt=O.random,At=K.reverse,a=Xr(t,"DataView"),_t=Xr(t,"Map"),St=Xr(t,"Promise"),Lt=Xr(t,"Set"),t=Xr(t,"WeakMap"),kt=Xr(g,"create"),Rt=t&&new t,wt={},It=Ai(a),Dt=Ai(_t),Ct=Ai(St),Pt=Ai(Lt),xt=Ai(t),e=e?e.prototype:ja,Ot=e?e.valueOf:ja,Mt=e?e.toString:ja;function p(t){if(G(t)&&!j(t)&&!(t instanceof m)){if(t instanceof v)return t;if(F.call(t,"__wrapped__"))return _i(t)}return new v(t)}var Ft=function(t){if(!b(t))return{};if(it)return it(t);Nt.prototype=t;t=new Nt;return Nt.prototype=ja,t};function Nt(){}function Bt(){}function v(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=ja}function m(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ka,this.__views__=[]}function Ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function jt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Gt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function $t(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Gt;++e<r;)this.add(t[e])}function N(t){t=this.__data__=new jt(t);this.size=t.size}function Kt(t,e){var r,i=j(t),n=!i&&mn(t),a=!i&&!n&&En(t),s=!i&&!n&&!a&&Dn(t),o=i||n||a||s,l=o?Vo(t.length,$):[],u=l.length;for(r in t)!e&&!F.call(t,r)||o&&("length"==r||a&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||ii(r,u))||l.push(r);return l}function Ht(t){var e=t.length;return e?t[Be(0,e-1)]:ja}function Vt(t,e){return yi(k(t),te(e,0,t.length))}function Wt(t){return yi(k(t))}function Yt(t,e,r){(r===ja||U(t[e],r))&&(r!==ja||e in t)||Jt(t,e,r)}function qt(t,e,r){var i=t[e];F.call(t,e)&&U(i,r)&&(r!==ja||e in t)||Jt(t,e,r)}function zt(t,e){for(var r=t.length;r--;)if(U(t[r][0],e))return r;return-1}function Qt(t,i,n,a){return ne(t,function(t,e,r){i(a,t,n(t),r)}),a}function Xt(t,e){return t&&gr(e,I(e),t)}function Jt(t,e,r){"__proto__"==e&&ut?ut(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Zt(t,e){for(var r=-1,i=e.length,n=A(i),a=null==t;++r<i;)n[r]=a?ja:Hn(t,e[r]);return n}function te(t,e,r){return t=t==t&&(r!==ja&&(t=t<=r?t:r),e!==ja)?e<=t?t:e:t}function y(r,i,n,t,e,a){var s,o=1&i,l=2&i,u=4&i;if((s=n?e?n(r,t,e,a):n(r):s)===ja){if(!b(r))return r;var h,t=j(r);if(t){if(s=function(t){var e=t.length,r=new t.constructor(e);e&&"string"==typeof t[0]&&F.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(r),!o)return k(r,s)}else{var c=B(r),d=c==As||c==_s;if(En(r))return ur(r,o);if(c==za||c==Ha||d&&!e){if(s=l||d?{}:ei(r),!o)return l?(f=d=r,f=(h=s)&&gr(f,D(f),h),gr(d,Zr(d),f)):(d=Xt(s,h=r),gr(h,Jr(h),d))}else{if(!is[c])return e?r:{};s=function(t,e,r){var i=t.constructor;switch(e){case ts:return hr(t);case Va:case Wa:return new i(+t);case es:return function(t,e){e=e?hr(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}(t,r);case ks:case Rs:case ws:case Is:case Ds:case Cs:case Ps:case xs:case Os:return cr(t,r);case Ya:return new i;case qa:case Ja:return new i(t);case Qa:return function(t){var e=new t.constructor(t.source,no.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Xa:return new i;case Ls:return function(t){return Ot?g(Ot.call(t)):{}}(t)}}(r,c,o)}}var f=(a=a||new N).get(r);if(f)return f;a.set(r,s),wn(r)?r.forEach(function(t){s.add(y(t,i,n,t,r,a))}):Sn(r)&&r.forEach(function(t,e){s.set(e,y(t,i,n,e,r,a))});var p=t?ja:(u?l?Vr:Hr:l?D:I)(r);ss(p||r,function(t,e){p&&(t=r[e=t]),qt(s,e,y(t,i,n,e,r,a))})}return s}function ee(t,e,r){var i=r.length;if(null==t)return!i;for(t=g(t);i--;){var n=r[i],a=e[n],s=t[n];if(s===ja&&!(n in t)||!a(s))return!1}return!0}function re(t,e,r){if("function"!=typeof t)throw new _(Ga);return pi(function(){t.apply(ja,r)},e)}function ie(t,e,r,i){var n=-1,a=Po,s=!0,o=t.length,l=[],u=e.length;if(o){r&&(e=ls(e,cs(r))),i?(a=xo,s=!1):200<=e.length&&(a=qo,s=!1,e=new $t(e));t:for(;++n<o;){var h=t[n],c=null==r?h:r(h),h=i||0!==h?h:0;if(s&&c==c){for(var d=u;d--;)if(e[d]===c)continue t;l.push(h)}else a(e,c,i)||l.push(h)}}return l}p.templateSettings={escape:$s,evaluate:Ks,interpolate:Hs,variable:"",imports:{_:p}},(p.prototype=Bt.prototype).constructor=p,(v.prototype=Ft(Bt.prototype)).constructor=v,(m.prototype=Ft(Bt.prototype)).constructor=m,Ut.prototype.clear=function(){this.__data__=kt?kt(null):{},this.size=0},Ut.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},Ut.prototype.get=function(t){var e,r=this.__data__;return kt?(e=r[t])===vs?ja:e:F.call(r,t)?r[t]:ja},Ut.prototype.has=function(t){var e=this.__data__;return kt?e[t]!==ja:F.call(e,t)},Ut.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=kt&&e===ja?vs:e,this},jt.prototype.clear=function(){this.__data__=[],this.size=0},jt.prototype.delete=function(t){var e=this.__data__;return!((t=zt(e,t))<0||(t==e.length-1?e.pop():at.call(e,t,1),--this.size,0))},jt.prototype.get=function(t){var e=this.__data__;return(t=zt(e,t))<0?ja:e[t][1]},jt.prototype.has=function(t){return-1<zt(this.__data__,t)},jt.prototype.set=function(t,e){var r=this.__data__,i=zt(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this},Gt.prototype.clear=function(){this.size=0,this.__data__={hash:new Ut,map:new(_t||jt),string:new Ut}},Gt.prototype.delete=function(t){return t=zr(this,t).delete(t),this.size-=t?1:0,t},Gt.prototype.get=function(t){return zr(this,t).get(t)},Gt.prototype.has=function(t){return zr(this,t).has(t)},Gt.prototype.set=function(t,e){var r=zr(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this},$t.prototype.add=$t.prototype.push=function(t){return this.__data__.set(t,vs),this},$t.prototype.has=function(t){return this.__data__.has(t)},N.prototype.clear=function(){this.__data__=new jt,this.size=0},N.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},N.prototype.get=function(t){return this.__data__.get(t)},N.prototype.has=function(t){return this.__data__.has(t)},N.prototype.set=function(t,e){var r=this.__data__;if(r instanceof jt){var i=r.__data__;if(!_t||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new Gt(i)}return r.set(t,e),this.size=r.size,this};var ne=yr(ce),ae=yr(de,!0);function se(t,i){var n=!0;return ne(t,function(t,e,r){return n=!!i(t,e,r)}),n}function oe(t,e,r){for(var i=-1,n=t.length;++i<n;){var a,s,o=t[i],l=e(o);null!=l&&(a===ja?l==l&&!E(l):r(l,a))&&(a=l,s=o)}return s}function le(t,i){var n=[];return ne(t,function(t,e,r){i(t,e,r)&&n.push(t)}),n}function l(t,e,r,i,n){var a=-1,s=t.length;for(r=r||ri,n=n||[];++a<s;){var o=t[a];0<e&&r(o)?1<e?l(o,e-1,r,i,n):us(n,o):i||(n[n.length]=o)}return n}var ue=Er(),he=Er(!0);function ce(t,e){return t&&ue(t,e,I)}function de(t,e){return t&&he(t,e,I)}function fe(e,t){return os(t,function(t){return bn(e[t])})}function pe(t,e){for(var r=0,i=(e=ar(e,t)).length;null!=t&&r<i;)t=t[bi(e[r++])];return r&&r==i?t:ja}function ge(t,e,r){e=e(t);return j(t)?e:us(e,r(t))}function r(t){if(null==t)return t===ja?"[object Undefined]":"[object Null]";if(lt&&lt in g(t)){var e=t,r=F.call(e,lt),i=e[lt];try{e[lt]=ja;var n=!0}catch(t){}var a=Q.call(e);return n&&(r?e[lt]=i:delete e[lt]),a}return Q.call(t)}function ve(t,e){return e<t}function me(t,e){return null!=t&&F.call(t,e)}function ye(t,e){return null!=t&&e in g(t)}function Ee(t,e,r){for(var i=r?xo:Po,n=t[0].length,a=t.length,s=a,o=A(a),l=1/0,u=[];s--;){var h=t[s];s&&e&&(h=ls(h,cs(e))),l=L(h.length,l),o[s]=!r&&(e||120<=n&&120<=h.length)?new $t(s&&h):ja}var h=t[0],c=-1,d=o[0];t:for(;++c<n&&u.length<l;){var f=h[c],p=e?e(f):f,f=r||0!==f?f:0;if(!(d?qo(d,p):i(u,p,r))){for(s=a;--s;){var g=o[s];if(!(g?qo(g,p):i(t[s],p,r)))continue t}d&&d.push(p),u.push(f)}}return u}function Te(t,e,r){e=null==(t=ci(t,e=ar(e,t)))?t:t[bi(i(e))];return null==e?ja:as(e,t,r)}function be(t){return G(t)&&r(t)==Ha}function Ae(t,e,r,i,n){if(t===e)return!0;if(null==t||null==e||!G(t)&&!G(e))return t!=t&&e!=e;var a=Ae,s=j(t),o=j(e),l=s?Ts:B(t),o=o?Ts:B(e),u=(l=l==Ha?za:l)==za,h=(o=o==Ha?za:o)==za;if((o=l==o)&&En(t)){if(!En(e))return!1;u=!(s=!0)}if(o&&!u){n=n||new N;if(s||Dn(t))return $r(t,e,r,i,a,n);else{var c=t;var d=e;var f=l;var p=r;var g=i;var v=a;var m=n;switch(f){case es:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case ts:return c.byteLength==d.byteLength&&v(new tt(c),new tt(d))?!0:!1;case Va:case Wa:case qa:return U(+c,+d);case bs:return c.name==d.name&&c.message==d.message;case Qa:case Ja:return c==d+"";case Ya:var y=tl;case Xa:var E=1&p;if(y=y||rl,c.size!=d.size&&!E)return!1;E=m.get(c);if(E)return E==d;p|=2,m.set(c,d);E=$r(y(c),y(d),p,g,v,m);return m.delete(c),E;case Ls:if(Ot)return Ot.call(c)==Ot.call(d)}return!1;return}}if(!(1&r)){s=u&&F.call(t,"__wrapped__"),l=h&&F.call(e,"__wrapped__");if(s||l)return u=s?t.value():t,h=l?e.value():e,n=n||new N,a(u,h,r,i,n)}if(o){n=n||new N;var T=t,b=e,A=r,_=i,S=a,L=n,k=1&A,R=Hr(T),w=R.length,s=Hr(b).length;if(w!=s&&!k)return!1;for(var I=w;I--;){var D=R[I];if(!(k?D in b:F.call(b,D)))return!1}s=L.get(T),l=L.get(b);if(s&&l)return s==b&&l==T;for(var C=!0,P=(L.set(T,b),L.set(b,T),k);++I<w;){D=R[I];var x,O=T[D],M=b[D];if(!((x=_?k?_(M,O,D,b,T,L):_(O,M,D,T,b,L):x)===ja?O===M||S(O,M,A,_,L):x)){C=!1;break}P=P||"constructor"==D}return C&&!P&&(s=T.constructor,l=b.constructor,s!=l)&&"constructor"in T&&"constructor"in b&&!("function"==typeof s&&s instanceof s&&"function"==typeof l&&l instanceof l)&&(C=!1),L.delete(T),L.delete(b),C}return!1}function _e(t,e,r,i){var n=r.length,a=n,s=!i;if(null==t)return!a;for(t=g(t);n--;){var o=r[n];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<a;){var l=(o=r[n])[0],u=t[l],h=o[1];if(s&&o[2]){if(u===ja&&!(l in t))return!1}else{var c,d=new N;if(!((c=i?i(u,h,l,t,e,d):c)===ja?Ae(h,u,3,i,d):c))return!1}}return!0}function Se(t){var e;return!(!b(t)||(e=t,z&&z in e))&&(bn(t)?Z:oo).test(Ai(t))}function Le(t){return"function"==typeof t?t:null==t?C:"object"==typeof t?j(t)?Ce(t[0],t[1]):De(t):Ra(t)}function ke(t){if(!oi(t))return yt(t);var e,r=[];for(e in g(t))F.call(t,e)&&"constructor"!=e&&r.push(e);return r}function Re(t){if(!b(t)){var e=t,r=[];if(null!=e)for(var i in g(e))r.push(i);return r}var n,a=oi(t),s=[];for(n in t)("constructor"!=n||!a&&F.call(t,n))&&s.push(n);return s}function we(t,e){return t<e}function Ie(t,i){var n=-1,a=h(t)?A(t.length):[];return ne(t,function(t,e,r){a[++n]=i(t,e,r)}),a}function De(e){var r=Qr(e);return 1==r.length&&r[0][2]?ui(r[0][0],r[0][1]):function(t){return t===e||_e(t,e,r)}}function Ce(r,i){return ni(r)&&li(i)?ui(bi(r),i):function(t){var e=Hn(t,r);return e===ja&&e===i?Vn(t,r):Ae(i,e,3)}}function Pe(g,v,m,y,E){g!==v&&ue(v,function(t,e){var r,i,n,a,s,o,l,u,h,c,d,f,p;E=E||new N,b(t)?(i=v,a=m,s=Pe,o=y,l=E,d=di(r=g,n=e),f=di(i,n),(p=l.get(f))?Yt(r,n,p):(p=o?o(d,f,n+"",r,i,l):ja,(i=p===ja)&&(u=j(f),h=!u&&En(f),c=!u&&!h&&Dn(f),p=f,u||h||c?p=j(d)?d:T(d)?k(d):h?ur(f,!(i=!1)):c?cr(f,!(i=!1)):[]:kn(f)||mn(f)?mn(p=d)?p=Fn(d):b(d)&&!bn(d)||(p=ei(f)):i=!1),i&&(l.set(f,p),s(p,f,a,o,l),l.delete(f)),Yt(r,n,p))):(u=y?y(di(g,e),t,e+"",g,v,E):ja,Yt(g,e,u=u===ja?t:u))},D)}function xe(t,e){var r=t.length;if(r)return ii(e+=e<0?r:0,r)?t[e]:ja}function Oe(t,i,h){i=i.length?ls(i,function(e){return j(e)?function(t){return pe(t,1===e.length?e[0]:e)}:e}):[C];var n=-1;i=ls(i,cs(c()));var e=Ie(t,function(e,t,r){return{criteria:ls(i,function(t){return t(e)}),index:++n,value:e}}),t=function(t,e){for(var r=h,i=-1,n=t.criteria,a=e.criteria,s=n.length,o=r.length;++i<s;){var l,u=dr(n[i],a[i]);if(u)return o<=i?u:(l=r[i],u*("desc"==l?-1:1))}return t.index-e.index},r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}function Me(t,e,r){for(var i=-1,n=e.length,a={};++i<n;){var s=e[i],o=pe(t,s);r(o,s)&&$e(a,ar(s,t),o)}return a}function Fe(t,e,r,i){var n=i?Uo:hs,a=-1,s=e.length,o=t;for(t===e&&(e=k(e)),r&&(o=ls(t,cs(r)));++a<s;)for(var l=0,u=e[a],h=r?r(u):u;-1<(l=n(o,h,l,i));)o!==t&&at.call(o,l,1),at.call(t,l,1);return t}function Ne(t,e){for(var r=t?e.length:0,i=r-1;r--;){var n,a=e[r];r!=i&&a===n||(ii(n=a)?at.call(t,a,1):Xe(t,a))}}function Be(t,e){return t+pt(bt()*(e-t+1))}function Ue(t,e){var r="";if(!(!t||e<1||$a<e))for(;e%2&&(r+=t),(e=pt(e/2))&&(t+=t),e;);return r}function s(t,e){return gi(hi(t,e,C),t+"")}function je(t){return Ht(ra(t))}function Ge(t,e){t=ra(t);return yi(t,te(e,0,t.length))}function $e(t,e,r,i){if(b(t))for(var n=-1,a=(e=ar(e,t)).length,s=a-1,o=t;null!=o&&++n<a;){var l,u=bi(e[n]),h=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;qt(o,u,h=n!=s&&(l=o[u],(h=i?i(l,u,o):ja)===ja)?b(l)?l:ii(e[n+1])?[]:{}:h),o=o[u]}return t}var Ke=Rt?function(t,e){return Rt.set(t,e),t}:C,e=ut?function(t,e){return ut(t,"toString",{configurable:!0,enumerable:!1,value:va(e),writable:!0})}:C;function He(t){return yi(ra(t))}function o(t,e,r){for(var i=-1,n=t.length,a=((r=n<r?n:r)<0&&(r+=n),n=r<(e=e<0?n<-e?0:n+e:e)?0:r-e>>>0,e>>>=0,A(n));++i<n;)a[i]=t[i+e];return a}function Ve(t,i){var n;return ne(t,function(t,e,r){return!(n=i(t,e,r))}),!!n}function We(t,e,r){var i=0,n=null==t?i:t.length;if("number"==typeof e&&e==e&&n<=2147483647){for(;i<n;){var a=i+n>>>1,s=t[a];null!==s&&!E(s)&&(r?s<=e:s<e)?i=1+a:n=a}return n}return Ye(t,e,C,r)}function Ye(t,e,r,i){var n=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=r(e))!=e,o=null===e,l=E(e),u=e===ja;n<a;){var h=pt((n+a)/2),c=r(t[h]),d=c!==ja,f=null===c,p=c==c,g=E(c),p=s?i||p:u?p&&(i||d):o?p&&d&&(i||!f):l?p&&d&&!f&&(i||!g):!f&&!g&&(i?c<=e:c<e);p?n=h+1:a=h}return L(a,4294967294)}function qe(t,e){for(var r=-1,i=t.length,n=0,a=[];++r<i;){var s,o=t[r],l=e?e(o):o;r&&U(l,s)||(s=l,a[n++]=0===o?0:o)}return a}function ze(t){return"number"==typeof t?t:E(t)?ys:+t}function u(t){var e;return"string"==typeof t?t:j(t)?ls(t,u)+"":E(t)?Mt?Mt.call(t):"":"0"==(e=t+"")&&1/t==-1/0?"-0":e}function Qe(t,e,r){var i=-1,n=Po,a=t.length,s=!0,o=[],l=o;if(r)s=!1,n=xo;else if(200<=a){var u=e?null:Fr(t);if(u)return rl(u);s=!1,n=qo,l=new $t}else l=e?[]:o;t:for(;++i<a;){var h=t[i],c=e?e(h):h,h=r||0!==h?h:0;if(s&&c==c){for(var d=l.length;d--;)if(l[d]===c)continue t;e&&l.push(c),o.push(h)}else n(l,c,r)||(l!==o&&l.push(c),o.push(h))}return o}function Xe(t,e){return null==(t=ci(t,e=ar(e,t)))||delete t[bi(i(e))]}function Je(t,e,r,i){return $e(t,e,r(pe(t,e)),i)}function Ze(t,e,r,i){for(var n=t.length,a=i?n:-1;(i?a--:++a<n)&&e(t[a],a,t););return r?o(t,i?0:a,i?a+1:n):o(t,i?a+1:0,i?n:a)}function tr(t,e){var r=t;return Oo(e,function(t,e){return e.func.apply(e.thisArg,us([t],e.args))},r=t instanceof m?t.value():r)}function er(t,e,r){var i=t.length;if(i<2)return i?Qe(t[0]):[];for(var n=-1,a=A(i);++n<i;)for(var s=t[n],o=-1;++o<i;)o!=n&&(a[n]=ie(a[n]||s,t[o],e,r));return Qe(l(a,1),e,r)}function rr(t,e,r){for(var i=-1,n=t.length,a=e.length,s={};++i<n;){var o=i<a?e[i]:ja;r(s,t[i],o)}return s}function ir(t){return T(t)?t:[]}function nr(t){return"function"==typeof t?t:C}function ar(t,e){return j(t)?t:ni(t,e)?[t]:Ti(f(t))}var sr=s;function or(t,e,r){var i=t.length;return r=r===ja?i:r,!e&&i<=r?t:o(t,e,r)}var lr=ht||function(t){return ns.clearTimeout(t)};function ur(t,e){return e?t.slice():(e=t.length,e=et?et(e):new t.constructor(e),t.copy(e),e)}function hr(t){var e=new t.constructor(t.byteLength);return new tt(e).set(new tt(t)),e}function cr(t,e){e=e?hr(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function dr(t,e){if(t!==e){var r=t!==ja,i=null===t,n=t==t,a=E(t),s=e!==ja,o=null===e,l=e==e,u=E(e);if(!o&&!u&&!a&&e<t||a&&s&&l&&!o&&!u||i&&s&&l||!r&&l||!n)return 1;if(!i&&!a&&!u&&t<e||u&&r&&n&&!i&&!a||o&&r&&n||!s&&n||!l)return-1}return 0}function fr(t,e,r,i){for(var n=-1,a=t.length,s=r.length,o=-1,l=e.length,u=S(a-s,0),h=A(l+u),c=!i;++o<l;)h[o]=e[o];for(;++n<s;)(c||n<a)&&(h[r[n]]=t[n]);for(;u--;)h[o++]=t[n++];return h}function pr(t,e,r,i){for(var n=-1,a=t.length,s=-1,o=r.length,l=-1,u=e.length,h=S(a-o,0),c=A(h+u),d=!i;++n<h;)c[n]=t[n];for(var f=n;++l<u;)c[f+l]=e[l];for(;++s<o;)(d||n<a)&&(c[f+r[s]]=t[n++]);return c}function k(t,e){var r=-1,i=t.length;for(e=e||A(i);++r<i;)e[r]=t[r];return e}function gr(t,e,r,i){for(var n=!r,a=(r=r||{},-1),s=e.length;++a<s;){var o=e[a],l=i?i(r[o],t[o],o,r,t):ja;(n?Jt:qt)(r,o,l=l===ja?t[o]:l)}return r}function vr(n,a){return function(t,e){var r=j(t)?Io:Qt,i=a?a():{};return r(t,n,c(e,2),i)}}function mr(o){return s(function(t,e){var r=-1,i=e.length,n=1<i?e[i-1]:ja,a=2<i?e[2]:ja,n=3<o.length&&"function"==typeof n?(i--,n):ja;for(a&&d(e[0],e[1],a)&&(n=i<3?ja:n,i=1),t=g(t);++r<i;){var s=e[r];s&&o(t,s,r,n)}return t})}function yr(a,s){return function(t,e){if(null!=t){if(!h(t))return a(t,e);for(var r=t.length,i=s?r:-1,n=g(t);(s?i--:++i<r)&&!1!==e(n[i],i,n););}return t}}function Er(l){return function(t,e,r){for(var i=-1,n=g(t),a=r(t),s=a.length;s--;){var o=a[l?s:++i];if(!1===e(n[o],o,n))break}return t}}function Tr(i){return function(t){var e=ds(t=f(t))?gs(t):ja,r=e?e[0]:t.charAt(0),e=e?or(e,1).join(""):t.slice(1);return r[i]()+e}}function br(e){return function(t){return Oo(fa(aa(t).replace(po,"")),e,"")}}function Ar(i){return function(){var t=arguments;switch(t.length){case 0:return new i;case 1:return new i(t[0]);case 2:return new i(t[0],t[1]);case 3:return new i(t[0],t[1],t[2]);case 4:return new i(t[0],t[1],t[2],t[3]);case 5:return new i(t[0],t[1],t[2],t[3],t[4]);case 6:return new i(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new i(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=Ft(i.prototype),r=i.apply(e,t);return b(r)?r:e}}function _r(a,s,o){var l=Ar(a);return function t(){for(var e=arguments.length,r=A(e),i=e,n=qr(t);i--;)r[i]=arguments[i];n=e<3&&r[0]!==n&&r[e-1]!==n?[]:fs(r,n);return(e-=n.length)<o?Or(a,s,kr,t.placeholder,ja,r,n,ja,ja,o-e):as(this&&this!==ns&&this instanceof t?l:a,this,r)}}function Sr(a){return function(t,e,r){var i,n=g(t),e=(h(t)||(i=c(e,3),t=I(t),e=function(t){return i(n[t],t,n)}),a(t,e,r));return-1<e?n[i?t[e]:e]:ja}}function Lr(l){return Kr(function(n){var a=n.length,t=a,e=v.prototype.thru;for(l&&n.reverse();t--;){var r=n[t];if("function"!=typeof r)throw new _(Ga);e&&!o&&"wrapper"==Yr(r)&&(o=new v([],!0))}for(t=o?t:a;++t<a;)var i=Yr(r=n[t]),s="wrapper"==i?Wr(r):ja,o=s&&ai(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?o[Yr(s[0])].apply(o,s[3]):1==r.length&&ai(r)?o[i]():o.thru(r);return function(){var t=arguments,e=t[0];if(o&&1==t.length&&j(e))return o.plant(e).value();for(var r=0,i=a?n[r].apply(this,t):e;++r<a;)i=n[r].call(this,i);return i}})}function kr(s,o,l,u,h,c,d,f,p,g){var v=128&o,m=1&o,y=2&o,E=24&o,T=512&o,b=y?ja:Ar(s);return function t(){for(var e,r,i,n=A(i=arguments.length),a=i;a--;)n[a]=arguments[a];return E&&(r=function(t,e){for(var r=t.length,i=0;r--;)t[r]===e&&++i;return i}(n,e=qr(t))),u&&(n=fr(n,u,h,E)),c&&(n=pr(n,c,d,E)),i-=r,E&&i<g?(r=fs(n,e),Or(s,o,kr,t.placeholder,l,n,r,f,p,g-i)):(e=m?l:this,r=y?e[s]:s,i=n.length,f?n=function(t,e){for(var r=t.length,i=L(e.length,r),n=k(t);i--;){var a=e[i];t[i]=ii(a,r)?n[a]:ja}return t}(n,f):T&&1<i&&n.reverse(),v&&p<i&&(n.length=p),(r=this&&this!==ns&&this instanceof t?b||Ar(r):r).apply(e,n))}}function Rr(r,s){return function(t,e){return t=t,i=r,n=s(e),a={},ce(t,function(t,e,r){i(a,n(t),e,r)}),a;var i,n,a}}function wr(i,n){return function(t,e){var r;if(t===ja&&e===ja)return n;if(t!==ja&&(r=t),e!==ja){if(r===ja)return e;e=("string"==typeof t||"string"==typeof e?(t=u(t),u):(t=ze(t),ze))(e),r=i(t,e)}return r}}function Ir(i){return Kr(function(t){return t=ls(t,cs(c())),s(function(e){var r=this;return i(t,function(t){return as(t,r,e)})})})}function Dr(t,e){var r=(e=e===ja?" ":u(e)).length;return r<2?r?Ue(e,t):e:(r=Ue(e,ft(t/ps(e))),ds(e)?or(gs(r),0,t).join(""):r.slice(0,t))}function Cr(o,t,l,u){var h=1&t,c=Ar(o);return function t(){for(var e=-1,r=arguments.length,i=-1,n=u.length,a=A(n+r),s=this&&this!==ns&&this instanceof t?c:o;++i<n;)a[i]=u[i];for(;r--;)a[i++]=arguments[++e];return as(s,h?l:this,a)}}function Pr(u){return function(t,e,r){r&&"number"!=typeof r&&d(t,e,r)&&(e=r=ja),t=On(t),e===ja?(e=t,t=0):e=On(e),r=r===ja?t<e?1:-1:On(r);for(var i=t,n=r,a=u,s=-1,o=S(ft((e-i)/(n||1)),0),l=A(o);o--;)l[a?o:++s]=i,i+=n;return l}}function xr(r){return function(t,e){return"string"==typeof t&&"string"==typeof e||(t=w(t),e=w(e)),r(t,e)}}function Or(t,e,r,i,n,a,s,o,l,u){var h=8&e,n=(4&(e=(e|(h?32:64))&~(h?64:32))||(e&=-4),[t,e,n,h?a:ja,h?s:ja,h?ja:a,h?ja:s,o,l,u]),a=r.apply(ja,n);return ai(t)&&fi(a,n),a.placeholder=i,vi(a,t,e)}function Mr(t){var i=O[t];return function(t,e){var r;return t=w(t),(e=null==e?0:L(R(e),292))&&vt(t)?(r=(f(t)+"e").split("e"),+((r=(f(i(r[0]+"e"+(+r[1]+e)))+"e").split("e"))[0]+"e"+(+r[1]-e))):i(t)}}var Fr=Lt&&1/rl(new Lt([,-0]))[1]==1/0?function(t){return new Lt(t)}:_a;function Nr(a){return function(t){var e,r,i,n=B(t);return n==Ya?tl(t):n==Xa?(n=t,e=-1,r=Array(n.size),n.forEach(function(t){r[++e]=[t,t]}),r):ls(a(i=t),function(t){return[t,i[t]]})}}function Br(t,e,r,i,n,a,s,o){var l,u,h,c,d,f,p,g,v,m,y,E,T,b=2&e;if(b||"function"==typeof t)return(l=i?i.length:0)||(e&=-97,i=n=ja),s=s===ja?s:S(R(s),0),o=o===ja?o:R(o),l-=n?n.length:0,64&e&&(h=i,c=n,i=n=ja),u=b?ja:Wr(t),h=[t,e,r,i,n,h,c,a,s,o],u&&(c=u,s=(a=h)[1],f=c[1],g=(p=s|f)<131,v=128==f&&8==s||128==f&&256==s&&a[7].length<=c[8]||384==f&&c[7].length<=c[8]&&8==s,g||v)&&(1&f&&(a[2]=c[2],p|=1&s?0:4),(g=c[3])&&(d=a[3],a[3]=d?fr(d,g,c[4]):g,a[4]=d?fs(a[3],ms):c[4]),(g=c[5])&&(d=a[5],a[5]=d?pr(d,g,c[6]):g,a[6]=d?fs(a[5],ms):c[6]),(g=c[7])&&(a[7]=g),128&f&&(a[8]=null==a[8]?c[8]:L(a[8],c[8])),null==a[9]&&(a[9]=c[9]),a[0]=c[0],a[1]=p),t=h[0],e=h[1],r=h[2],i=h[3],n=h[4],!(o=h[9]=h[9]===ja?b?0:t.length:S(h[9]-l,0))&&24&e&&(e&=-25),v=e&&1!=e?8==e||16==e?_r(t,e,o):32!=e&&33!=e||n.length?kr.apply(ja,h):Cr(t,e,r,i):(y=r,E=1&e,T=Ar(m=t),function t(){return(this&&this!==ns&&this instanceof t?T:m).apply(E?y:this,arguments)}),vi((u?Ke:fi)(v,h),t,e);throw new _(Ga)}function Ur(t,e,r,i){return t===ja||U(t,V[r])&&!F.call(i,r)?e:t}function jr(t,e,r,i,n,a){return b(t)&&b(e)&&(a.set(e,t),Pe(t,e,ja,jr,a),a.delete(e)),t}function Gr(t){return kn(t)?ja:t}function $r(t,e,r,i,n,a){var s=1&r,o=t.length,l=e.length;if(o!=l&&!(s&&o<l))return!1;var l=a.get(t),u=a.get(e);if(l&&u)return l==e&&u==t;var h=-1,c=!0,d=2&r?new $t:ja;for(a.set(t,e),a.set(e,t);++h<o;){var f,p=t[h],g=e[h];if((f=i?s?i(g,p,h,e,t,a):i(p,g,h,t,e,a):f)!==ja){if(f)continue;c=!1;break}if(d){if(!Fo(e,function(t,e){return!qo(d,e)&&(p===t||n(p,t,r,i,a))&&d.push(e)})){c=!1;break}}else if(p!==g&&!n(p,g,r,i,a)){c=!1;break}}return a.delete(t),a.delete(e),c}function Kr(t){return gi(hi(t,ja,ki),t+"")}function Hr(t){return ge(t,I,Jr)}function Vr(t){return ge(t,D,Zr)}var Wr=Rt?function(t){return Rt.get(t)}:_a;function Yr(t){for(var e=t.name+"",r=wt[e],i=F.call(wt,e)?r.length:0;i--;){var n=r[i],a=n.func;if(null==a||a==t)return n.name}return e}function qr(t){return(F.call(p,"placeholder")?p:t).placeholder}function c(){var t=(t=p.iteratee||Ea)===Ea?Le:t;return arguments.length?t(arguments[0],arguments[1]):t}function zr(t,e){var r,i,t=t.__data__;return("string"==(i=typeof(r=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function Qr(t){for(var e=I(t),r=e.length;r--;){var i=e[r],n=t[i];e[r]=[i,n,li(n)]}return e}function Xr(t,e){e=e;t=null==(t=t)?ja:t[e];return Se(t)?t:ja}var Jr=gt?function(e){return null==e?[]:(e=g(e),os(gt(e),function(t){return nt.call(e,t)}))}:Da,Zr=gt?function(t){for(var e=[];t;)us(e,Jr(t)),t=rt(t);return e}:Da,B=r;function ti(t,e,r){for(var i=-1,n=(e=ar(e,t)).length,a=!1;++i<n;){var s=bi(e[i]);if(!(a=null!=t&&r(t,s)))break;t=t[s]}return a||++i!=n?a:!!(n=null==t?0:t.length)&&_n(n)&&ii(s,n)&&(j(t)||mn(t))}function ei(t){return"function"!=typeof t.constructor||oi(t)?{}:Ft(rt(t))}function ri(t){return j(t)||mn(t)||!!(st&&t&&t[st])}function ii(t,e){var r=typeof t;return!!(e=null==e?$a:e)&&("number"==r||"symbol"!=r&&uo.test(t))&&-1<t&&t%1==0&&t<e}function d(t,e,r){var i;if(b(r))return("number"==(i=typeof e)?h(r)&&ii(e,r.length):"string"==i&&e in r)&&U(r[e],t)}function ni(t,e){var r;if(!j(t))return"number"==(r=typeof t)||"symbol"==r||"boolean"==r||null==t||E(t)||Ws.test(t)||!Vs.test(t)||null!=e&&t in g(e)}function ai(t){var e=Yr(t),r=p[e];return"function"==typeof r&&e in m.prototype&&(t===r||(e=Wr(r))&&t===e[0])}(a&&B(new a(new ArrayBuffer(1)))!=es||_t&&B(new _t)!=Ya||St&&B(St.resolve())!=Ss||Lt&&B(new Lt)!=Xa||t&&B(new t)!=Za)&&(B=function(t){var e=r(t),t=e==za?t.constructor:ja,t=t?Ai(t):"";if(t)switch(t){case It:return es;case Dt:return Ya;case Ct:return Ss;case Pt:return Xa;case xt:return Za}return e});var si=W?bn:Ca;function oi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||V)}function li(t){return t==t&&!b(t)}function ui(e,r){return function(t){return null!=t&&t[e]===r&&(r!==ja||e in g(t))}}function hi(a,s,o){return s=S(s===ja?a.length-1:s,0),function(){for(var t=arguments,e=-1,r=S(t.length-s,0),i=A(r);++e<r;)i[e]=t[s+e];for(var e=-1,n=A(s+1);++e<s;)n[e]=t[e];return n[s]=o(i),as(a,this,n)}}function ci(t,e){return e.length<2?t:pe(t,o(e,0,-1))}function di(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var fi=mi(Ke),pi=dt||function(t,e){return ns.setTimeout(t,e)},gi=mi(e);function vi(t,e,r){var i,n,a,e=e+"";return gi(t,(n=(e=(e=t=e).match(Js))?e[1].split(Zs):[],a=r,ss(Es,function(t){var e="_."+t[0];a&t[1]&&!Po(n,e)&&n.push(e)}),e=n.sort(),(r=e.length)?(e[i=r-1]=(1<r?"& ":"")+e[i],e=e.join(2<r?", ":" "),t.replace(Xs,"{\n/* [wrapped with "+e+"] */\n")):t))}function mi(r){var i=0,n=0;return function(){var t=Et(),e=16-(t-n);if(n=t,0<e){if(800<=++i)return arguments[0]}else i=0;return r.apply(ja,arguments)}}function yi(t,e){var r=-1,i=t.length,n=i-1;for(e=e===ja?i:e;++r<e;){var a=Be(r,n),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}Ei=(ht=hn(ht=function(t){var n=[];return 46===t.charCodeAt(0)&&n.push(""),t.replace(Ys,function(t,e,r,i){n.push(r?i.replace(ro,"$1"):e||t)}),n},function(t){return 500===Ei.size&&Ei.clear(),t})).cache;var Ei,Ti=ht;function bi(t){var e;return"string"==typeof t||E(t)?t:"0"==(e=t+"")&&1/t==-1/0?"-0":e}function Ai(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function _i(t){var e;return t instanceof m?t.clone():((e=new v(t.__wrapped__,t.__chain__)).__actions__=k(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e)}a=s(function(t,e){return T(t)?ie(t,l(e,1,T,!0)):[]}),St=s(function(t,e){var r=i(e);return T(r)&&(r=ja),T(t)?ie(t,l(e,1,T,!0),c(r,2)):[]}),t=s(function(t,e){var r=i(e);return T(r)&&(r=ja),T(t)?ie(t,l(e,1,T,!0),ja,r):[]});function Si(t,e,r){var i=null==t?0:t.length;return i?((r=null==r?0:R(r))<0&&(r=S(i+r,0)),Bo(t,c(e,3),r)):-1}function Li(t,e,r){var i,n=null==t?0:t.length;return n?(i=n-1,r!==ja&&(i=R(r),i=r<0?S(n+i,0):L(i,n-1)),Bo(t,c(e,3),i,!0)):-1}function ki(t){return(null==t?0:t.length)?l(t,1):[]}function Ri(t){return t&&t.length?t[0]:ja}W=s(function(t){var e=ls(t,ir);return e.length&&e[0]===t[0]?Ee(e):[]}),dt=s(function(t){var e=i(t),r=ls(t,ir);return e===i(r)?e=ja:r.pop(),r.length&&r[0]===t[0]?Ee(r,c(e,2)):[]}),e=s(function(t){var e=i(t),r=ls(t,ir);return(e="function"==typeof e?e:ja)&&r.pop(),r.length&&r[0]===t[0]?Ee(r,ja,e):[]});function i(t){var e=null==t?0:t.length;return e?t[e-1]:ja}ht=s(wi);function wi(t,e){return t&&t.length&&e&&e.length?Fe(t,e):t}var Ii=Kr(function(t,e){var r=null==t?0:t.length,i=Zt(t,e);return Ne(t,ls(e,function(t){return ii(t,r)?+t:t}).sort(dr)),i});function Di(t){return null==t?t:At.call(t)}var Ci=s(function(t){return Qe(l(t,1,T,!0))}),Pi=s(function(t){var e=i(t);return T(e)&&(e=ja),Qe(l(t,1,T,!0),c(e,2))}),xi=s(function(t){var e="function"==typeof(e=i(t))?e:ja;return Qe(l(t,1,T,!0),ja,e)});function Oi(e){var r;return e&&e.length?(r=0,e=os(e,function(t){return T(t)&&(r=S(t.length,r),1)}),Vo(r,function(t){return ls(e,$o(t))})):[]}function Mi(t,e){return t&&t.length?(t=Oi(t),null==e?t:ls(t,function(t){return as(e,ja,t)})):[]}var Fi=s(function(t,e){return T(t)?ie(t,e):[]}),Ni=s(function(t){return er(os(t,T))}),Bi=s(function(t){var e=i(t);return T(e)&&(e=ja),er(os(t,T),c(e,2))}),Ui=s(function(t){var e="function"==typeof(e=i(t))?e:ja;return er(os(t,T),ja,e)}),ji=s(Oi);var Gi=s(function(t){var e=t.length,e="function"==typeof(e=1<e?t[e-1]:ja)?(t.pop(),e):ja;return Mi(t,e)});function $i(t){t=p(t);return t.__chain__=!0,t}function Ki(t,e){return e(t)}var Hi=Kr(function(e){function t(t){return Zt(t,e)}var r=e.length,i=r?e[0]:0,n=this.__wrapped__;return!(1<r||this.__actions__.length)&&n instanceof m&&ii(i)?((n=n.slice(i,+i+(r?1:0))).__actions__.push({func:Ki,args:[t],thisArg:ja}),new v(n,this.__chain__).thru(function(t){return r&&!t.length&&t.push(ja),t})):this.thru(t)});var Vi=vr(function(t,e,r){F.call(t,r)?++t[r]:Jt(t,r,1)});var Wi=Sr(Si),Yi=Sr(Li);function qi(t,e){return(j(t)?ss:ne)(t,c(e,3))}function zi(t,e){return(j(t)?Do:ae)(t,c(e,3))}var Qi=vr(function(t,e,r){F.call(t,r)?t[r].push(e):Jt(t,r,[e])});var Xi=s(function(t,e,r){var i=-1,n="function"==typeof e,a=h(t)?A(t.length):[];return ne(t,function(t){a[++i]=n?as(e,t,r):Te(t,e,r)}),a}),Ji=vr(function(t,e,r){Jt(t,r,e)});function Zi(t,e){return(j(t)?ls:Ie)(t,c(e,3))}var tn=vr(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]});var en=s(function(t,e){var r;return null==t?[]:(1<(r=e.length)&&d(t,e[0],e[1])?e=[]:2<r&&d(e[0],e[1],e[2])&&(e=[e[0]]),Oe(t,l(e,1),[]))}),rn=ct||function(){return ns.Date.now()};function nn(t,e,r){return e=r?ja:e,e=t&&null==e?t.length:e,Br(t,128,ja,ja,ja,ja,e)}function an(t,e){var r;if("function"!=typeof e)throw new _(Ga);return t=R(t),function(){return 0<--t&&(r=e.apply(this,arguments)),t<=1&&(e=ja),r}}var sn=s(function(t,e,r){var i,n=1;return r.length&&(i=fs(r,qr(sn)),n|=32),Br(t,n,e,r,i)}),on=s(function(t,e,r){var i,n=3;return r.length&&(i=fs(r,qr(on)),n|=32),Br(e,n,t,r,i)});function ln(i,r,t){var n,a,s,o,l,u,h=0,c=!1,d=!1,e=!0;if("function"!=typeof i)throw new _(Ga);function f(t){var e=n,r=a;return n=a=ja,h=t,o=i.apply(r,e)}function p(t){var e=t-u;return u===ja||r<=e||e<0||d&&s<=t-h}function g(){var t,e=rn();if(p(e))return v(e);l=pi(g,(t=r-((e=e)-u),d?L(t,s-(e-h)):t))}function v(t){return l=ja,e&&n?f(t):(n=a=ja,o)}function m(){var t=rn(),e=p(t);if(n=arguments,a=this,u=t,e){if(l===ja)return h=t=u,l=pi(g,r),c?f(t):o;if(d)return lr(l),l=pi(g,r),f(u)}return l===ja&&(l=pi(g,r)),o}return r=w(r)||0,b(t)&&(c=!!t.leading,d="maxWait"in t,s=d?S(w(t.maxWait)||0,r):s,e="trailing"in t?!!t.trailing:e),m.cancel=function(){l!==ja&&lr(l),h=0,n=u=a=l=ja},m.flush=function(){return l===ja?o:v(rn())},m}var ct=s(function(t,e){return re(t,1,e)}),un=s(function(t,e,r){return re(t,w(e)||0,r)});function hn(i,n){if("function"!=typeof i||null!=n&&"function"!=typeof n)throw new _(Ga);function a(){var t=arguments,e=n?n.apply(this,t):t[0],r=a.cache;return r.has(e)?r.get(e):(t=i.apply(this,t),a.cache=r.set(e,t)||r,t)}return a.cache=new(hn.Cache||Gt),a}function cn(e){if("function"!=typeof e)throw new _(Ga);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}hn.Cache=Gt;var sr=sr(function(i,n){var a=(n=1==n.length&&j(n[0])?ls(n[0],cs(c())):ls(l(n,1),cs(c()))).length;return s(function(t){for(var e=-1,r=L(t.length,a);++e<r;)t[e]=n[e].call(this,t[e]);return as(i,this,t)})}),dn=s(function(t,e){var r=fs(e,qr(dn));return Br(t,32,ja,e,r)}),fn=s(function(t,e){var r=fs(e,qr(fn));return Br(t,64,ja,e,r)}),pn=Kr(function(t,e){return Br(t,256,ja,ja,ja,e)});function U(t,e){return t===e||t!=t&&e!=e}var gn=xr(ve),vn=xr(function(t,e){return e<=t}),mn=be(function(){return arguments}())?be:function(t){return G(t)&&F.call(t,"callee")&&!nt.call(t,"callee")},j=A.isArray,yn=_o?cs(_o):function(t){return G(t)&&r(t)==ts};function h(t){return null!=t&&_n(t.length)&&!bn(t)}function T(t){return G(t)&&h(t)}var En=H||Ca,H=So?cs(So):function(t){return G(t)&&r(t)==Wa};function Tn(t){var e;return!!G(t)&&((e=r(t))==bs||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!kn(t))}function bn(t){return!!b(t)&&((t=r(t))==As||t==_s||"[object AsyncFunction]"==t||"[object Proxy]"==t)}function An(t){return"number"==typeof t&&t==R(t)}function _n(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=$a}function b(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function G(t){return null!=t&&"object"==typeof t}var Sn=Lo?cs(Lo):function(t){return G(t)&&B(t)==Ya};function Ln(t){return"number"==typeof t||G(t)&&r(t)==qa}function kn(t){return!(!G(t)||r(t)!=za)&&(null===(t=rt(t))||"function"==typeof(t=F.call(t,"constructor")&&t.constructor)&&t instanceof t&&Y.call(t)==X)}var Rn=ko?cs(ko):function(t){return G(t)&&r(t)==Qa};var wn=Ro?cs(Ro):function(t){return G(t)&&B(t)==Xa};function In(t){return"string"==typeof t||!j(t)&&G(t)&&r(t)==Ja}function E(t){return"symbol"==typeof t||G(t)&&r(t)==Ls}var Dn=wo?cs(wo):function(t){return G(t)&&_n(t.length)&&!!rs[r(t)]};var Cn=xr(we),Pn=xr(function(t,e){return t<=e});function xn(t){if(!t)return[];if(h(t))return(In(t)?gs:k)(t);if(ot&&t[ot]){for(var e,r=t[ot](),i=[];!(e=r.next()).done;)i.push(e.value);return i}var n=B(t);return(n==Ya?tl:n==Xa?rl:ra)(t)}function On(t){return t?(t=w(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function R(t){var t=On(t),e=t%1;return t==t?e?t-e:t:0}function Mn(t){return t?te(R(t),0,Ka):0}function w(t){if("number"==typeof t)return t;if(E(t))return ys;if("string"!=typeof(t=b(t)?b(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e:t))return 0===t?t:+t;t=Wo(t);var e=so.test(t);return e||lo.test(t)?bo(t.slice(2),e?2:8):ao.test(t)?ys:+t}function Fn(t){return gr(t,D(t))}function f(t){return null==t?"":u(t)}var Nn=mr(function(t,e){if(oi(e)||h(e))gr(e,I(e),t);else for(var r in e)F.call(e,r)&&qt(t,r,e[r])}),Bn=mr(function(t,e){gr(e,D(e),t)}),Un=mr(function(t,e,r,i){gr(e,D(e),t,i)}),jn=mr(function(t,e,r,i){gr(e,I(e),t,i)}),Gn=Kr(Zt);var $n=s(function(t,e){t=g(t);var r=-1,i=e.length,n=2<i?e[2]:ja;for(n&&d(e[0],e[1],n)&&(i=1);++r<i;)for(var a=e[r],s=D(a),o=-1,l=s.length;++o<l;){var u=s[o],h=t[u];(h===ja||U(h,V[u])&&!F.call(t,u))&&(t[u]=a[u])}return t}),Kn=s(function(t){return t.push(ja,jr),as(Qn,ja,t)});function Hn(t,e,r){t=null==t?ja:pe(t,e);return t===ja?r:t}function Vn(t,e){return null!=t&&ti(t,e,ye)}var Wn=Rr(function(t,e,r){t[e=null!=e&&"function"!=typeof e.toString?Q.call(e):e]=r},va(C)),Yn=Rr(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Q.call(e)),F.call(t,e)?t[e].push(r):t[e]=[r]},c),qn=s(Te);function I(t){return(h(t)?Kt:ke)(t)}function D(t){return h(t)?Kt(t,!0):Re(t)}var zn=mr(function(t,e,r){Pe(t,e,r)}),Qn=mr(function(t,e,r,i){Pe(t,e,r,i)}),Xn=Kr(function(e,t){var r={};if(null!=e)for(var i=!1,n=(t=ls(t,function(t){return t=ar(t,e),i=i||1<t.length,t}),gr(e,Vr(e),r),i&&(r=y(r,7,Gr)),t.length);n--;)Xe(r,t[n]);return r});var Jn=Kr(function(t,e){return null==t?{}:Me(r=t,e,function(t,e){return Vn(r,e)});var r});function Zn(t,r){var e;return null==t?{}:(e=ls(Vr(t),function(t){return[t]}),r=c(r),Me(t,e,function(t,e){return r(t,e[0])}))}var ta=Nr(I),ea=Nr(D);function ra(t){return null==t?[]:Yo(t,I(t))}var ia=br(function(t,e,r){return e=e.toLowerCase(),t+(r?na(e):e)});function na(t){return da(f(t).toLowerCase())}function aa(t){return(t=f(t))&&t.replace(ho,Xo).replace(go,"")}var sa=br(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),oa=br(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),la=Tr("toLowerCase");var ua=br(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()});var ha=br(function(t,e,r){return t+(r?" ":"")+da(e)});var ca=br(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),da=Tr("toUpperCase");function fa(t,e,r){return t=f(t),(e=r?ja:e)===ja?(r=t,mo.test(r)?t.match(vo)||[]:t.match(to)||[]):t.match(e)||[]}var pa=s(function(t,e){try{return as(t,ja,e)}catch(t){return Tn(t)?t:new P(t)}}),ga=Kr(function(e,t){return ss(t,function(t){t=bi(t),Jt(e,t,sn(e[t],e))}),e});function va(t){return function(){return t}}var ma=Lr(),ya=Lr(!0);function C(t){return t}function Ea(t){return Le("function"==typeof t?t:y(t,1))}var Ta=s(function(e,r){return function(t){return Te(t,e,r)}}),ba=s(function(e,r){return function(t){return Te(e,t,r)}});function Aa(i,e,t){var r=I(e),n=fe(e,r),a=(null!=t||b(e)&&(n.length||!r.length)||(t=e,e=i,i=this,n=fe(e,I(e))),!(b(t)&&"chain"in t&&!t.chain)),s=bn(i);return ss(n,function(t){var r=e[t];i[t]=r,s&&(i.prototype[t]=function(){var t,e=this.__chain__;return a||e?(((t=i(this.__wrapped__)).__actions__=k(this.__actions__)).push({func:r,args:arguments,thisArg:i}),t.__chain__=e,t):r.apply(i,us([this.value()],arguments))})}),i}function _a(){}var Sa=Ir(ls),La=Ir(Co),ka=Ir(Fo);function Ra(t){return ni(t)?$o(bi(t)):(e=t,function(t){return pe(t,e)});var e}var wa=Pr(),Ia=Pr(!0);function Da(){return[]}function Ca(){return!1}var Pa=wr(function(t,e){return t+e},0),xa=Mr("ceil"),Oa=wr(function(t,e){return t/e},1),Ma=Mr("floor");var Fa,Na=wr(function(t,e){return t*e},1),Ba=Mr("round"),Ua=wr(function(t,e){return t-e},0);return p.after=function(t,e){if("function"!=typeof e)throw new _(Ga);return t=R(t),function(){if(--t<1)return e.apply(this,arguments)}},p.ary=nn,p.assign=Nn,p.assignIn=Bn,p.assignInWith=Un,p.assignWith=jn,p.at=Gn,p.before=an,p.bind=sn,p.bindAll=ga,p.bindKey=on,p.castArray=function(){var t;return arguments.length?j(t=arguments[0])?t:[t]:[]},p.chain=$i,p.chunk=function(t,e,r){e=(r?d(t,e,r):e===ja)?1:S(R(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var n=0,a=0,s=A(ft(i/e));n<i;)s[a++]=o(t,n,n+=e);return s},p.compact=function(t){for(var e=-1,r=null==t?0:t.length,i=0,n=[];++e<r;){var a=t[e];a&&(n[i++]=a)}return n},p.concat=function(){var t=arguments.length;if(!t)return[];for(var e=A(t-1),r=arguments[0],i=t;i--;)e[i-1]=arguments[i];return us(j(r)?k(r):[r],l(e,1))},p.cond=function(i){var n=null==i?0:i.length,e=c();return i=n?ls(i,function(t){if("function"!=typeof t[1])throw new _(Ga);return[e(t[0]),t[1]]}):[],s(function(t){for(var e=-1;++e<n;){var r=i[e];if(as(r[0],this,t))return as(r[1],this,t)}})},p.conforms=function(t){return e=y(t,1),r=I(e),function(t){return ee(t,e,r)};var e,r},p.constant=va,p.countBy=Vi,p.create=function(t,e){return t=Ft(t),null==e?t:Xt(t,e)},p.curry=function t(e,r,i){e=Br(e,8,ja,ja,ja,ja,ja,r=i?ja:r);return e.placeholder=t.placeholder,e},p.curryRight=function t(e,r,i){e=Br(e,16,ja,ja,ja,ja,ja,r=i?ja:r);return e.placeholder=t.placeholder,e},p.debounce=ln,p.defaults=$n,p.defaultsDeep=Kn,p.defer=ct,p.delay=un,p.difference=a,p.differenceBy=St,p.differenceWith=t,p.drop=function(t,e,r){var i=null==t?0:t.length;return i?o(t,(e=r||e===ja?1:R(e))<0?0:e,i):[]},p.dropRight=function(t,e,r){var i=null==t?0:t.length;return i?o(t,0,(e=i-(e=r||e===ja?1:R(e)))<0?0:e):[]},p.dropRightWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!0,!0):[]},p.dropWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!0):[]},p.fill=function(t,e,r,i){if(!(l=null==t?0:t.length))return[];r&&"number"!=typeof r&&d(t,e,r)&&(r=0,i=l);var n=t,a=e,s=r,o=i,l=n.length;for((s=R(s))<0&&(s=l<-s?0:l+s),(o=o===ja||l<o?l:R(o))<0&&(o+=l),o=o<s?0:Mn(o);s<o;)n[s++]=a;return n},p.filter=function(t,e){return(j(t)?os:le)(t,c(e,3))},p.flatMap=function(t,e){return l(Zi(t,e),1)},p.flatMapDeep=function(t,e){return l(Zi(t,e),1/0)},p.flatMapDepth=function(t,e,r){return r=r===ja?1:R(r),l(Zi(t,e),r)},p.flatten=ki,p.flattenDeep=function(t){return(null==t?0:t.length)?l(t,1/0):[]},p.flattenDepth=function(t,e){return(null==t?0:t.length)?l(t,e=e===ja?1:R(e)):[]},p.flip=function(t){return Br(t,512)},p.flow=ma,p.flowRight=ya,p.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,i={};++e<r;){var n=t[e];i[n[0]]=n[1]}return i},p.functions=function(t){return null==t?[]:fe(t,I(t))},p.functionsIn=function(t){return null==t?[]:fe(t,D(t))},p.groupBy=Qi,p.initial=function(t){return(null==t?0:t.length)?o(t,0,-1):[]},p.intersection=W,p.intersectionBy=dt,p.intersectionWith=e,p.invert=Wn,p.invertBy=Yn,p.invokeMap=Xi,p.iteratee=Ea,p.keyBy=Ji,p.keys=I,p.keysIn=D,p.map=Zi,p.mapKeys=function(t,i){var n={};return i=c(i,3),ce(t,function(t,e,r){Jt(n,i(t,e,r),t)}),n},p.mapValues=function(t,i){var n={};return i=c(i,3),ce(t,function(t,e,r){Jt(n,e,i(t,e,r))}),n},p.matches=function(t){return De(y(t,1))},p.matchesProperty=function(t,e){return Ce(t,y(e,1))},p.memoize=hn,p.merge=zn,p.mergeWith=Qn,p.method=Ta,p.methodOf=ba,p.mixin=Aa,p.negate=cn,p.nthArg=function(e){return e=R(e),s(function(t){return xe(t,e)})},p.omit=Xn,p.omitBy=function(t,e){return Zn(t,cn(c(e)))},p.once=function(t){return an(2,t)},p.orderBy=function(t,e,r,i){return null==t?[]:Oe(t,e=j(e)?e:null==e?[]:[e],r=j(r=i?ja:r)?r:null==r?[]:[r])},p.over=Sa,p.overArgs=sr,p.overEvery=La,p.overSome=ka,p.partial=dn,p.partialRight=fn,p.partition=tn,p.pick=Jn,p.pickBy=Zn,p.property=Ra,p.propertyOf=function(e){return function(t){return null==e?ja:pe(e,t)}},p.pull=ht,p.pullAll=wi,p.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Fe(t,e,c(r,2)):t},p.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Fe(t,e,ja,r):t},p.pullAt=Ii,p.range=wa,p.rangeRight=Ia,p.rearg=pn,p.reject=function(t,e){return(j(t)?os:le)(t,cn(c(e,3)))},p.remove=function(t,e){var r=[];if(t&&t.length){var i=-1,n=[],a=t.length;for(e=c(e,3);++i<a;){var s=t[i];e(s,i,t)&&(r.push(s),n.push(i))}Ne(t,n)}return r},p.rest=function(t,e){if("function"!=typeof t)throw new _(Ga);return s(t,e=e===ja?e:R(e))},p.reverse=Di,p.sampleSize=function(t,e,r){return e=(r?d(t,e,r):e===ja)?1:R(e),(j(t)?Vt:Ge)(t,e)},p.set=function(t,e,r){return null==t?t:$e(t,e,r)},p.setWith=function(t,e,r,i){return i="function"==typeof i?i:ja,null==t?t:$e(t,e,r,i)},p.shuffle=function(t){return(j(t)?Wt:He)(t)},p.slice=function(t,e,r){var i=null==t?0:t.length;return i?(r=r&&"number"!=typeof r&&d(t,e,r)?(e=0,i):(e=null==e?0:R(e),r===ja?i:R(r)),o(t,e,r)):[]},p.sortBy=en,p.sortedUniq=function(t){return t&&t.length?qe(t):[]},p.sortedUniqBy=function(t,e){return t&&t.length?qe(t,c(e,2)):[]},p.split=function(t,e,r){return r&&"number"!=typeof r&&d(t,e,r)&&(e=r=ja),(r=r===ja?Ka:r>>>0)?(t=f(t))&&("string"==typeof e||null!=e&&!Rn(e))&&!(e=u(e))&&ds(t)?or(gs(t),0,r):t.split(e,r):[]},p.spread=function(r,i){if("function"!=typeof r)throw new _(Ga);return i=null==i?0:S(R(i),0),s(function(t){var e=t[i],t=or(t,0,i);return e&&us(t,e),as(r,this,t)})},p.tail=function(t){var e=null==t?0:t.length;return e?o(t,1,e):[]},p.take=function(t,e,r){return t&&t.length?o(t,0,(e=r||e===ja?1:R(e))<0?0:e):[]},p.takeRight=function(t,e,r){var i=null==t?0:t.length;return i?o(t,(e=i-(e=r||e===ja?1:R(e)))<0?0:e,i):[]},p.takeRightWhile=function(t,e){return t&&t.length?Ze(t,c(e,3),!1,!0):[]},p.takeWhile=function(t,e){return t&&t.length?Ze(t,c(e,3)):[]},p.tap=function(t,e){return e(t),t},p.throttle=function(t,e,r){var i=!0,n=!0;if("function"!=typeof t)throw new _(Ga);return b(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),ln(t,e,{leading:i,maxWait:e,trailing:n})},p.thru=Ki,p.toArray=xn,p.toPairs=ta,p.toPairsIn=ea,p.toPath=function(t){return j(t)?ls(t,bi):E(t)?[t]:k(Ti(f(t)))},p.toPlainObject=Fn,p.transform=function(t,i,n){var e,r=j(t),a=r||En(t)||Dn(t);return i=c(i,4),null==n&&(e=t&&t.constructor,n=a?r?new e:[]:b(t)&&bn(e)?Ft(rt(t)):{}),(a?ss:ce)(t,function(t,e,r){return i(n,t,e,r)}),n},p.unary=function(t){return nn(t,1)},p.union=Ci,p.unionBy=Pi,p.unionWith=xi,p.uniq=function(t){return t&&t.length?Qe(t):[]},p.uniqBy=function(t,e){return t&&t.length?Qe(t,c(e,2)):[]},p.uniqWith=function(t,e){return e="function"==typeof e?e:ja,t&&t.length?Qe(t,ja,e):[]},p.unset=function(t,e){return null==t||Xe(t,e)},p.unzip=Oi,p.unzipWith=Mi,p.update=function(t,e,r){return null==t?t:Je(t,e,nr(r))},p.updateWith=function(t,e,r,i){return i="function"==typeof i?i:ja,null==t?t:Je(t,e,nr(r),i)},p.values=ra,p.valuesIn=function(t){return null==t?[]:Yo(t,D(t))},p.without=Fi,p.words=fa,p.wrap=function(t,e){return dn(nr(e),t)},p.xor=Ni,p.xorBy=Bi,p.xorWith=Ui,p.zip=ji,p.zipObject=function(t,e){return rr(t||[],e||[],qt)},p.zipObjectDeep=function(t,e){return rr(t||[],e||[],$e)},p.zipWith=Gi,p.entries=ta,p.entriesIn=ea,p.extend=Bn,p.extendWith=Un,Aa(p,p),p.add=Pa,p.attempt=pa,p.camelCase=ia,p.capitalize=na,p.ceil=xa,p.clamp=function(t,e,r){return r===ja&&(r=e,e=ja),r!==ja&&(r=(r=w(r))==r?r:0),e!==ja&&(e=(e=w(e))==e?e:0),te(w(t),e,r)},p.clone=function(t){return y(t,4)},p.cloneDeep=function(t){return y(t,5)},p.cloneDeepWith=function(t,e){return y(t,5,e="function"==typeof e?e:ja)},p.cloneWith=function(t,e){return y(t,4,e="function"==typeof e?e:ja)},p.conformsTo=function(t,e){return null==e||ee(t,e,I(e))},p.deburr=aa,p.defaultTo=function(t,e){return null==t||t!=t?e:t},p.divide=Oa,p.endsWith=function(t,e,r){t=f(t),e=u(e);var i=t.length,i=r=r===ja?i:te(R(r),0,i);return 0<=(r-=e.length)&&t.slice(r,i)==e},p.eq=U,p.escape=function(t){return(t=f(t))&&Gs.test(t)?t.replace(Us,Jo):t},p.escapeRegExp=function(t){return(t=f(t))&&zs.test(t)?t.replace(qs,"\\$&"):t},p.every=function(t,e,r){return(j(t)?Co:se)(t,c(e=r&&d(t,e,r)?ja:e,3))},p.find=Wi,p.findIndex=Si,p.findKey=function(t,e){return No(t,c(e,3),ce)},p.findLast=Yi,p.findLastIndex=Li,p.findLastKey=function(t,e){return No(t,c(e,3),de)},p.floor=Ma,p.forEach=qi,p.forEachRight=zi,p.forIn=function(t,e){return null==t?t:ue(t,c(e,3),D)},p.forInRight=function(t,e){return null==t?t:he(t,c(e,3),D)},p.forOwn=function(t,e){return t&&ce(t,c(e,3))},p.forOwnRight=function(t,e){return t&&de(t,c(e,3))},p.get=Hn,p.gt=gn,p.gte=vn,p.has=function(t,e){return null!=t&&ti(t,e,me)},p.hasIn=Vn,p.head=Ri,p.identity=C,p.includes=function(t,e,r,i){return t=h(t)?t:ra(t),r=r&&!i?R(r):0,i=t.length,r<0&&(r=S(i+r,0)),In(t)?r<=i&&-1<t.indexOf(e,r):!!i&&-1<hs(t,e,r)},p.indexOf=function(t,e,r){var i=null==t?0:t.length;return i?hs(t,e,t=(t=null==r?0:R(r))<0?S(i+t,0):t):-1},p.inRange=function(t,e,r){return e=On(e),r===ja?(r=e,e=0):r=On(r),(t=t=w(t))>=L(e=e,r=r)&&t<S(e,r)},p.invoke=qn,p.isArguments=mn,p.isArray=j,p.isArrayBuffer=yn,p.isArrayLike=h,p.isArrayLikeObject=T,p.isBoolean=function(t){return!0===t||!1===t||G(t)&&r(t)==Va},p.isBuffer=En,p.isDate=H,p.isElement=function(t){return G(t)&&1===t.nodeType&&!kn(t)},p.isEmpty=function(t){if(null!=t){if(h(t)&&(j(t)||"string"==typeof t||"function"==typeof t.splice||En(t)||Dn(t)||mn(t)))return!t.length;var e,r=B(t);if(r==Ya||r==Xa)return!t.size;if(oi(t))return!ke(t).length;for(e in t)if(F.call(t,e))return!1}return!0},p.isEqual=function(t,e){return Ae(t,e)},p.isEqualWith=function(t,e,r){var i=(r="function"==typeof r?r:ja)?r(t,e):ja;return i===ja?Ae(t,e,ja,r):!!i},p.isError=Tn,p.isFinite=function(t){return"number"==typeof t&&vt(t)},p.isFunction=bn,p.isInteger=An,p.isLength=_n,p.isMap=Sn,p.isMatch=function(t,e){return t===e||_e(t,e,Qr(e))},p.isMatchWith=function(t,e,r){return r="function"==typeof r?r:ja,_e(t,e,Qr(e),r)},p.isNaN=function(t){return Ln(t)&&t!=+t},p.isNative=function(t){if(si(t))throw new P("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Se(t)},p.isNil=function(t){return null==t},p.isNull=function(t){return null===t},p.isNumber=Ln,p.isObject=b,p.isObjectLike=G,p.isPlainObject=kn,p.isRegExp=Rn,p.isSafeInteger=function(t){return An(t)&&-$a<=t&&t<=$a},p.isSet=wn,p.isString=In,p.isSymbol=E,p.isTypedArray=Dn,p.isUndefined=function(t){return t===ja},p.isWeakMap=function(t){return G(t)&&B(t)==Za},p.isWeakSet=function(t){return G(t)&&"[object WeakSet]"==r(t)},p.join=function(t,e){return null==t?"":mt.call(t,e)},p.kebabCase=sa,p.last=i,p.lastIndexOf=function(t,e,r){var i=null==t?0:t.length;if(!i)return-1;var n=i;if(r!==ja&&(n=(n=R(r))<0?S(i+n,0):L(n,i-1)),e!=e)return Bo(t,jo,n,!0);for(var a=t,s=e,o=n+1;o--;)if(a[o]===s)return o;return o},p.lowerCase=oa,p.lowerFirst=la,p.lt=Cn,p.lte=Pn,p.max=function(t){return t&&t.length?oe(t,C,ve):ja},p.maxBy=function(t,e){return t&&t.length?oe(t,c(e,2),ve):ja},p.mean=function(t){return Go(t,C)},p.meanBy=function(t,e){return Go(t,c(e,2))},p.min=function(t){return t&&t.length?oe(t,C,we):ja},p.minBy=function(t,e){return t&&t.length?oe(t,c(e,2),we):ja},p.stubArray=Da,p.stubFalse=Ca,p.stubObject=function(){return{}},p.stubString=function(){return""},p.stubTrue=function(){return!0},p.multiply=Na,p.nth=function(t,e){return t&&t.length?xe(t,R(e)):ja},p.noConflict=function(){return ns._===this&&(ns._=J),this},p.noop=_a,p.now=rn,p.pad=function(t,e,r){t=f(t);var i=(e=R(e))?ps(t):0;return!e||e<=i?t:Dr(pt(e=(e-i)/2),r)+t+Dr(ft(e),r)},p.padEnd=function(t,e,r){t=f(t);var i=(e=R(e))?ps(t):0;return e&&i<e?t+Dr(e-i,r):t},p.padStart=function(t,e,r){t=f(t);var i=(e=R(e))?ps(t):0;return e&&i<e?Dr(e-i,r)+t:t},p.parseInt=function(t,e,r){return e=r||null==e?0:e&&+e,Tt(f(t).replace(Qs,""),e||0)},p.random=function(t,e,r){var i;return r&&"boolean"!=typeof r&&d(t,e,r)&&(e=r=ja),r===ja&&("boolean"==typeof e?(r=e,e=ja):"boolean"==typeof t&&(r=t,t=ja)),t===ja&&e===ja?(t=0,e=1):(t=On(t),e===ja?(e=t,t=0):e=On(e)),e<t&&(i=t,t=e,e=i),r||t%1||e%1?(i=bt(),L(t+i*(e-t+To("1e-"+((i+"").length-1))),e)):Be(t,e)},p.reduce=function(t,e,r){var i=j(t)?Oo:Ko,n=arguments.length<3;return i(t,c(e,4),r,n,ne)},p.reduceRight=function(t,e,r){var i=j(t)?Mo:Ko,n=arguments.length<3;return i(t,c(e,4),r,n,ae)},p.repeat=function(t,e,r){return e=(r?d(t,e,r):e===ja)?1:R(e),Ue(f(t),e)},p.replace=function(){var t=arguments,e=f(t[0]);return t.length<3?e:e.replace(t[1],t[2])},p.result=function(t,e,r){var i=-1,n=(e=ar(e,t)).length;for(n||(n=1,t=ja);++i<n;){var a=null==t?ja:t[bi(e[i])];a===ja&&(i=n,a=r),t=bn(a)?a.call(t):a}return t},p.round=Ba,p.runInContext=n,p.sample=function(t){return(j(t)?Ht:je)(t)},p.size=function(t){var e;return null==t?0:h(t)?In(t)?ps(t):t.length:(e=B(t))==Ya||e==Xa?t.size:ke(t).length},p.snakeCase=ua,p.some=function(t,e,r){return(j(t)?Fo:Ve)(t,c(e=r&&d(t,e,r)?ja:e,3))},p.sortedIndex=function(t,e){return We(t,e)},p.sortedIndexBy=function(t,e,r){return Ye(t,e,c(r,2))},p.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var i=We(t,e);if(i<r&&U(t[i],e))return i}return-1},p.sortedLastIndex=function(t,e){return We(t,e,!0)},p.sortedLastIndexBy=function(t,e,r){return Ye(t,e,c(r,2),!0)},p.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var r=We(t,e,!0)-1;if(U(t[r],e))return r}return-1},p.startCase=ha,p.startsWith=function(t,e,r){return t=f(t),r=null==r?0:te(R(r),0,t.length),e=u(e),t.slice(r,r+e.length)==e},p.subtract=Ua,p.sum=function(t){return t&&t.length?Ho(t,C):0},p.sumBy=function(t,e){return t&&t.length?Ho(t,c(e,2)):0},p.template=function(s,t,e){var o,l,r=p.templateSettings;e&&d(s,t,e)&&(t=ja),s=f(s),t=Un({},t,r,Ur);var i=I(e=Un({},t.imports,r.imports,Ur)),n=Yo(e,i),u=0,r=t.interpolate||co,h="__p += '",e=M((t.escape||co).source+"|"+r.source+"|"+(r===Hs?io:co).source+"|"+(t.evaluate||co).source+"|$","g"),a="//# sourceURL="+(F.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Eo+"]")+"\n";if(s.replace(e,function(t,e,r,i,n,a){return r=r||i,h+=s.slice(u,a).replace(fo,Zo),e&&(o=!0,h+="' +\n__e("+e+") +\n'"),n&&(l=!0,h+="';\n"+n+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=a+t.length,t}),h+="';\n",r=F.call(t,"variable")&&t.variable){if(eo.test(r))throw new P("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";if(h=(l?h.replace(Ms,""):h).replace(Fs,"$1").replace(Ns,"$1;"),h="function("+(r||"obj")+") {\n"+(r?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(l?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}",(e=pa(function(){return x(i,a+"return "+h).apply(ja,n)})).source=h,Tn(e))throw e;return e},p.times=function(t,e){if((t=R(t))<1||$a<t)return[];for(var r=Ka,i=L(t,Ka),i=(e=c(e),t-=Ka,Vo(i,e));++r<t;)e(r);return i},p.toFinite=On,p.toInteger=R,p.toLength=Mn,p.toLower=function(t){return f(t).toLowerCase()},p.toNumber=w,p.toSafeInteger=function(t){return t?te(R(t),-$a,$a):0===t?t:0},p.toString=f,p.toUpper=function(t){return f(t).toUpperCase()},p.trim=function(t,e,r){return(t=f(t))&&(r||e===ja)?Wo(t):t&&(e=u(e))?or(r=gs(t),zo(r,e=gs(e)),Qo(r,e)+1).join(""):t},p.trimEnd=function(t,e,r){return(t=f(t))&&(r||e===ja)?t.slice(0,il(t)+1):t&&(e=u(e))?or(r=gs(t),0,Qo(r,gs(e))+1).join(""):t},p.trimStart=function(t,e,r){return(t=f(t))&&(r||e===ja)?t.replace(Qs,""):t&&(e=u(e))?or(r=gs(t),zo(r,gs(e))).join(""):t},p.truncate=function(t,e){var r,i=30,n="...",e=(b(e)&&(r="separator"in e?e.separator:r,i="length"in e?R(e.length):i,n="omission"in e?u(e.omission):n),(t=f(t)).length);if((e=ds(t)?(a=gs(t)).length:e)<=i)return t;if((e=i-ps(n))<1)return n;var a,i=a?or(a,0,e).join(""):t.slice(0,e);if(r!==ja)if(a&&(e+=i.length-e),Rn(r)){if(t.slice(e).search(r)){var s,o=i;for((r=r.global?r:M(r.source,f(no.exec(r))+"g")).lastIndex=0;s=r.exec(o);)var l=s.index;i=i.slice(0,l===ja?e:l)}}else t.indexOf(u(r),e)!=e&&-1<(a=i.lastIndexOf(r))&&(i=i.slice(0,a));return i+n},p.unescape=function(t){return(t=f(t))&&js.test(t)?t.replace(Bs,nl):t},p.uniqueId=function(t){var e=++q;return f(t)+e},p.upperCase=ca,p.upperFirst=da,p.each=qi,p.eachRight=zi,p.first=Ri,Aa(p,(Fa={},ce(p,function(t,e){F.call(p.prototype,e)||(Fa[e]=t)}),Fa),{chain:!1}),p.VERSION="4.17.21",ss(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){p[t].placeholder=p}),ss(["drop","take"],function(r,i){m.prototype[r]=function(t){t=t===ja?1:S(R(t),0);var e=this.__filtered__&&!i?new m(this):this.clone();return e.__filtered__?e.__takeCount__=L(t,e.__takeCount__):e.__views__.push({size:L(t,Ka),type:r+(e.__dir__<0?"Right":"")}),e},m.prototype[r+"Right"]=function(t){return this.reverse()[r](t).reverse()}}),ss(["filter","map","takeWhile"],function(t,e){var r=e+1,i=1==r||3==r;m.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:c(t,3),type:r}),e.__filtered__=e.__filtered__||i,e}}),ss(["head","last"],function(t,e){var r="take"+(e?"Right":"");m.prototype[t]=function(){return this[r](1).value()[0]}}),ss(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");m.prototype[t]=function(){return this.__filtered__?new m(this):this[r](1)}}),m.prototype.compact=function(){return this.filter(C)},m.prototype.find=function(t){return this.filter(t).head()},m.prototype.findLast=function(t){return this.reverse().find(t)},m.prototype.invokeMap=s(function(e,r){return"function"==typeof e?new m(this):this.map(function(t){return Te(t,e,r)})}),m.prototype.reject=function(t){return this.filter(cn(c(t)))},m.prototype.slice=function(t,e){t=R(t);var r=this;return r.__filtered__&&(0<t||e<0)?new m(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==ja?(e=R(e))<0?r.dropRight(-e):r.take(e-t):r)},m.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},m.prototype.toArray=function(){return this.take(Ka)},ce(m.prototype,function(u,t){var h=/^(?:filter|find|map|reject)|While$/.test(t),c=/^(?:head|last)$/.test(t),d=p[c?"take"+("last"==t?"Right":""):t],f=c||/^find/.test(t);d&&(p.prototype[t]=function(){function t(t){return t=d.apply(p,us([t],i)),c&&o?t[0]:t}var e,r=this.__wrapped__,i=c?[1]:arguments,n=r instanceof m,a=i[0],s=n||j(r),o=(s&&h&&"function"==typeof a&&1!=a.length&&(n=s=!1),this.__chain__),a=!!this.__actions__.length,l=f&&!o,n=n&&!a;return!f&&s?(r=n?r:new m(this),(e=u.apply(r,i)).__actions__.push({func:Ki,args:[t],thisArg:ja}),new v(e,o)):l&&n?u.apply(this,i):(e=this.thru(t),l?c?e.value()[0]:e.value():e)})}),ss(["pop","push","shift","sort","splice","unshift"],function(t){var r=K[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var t,e=arguments;return n&&!this.__chain__?(t=this.value(),r.apply(j(t)?t:[],e)):this[i](function(t){return r.apply(j(t)?t:[],e)})}}),ce(m.prototype,function(t,e){var r,i=p[e];i&&(r=i.name+"",F.call(wt,r)||(wt[r]=[]),wt[r].push({name:e,func:i}))}),wt[kr(ja,2).name]=[{name:"wrapper",func:ja}],m.prototype.clone=function(){var t=new m(this.__wrapped__);return t.__actions__=k(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=k(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=k(this.__views__),t},m.prototype.reverse=function(){var t;return this.__filtered__?((t=new m(this)).__dir__=-1,t.__filtered__=!0):(t=this.clone()).__dir__*=-1,t},m.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=j(t),i=e<0,n=r?t.length:0,a=function(t,e,r){var i=-1,n=r.length;for(;++i<n;){var a=r[i],s=a.size;switch(a.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=L(e,t+s);break;case"takeRight":t=S(t,e-s)}}return{start:t,end:e}}(0,n,this.__views__),s=a.start,o=(a=a.end)-s,l=i?a:s-1,u=this.__iteratees__,h=u.length,c=0,d=L(o,this.__takeCount__);if(!r||!i&&n==o&&d==o)return tr(t,this.__actions__);var f=[];t:for(;o--&&c<d;){for(var p=-1,g=t[l+=e];++p<h;){var v=u[p],m=v.iteratee,v=v.type,m=m(g);if(2==v)g=m;else if(!m){if(1==v)continue t;break t}}f[c++]=g}return f},p.prototype.at=Hi,p.prototype.chain=function(){return $i(this)},p.prototype.commit=function(){return new v(this.value(),this.__chain__)},p.prototype.next=function(){this.__values__===ja&&(this.__values__=xn(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?ja:this.__values__[this.__index__++]}},p.prototype.plant=function(t){for(var e,r=this;r instanceof Bt;)var i=_i(r),n=(i.__index__=0,i.__values__=ja,e?n.__wrapped__=i:e=i,i),r=r.__wrapped__;return n.__wrapped__=t,e},p.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof m?(t=t,(t=(t=this.__actions__.length?new m(this):t).reverse()).__actions__.push({func:Ki,args:[Di],thisArg:ja}),new v(t,this.__chain__)):this.thru(Di)},p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=function(){return tr(this.__wrapped__,this.__actions__)},p.prototype.first=p.prototype.head,ot&&(p.prototype[ot]=function(){return this}),p}();ns._=al,(I=function(){return al}.call(D,C,D,w))!==ja&&(w.exports=I)}.call(this)}.call(this,C(35),C(155)(t))},function(t,e,r){var i=r(357),n=r(358),a=r(154),s=r(359);t.exports=function(t,e){return i(t)||n(t,e)||a(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,f){"use strict";!function(i){f.d(r,"a",function(){return e});var t=f(5),n=f.n(t),t=f(6),a=f.n(t),t=f(8),s=f.n(t),t=f(9),o=f.n(t),t=f(3),l=f.n(t),u=f(1),t=f(162),h=f.n(t),t=f(163),c=f.n(t);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var e=function(t){s()(r,t);var e=d(r);function r(){return n()(this,r),e.apply(this,arguments)}return a()(r,[{key:"name",get:function(){return"level_selector"}},{key:"template",get:function(){return Object(u.template)(h.a)}},{key:"supportedVersion",get:function(){return{min:u.version}}},{key:"attributes",get:function(){return{class:this.name,"data-level-selector":""}}},{key:"events",get:function(){return{"click [data-level-selector-select]":"onLevelSelect","click [data-level-selector-button]":"onShowLevelSelectMenu"}}},{key:"container",get:function(){return this.core.activeContainer||this.core.mediaControl.container}},{key:"playback",get:function(){return this.core.activePlayback||this.core.getCurrentPlayback()}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_READY,this.bindPlaybackEvents),u.Events.CORE_ACTIVE_CONTAINER_CHANGED?this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.reload):this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideSelectLevelMenu)}},{key:"bindPlaybackEvents",value:function(){this.playback&&(this.listenTo(this.playback,u.Events.PLAYBACK_LEVELS_AVAILABLE,this.fillLevels),this.listenTo(this.playback,u.Events.PLAYBACK_LEVEL_SWITCH_START,this.startLevelSwitch),this.listenTo(this.playback,u.Events.PLAYBACK_LEVEL_SWITCH_END,this.stopLevelSwitch),this.listenTo(this.playback,u.Events.PLAYBACK_BITRATE,this.updateCurrentLevel),this.playback.levels)&&0<this.playback.levels.length&&this.fillLevels(this.playback.levels)}},{key:"reload",value:function(){var t=this;this.stopListening(),i.nextTick(function(){t.bindEvents(),t.bindPlaybackEvents()})}},{key:"shouldRender",value:function(){var t,e;return!(!this.container||!this.playback)&&(t=void 0!==this.playback.currentLevel,e=!!(this.levels&&1<this.levels.length),t)&&e}},{key:"render",value:function(){var t;return this.shouldRender()&&(t=u.Styler.getStyleFor(c.a,{baseUrl:this.core.options.baseUrl}),this.$el.html(this.template({levels:this.levels,title:this.getTitle()})),this.$el.append(t),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.$(".level_selector ul").css("max-height",.8*this.core.el.offsetHeight),this.highlightCurrentLevel()),this}},{key:"fillLevels",value:function(t){void 0===this.selectedLevelId&&(this.selectedLevelId=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1);var e=this.core.options&&this.core.options.levelSelectorConfig&&this.core.options.levelSelectorConfig.onLevelsAvailable;if(e){if("function"!=typeof e)throw new TypeError("onLevelsAvailable must be a function");t=e(t.slice())}t.forEach(function(t){var e=t.level;Object.keys(e).length&&(e=e.height,t.resolution="".concat(e,"p"))}),this.levels=t,this.configureLevelsLabels(),this.render()}},{key:"configureLevelsLabels",value:function(){if(void 0!==this.core.options.levelSelectorConfig){var t=this.core.options.levelSelectorConfig.labelCallback;if(t&&"function"!=typeof t)throw new TypeError("labelCallback must be a function");var e,r,i,n=this.core.options.levelSelectorConfig.labels,a=n?this.core.options.levelSelectorConfig.labels:{};if(t||n)for(i in this.levels)r=a[(e=this.levels[i]).id],t?e.label=t(e,r):r&&(e.label=r)}}},{key:"findLevelBy",value:function(e){var r;return this.levels.forEach(function(t){t.id===e&&(r=t)}),r}},{key:"onLevelSelect",value:function(t){return this.selectedLevelId=parseInt(t.target.dataset.levelSelectorSelect,10),this.playback.currentLevel!=this.selectedLevelId&&(this.playback.currentLevel=this.selectedLevelId,this.toggleContextMenu(),t.stopPropagation()),!1}},{key:"onShowLevelSelectMenu",value:function(){this.toggleContextMenu()}},{key:"hideSelectLevelMenu",value:function(){this.$(".level_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".level_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".level_selector button")}},{key:"levelElement",value:function(t){return this.$(".level_selector ul a".concat(isNaN(t)?"":'[data-level-selector-select="'.concat(t,'"]'))).parent()}},{key:"getTitle",value:function(){return(this.core.options.levelSelectorConfig||{}).title}},{key:"startLevelSwitch",value:function(){this.buttonElement().addClass("changing")}},{key:"stopLevelSwitch",value:function(){this.buttonElement().removeClass("changing")}},{key:"updateText",value:function(t){-1===t?this.buttonElement().text(this.currentLevel?"AUTO (".concat(this.currentLevel.resolution,")"):"AUTO"):this.buttonElement().text(this.findLevelBy(t).resolution)}},{key:"updateCurrentLevel",value:function(t){t=this.findLevelBy(t.level);this.currentLevel=t||null,this.highlightCurrentLevel()}},{key:"highlightCurrentLevel",value:function(){this.levelElement().removeClass("current"),this.currentLevel&&this.levelElement(this.currentLevel.id).addClass("current"),this.updateText(this.selectedLevelId)}}],[{key:"version",get:function(){return"22.12.1"}}]),r}(u.UICorePlugin)}.call(this,f(94))},function(t,e){t.exports='<button data-level-selector-button>\n  Auto\n</button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <li><a href="#" data-level-selector-select="-1">AUTO</a></li>\n  <% for (var i = 0; i < levels.length; i++) { %>\n    <li><a href="#" data-level-selector-select="<%= levels[i].id %>"><%= levels[i].resolution %></a></li>\n  <% }; %>\n</ul>'},function(t,e,r){var i=r(375),n=("string"==typeof i&&(i=[[t.i,i,""]]),{hmr:!0});n.transform=void 0,n.insertInto=void 0,r(377)(i,n);i.locals&&(t.exports=i.locals)},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(7),s=r.n(e),e=r(8),o=r.n(e),e=r(9),l=r.n(e),e=r(3),u=r.n(e),h=r(1),e=r(88),c=r.n(e),e=r(165),d=r.n(e),e=r(166),f=r.n(e),p=r(89);function g(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=i?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}var v="blinkPoster",i=function(t){o()(i,t);var r=g(i);function i(t){var e;return n()(this,i),(e=r.call(this,t)).startBlinkPoster(),e.container=t,e}return a()(i,[{key:"name",get:function(){return"poster"}},{key:"bindEvents",value:function(){s()(u()(i.prototype),"bindEvents",this).call(this),this.listenTo(this.container,h.Events.CONTAINER_OPTIONS_CHANGE,this.changeOptsRuntime)}},{key:"destroy",value:function(){s()(u()(i.prototype),"destroy",this).call(this),this.stopBlinkPoster()}},{key:"changeOptsRuntime",value:function(){this.options[v]?this.startBlinkPoster():this.stopBlinkPoster()}},{key:"startBlinkPoster",value:function(){var t;this.options[v]&&!this.hasStartedPlaying&&(t=this.options.blinkPosterDelay||5e3,this.posterChangeSource=this.posterChangeSource.bind(this),this.posterTimer=setTimeout(this.posterChangeSource,t))}},{key:"stopBlinkPoster",value:function(){clearTimeout(this.posterTimer)}},{key:"onStop",value:function(){s()(u()(i.prototype),"onStop",this).call(this),this.startBlinkPoster()}},{key:"onPlay",value:function(){s()(u()(i.prototype),"onPlay",this).call(this),this.stopBlinkPoster()}},{key:"posterChangeSource",value:function(){var t=this,e=this.options.authToken?"&":"?",e=this.getPosterSource({postfix:"".concat(e,"_t=").concat(Number(new Date))});this.setPosterSource(e).then(function(){t.posterTimer=setTimeout(t.posterChangeSource,5e3)})}},{key:"templateVideo",get:function(){return Object(h.template)(f.a)}},{key:"shouldRender",get:function(){var t=!!this.options.poster;return"html_img"!==this.container.playback.name&&("no_op"!==this.container.playback.getPlaybackType()||t)}},{key:"showOnVideoEnd",get:function(){return!this.options.poster||this.options.poster.showOnVideoEnd||void 0===this.options.poster.showOnVideoEnd}},{key:"setPosterSource",value:function(i){var n=this;return Object(p.b)(this.$el[0])?new Promise(function(t){var e=n._videoPoster,r=n.$el.find(".poster-video:not(.visible)");r.one("loadeddata",function(){e.removeClass("visible"),r.addClass("visible"),n._videoPoster=r,t()}),r.attr({src:i})}):Promise.resolve()}},{key:"renderVideoPoster",value:function(){this.$el.html(this.templateVideo()),this.setPosterStyles(),this.setVideoPoster()}},{key:"setPosterStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(h.template)(d.a.toString()))}},{key:"setVideoPoster",value:function(){this._videoPoster=this.$el.find(".poster-video"),this._videoPoster.attr({src:this.getPosterSource()})}},{key:"renderPlayButton",value:function(){this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(c.a),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster","");var t=this.options.mediacontrol&&this.options.mediacontrol.buttons;t&&this.$el.find("svg path").css("fill",t),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(t=this.options.mediacontrol.buttons,this.$playButton.css("color",t))}},{key:"getPosterSource",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).postfix,e=this.options.poster.url||this.options.poster;return t?"".concat(e).concat(t):e}},{key:"render",value:function(){if(this.shouldRender)return this.renderVideoPoster(),this.renderPlayButton(),this.update(),this}}]),i}(h.Poster)},function(t,e,r){},function(t,e){t.exports='<div class="video-poster-wrapper">\n  <video class="poster-video visible" autoplay />\n  <video class="poster-video" autoplay />\n  <div class="play-wrapper-cont">\n    <div class="play-wrapper"></div>\n  </div>\n</div>\n'},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1),e=r(88),h=r.n(e),e=r(168),c=r.n(e);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var i=function(t){s()(i,t);var r=d(i);function i(t){var e;return n()(this,i),(e=r.call(this,t)).container=t,e}return a()(i,[{key:"setPosterStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(u.template)(c.a.toString()))}},{key:"render",value:function(){var t,e=this;if(this.shouldRender)return this.$el[0].addEventListener("touchstart",function(){e.container.play()}),this.$el.html(this.template()),this.setPosterStyles(),this.options.poster&&null==this.options.poster.custom?(t=this.options.poster.url||this.options.poster,this.$el.css({"background-image":"url(".concat(t,")")})):this.options.poster&&this.$el.css({background:this.options.poster.custom}),this.container.$el.append(this.el),this.$playWrapper=this.$el.find(".play-wrapper"),this.$playWrapper.append(h.a),this.$playButton=this.$playWrapper.find("svg"),this.$playButton.addClass("poster-icon"),this.$playButton.attr("data-poster",""),(t=this.options.mediacontrol&&this.options.mediacontrol.buttons)&&this.$el.find("svg path").css("fill",t),this.options.mediacontrol&&this.options.mediacontrol.buttons&&(t=this.options.mediacontrol.buttons,this.$playButton.css("color",t)),this.update(),this}}]),i}(u.Poster)},function(t,e,r){},function(t,e,r){"use strict";r.d(e,"a",function(){return p});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(8),a=r.n(e),e=r(9),s=r.n(e),e=r(7),o=r.n(e),e=r(3),l=r.n(e),u=r(1),h=r(89),e=r(170),c=r.n(e),e=r(171),d=r.n(e);function f(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}var p=function(t){a()(r,t);var e=f(r);function r(t){return i()(this,r),(t=e.call(this,t)).hasStartedPlaying=!1,t.playRequested=!1,t.render(),t}return n()(r,[{key:"name",get:function(){return"logo"}},{key:"template",get:function(){return Object(u.template)(c.a)}},{key:"attributes",get:function(){return{class:"player-logo","data-logo":""}}},{key:"shouldRender",get:function(){return!!this.options.logo.path}},{key:"bindEvents",value:function(){this.setPositionBinded=this.setPosition.bind(this),window.addEventListener("resize",this.setPositionBinded),(u.Browser.isSafari||u.Browser.isIE)&&this.container.playback.el.addEventListener("loadeddata",this.setPositionBinded),this.listenTo(this.container,u.Events.CONTAINER_STOP,this.onStop),this.listenTo(this.container,u.Events.CONTAINER_PLAY,this.onPlay),this.listenTo(this.container,u.Events.CONTAINER_LOADEDMETADATA,this.setPositionBinded)}},{key:"stopListening",value:function(){window.removeEventListener("resize",this.setPositionBinded),(u.Browser.isSafari||u.Browser.isIE)&&window.removeEventListener("loadeddata",this.setPositionBinded),o()(l()(r.prototype),"stopListening",this).call(this)}},{key:"onPlay",value:function(){this.hasStartedPlaying=!0,this.update()}},{key:"onStop",value:function(){this.hasStartedPlaying=!1,this.playRequested=!1,this.update()}},{key:"update",value:function(){this.shouldRender&&(this.hasStartedPlaying?this.$el.show():this.$el.hide())}},{key:"render",value:function(){if(this.shouldRender)return this.$el.html(this.template()),this.setLogoStyles(),this.setLogoImgAttrs(),this.container.$el.append(this.$el),this.update(),this}},{key:"setLogoImgAttrs",value:function(){var t=this.options,e=t.logo,r=e.path,i=e.width,i=void 0===i?60:i,e=e.height,e=void 0===e?60:e,t=t.authToken;this.$logoContainer=this.$el.find(".live-logo"),this.$logoContainer.find(".live-logo-img").attr({src:"".concat(r.includes("http")||r.includes("https")?"":"/").concat(r).concat(t?"?".concat(t):""),style:"width: ".concat(i,"px;height: ").concat(e,"px;")})}},{key:"setPosition",value:function(){var t,e,r,i;this.shouldRender&&(r=(e=this.container).$el,e=e.currentSize,t=(r=r.find("video[data-html5-video]").get(0)).videoWidth,r=r.videoHeight,e=Object(h.a)({dom:{width:e.width,height:e.height},media:{width:t,height:r}}),t=this.options.logo,e=(r=e.letterboxing).vertical,r=r.horizontal,i=this.$logoContainer.get(0),this.setStyles(t,["top","bottom"],i,e),this.setStyles(t,["left","right"],i,r),this.update())}},{key:"setStyles",value:function(e,t,r,i){var n=this;t.forEach(function(t){return n.setStyle(e,t,r,i)})}},{key:"setStyle",value:function(t,e,r,i){t[e]&&(r.style[e]="".concat(parseInt(t[e],10)+i,"px"))}},{key:"setLogoStyles",value:function(){this.$el.append('<style class="clappr-style"></style>'),this.$el.find(".clappr-style").html(Object(u.template)(d.a.toString()))}}]),r}(u.UIContainerPlugin)},function(t,e){t.exports='<div class="live-logo">\n  <img class="live-logo-img" />\n</div>\n'},function(t,e,r){},function(t,e,r){"use strict";r.d(e,"a",function(){return h});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(8),a=r.n(e),e=r(9),s=r.n(e),e=r(3),o=r.n(e),l=r(1);function u(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o()(r);return t=i?(t=o()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}var h=function(t){a()(r,t);var e=u(r);function r(){return i()(this,r),e.apply(this,arguments)}return n()(r,[{key:"name",get:function(){return"volumePlugin"}},{key:"bindEvents",value:function(){0<this.container.options.volume?this.listenToOnce(this.container,l.Events.CONTAINER_MEDIACONTROL_ENABLE,this.setInitialVolume):this.enabled=!1}},{key:"setInitialVolume",value:function(){this.container.setVolume(this.container.options.volume)}}]),r}(l.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return d});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(7),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1),h=r(26);function c(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var d=function(t){s()(r,t);var e=c(r);function r(){return i()(this,r),e.apply(this,arguments)}return n()(r,[{key:"name",get:function(){return"StreamStatusPlugin"}},{key:"bindEvents",value:function(){var t=this;"mseld"===this.container.playback.name?(this.listenTo(this.container.playback,u.Events.PLAYBACK_BUFFERING,this.waitForTime(5e3)),this.listenTo(this.container.playback,u.Events.PLAYBACK_BUFFERFULL,function(){return t._buffering=!1})):this.listenTo(this.container.playback,u.Events.PLAYBACK_ERROR,this.startListenStatus)}},{key:"startListenStatus",value:function(t){"mseld"!==this.container.playback.name&&(!t||t.data&&"networkError"!==t.data.type)||(this._statusUrl=Object(h.a)(this.container.options,"info.json"),this.checkStatus=this.checkStatus.bind(this),clearInterval(this.timerStatus),this.timerStatus=setInterval(this.checkStatus,1e3))}},{key:"waitForTime",value:function(t){var e=this;return function(){e._buffering=!0,setTimeout(function(){e._buffering&&e.startListenStatus()},t)}}},{key:"checkStatus",value:function(){var e=this;fetch(this._statusUrl).then(function(t){404===t.status&&(e.container.playback.setWaitStatus&&e.container.playback.setWaitStatus(!0),e.container.playback.stop()),200===t.status&&(clearInterval(e.timerStatus),e.container.playback.setWaitStatus)&&e.container.playback.setWaitStatus(!1)})}},{key:"disable",value:function(){clearInterval(this.timerStatus),a()(l()(r.prototype),"disable",this).call(this)}},{key:"destroy",value:function(){clearInterval(this.timerStatus),a()(l()(r.prototype),"destroy",this).call(this)}}]),r}(u.UIContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return h});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(8),a=r.n(e),e=r(9),s=r.n(e),e=r(3),o=r.n(e),l=r(1);function u(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o()(r);return t=i?(t=o()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),s()(this,t)}}var h=function(t){a()(r,t);var e=u(r);function r(){return i()(this,r),e.apply(this,arguments)}return n()(r,[{key:"name",get:function(){return"DebugPlugin"}},{key:"bindEvents",value:function(){for(var t in l.Events)"register"!==t&&"listAvailableCustomEvents"!==t&&this.listenTo(this.container.playback,l.Events[t],this.fireEvent.bind(this,t))}},{key:"fireEvent",value:function(t){console.log(t)}}]),r}(l.UIContainerPlugin)},function(t,e,r){"use strict";var i=r(5),s=r.n(i),i=r(6),o=r.n(i),i=r(7),l=r.n(i),i=r(8),u=r.n(i),i=r(9),n=r.n(i),i=r(3),h=r.n(i),c=r(1),i=r(56),d=r.n(i);function f(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=h()(r);return t=i?(t=h()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),n()(this,t)}}r=function(t){u()(a,t);var n=f(a);function a(){var t;s()(this,a);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(t=n.call.apply(n,[this].concat(r)))._levels=[],t._pendingAdaptationEvent=!1,t._isShakaReadyState=!1,t._minDvrSize=void 0===t.options.shakaMinimumDvrSize?60:t.options.shakaMinimumDvrSize,t.checkIfCritical(),t}return o()(a,[{key:"name",get:function(){return"dash_shaka_playback"}},{key:"shakaVersion",get:function(){return d.a.player.Player.version}},{key:"shakaPlayerInstance",get:function(){return this._player}},{key:"levels",get:function(){return this._levels}},{key:"seekRange",get:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.seekRange():{start:0,end:0}}},{key:"currentLevel",get:function(){return this._currentLevelId||-1},set:function(t){var e=this,t=(this._currentLevelId=t,-1===this._currentLevelId);this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_START),t?(this._player.configure({abr:{enabled:!0}}),this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_END)):(this._player.configure({abr:{enabled:!1}}),this._pendingAdaptationEvent=!0,this.selectTrack(this.videoTracks.filter(function(t){return t.id===e._currentLevelId})[0]))}},{key:"dvrEnabled",get:function(){return this._duration>=this._minDvrSize&&"live"===this.getPlaybackType()}},{key:"getDuration",value:function(){return this._duration}},{key:"_duration",get:function(){return this.shakaPlayerInstance?this.seekRange.end-this.seekRange.start:0}},{key:"getCurrentTime",value:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.getMediaElement().currentTime-this.seekRange.start:0}},{key:"_startTime",get:function(){return this.seekRange.start}},{key:"presentationStartTimeAsDate",get:function(){return this.shakaPlayerInstance&&this.shakaPlayerInstance.getPresentationStartTimeAsDate()?new Date(this.shakaPlayerInstance.getPresentationStartTimeAsDate().getTime()+1e3*this.seekRange.start):0}},{key:"bandwidthEstimate",get:function(){return this.shakaPlayerInstance?this.shakaPlayerInstance.getStats().estimatedBandwidth:null}},{key:"getProgramDateTime",value:function(){return this.presentationStartTimeAsDate}},{key:"_updateDvr",value:function(t){this.trigger(c.Events.PLAYBACK_DVR,t),this.trigger(c.Events.PLAYBACK_STATS_ADD,{dvr:t})}},{key:"seek",value:function(t){t<0&&(c.Log.warn("Attempt to seek to a negative time. Resetting to live point. Use seekToLivePoint() to seek to the live point."),t=this._duration),this.dvrEnabled&&this._updateDvr(t<this._duration-3),t+=this._startTime,this.el.currentTime=t}},{key:"pause",value:function(){this.el.pause(),this.dvrEnabled&&this._updateDvr(!0)}},{key:"play",value:function(){this.criticalError||(this._player||this._setup(),this.isReady?(this._stopped=!1,this._src=this.el.src,l()(h()(a.prototype),"play",this).call(this),this._startTimeUpdateTimer()):this.once(a.Events.SHAKA_READY,this.play))}},{key:"_onPlaying",value:function(){if(!this._isBuffering)return l()(h()(a.prototype),"_onPlaying",this).call(this)}},{key:"_onSeeking",value:function(){return this._isSeeking=!0,l()(h()(a.prototype),"_onSeeking",this).call(this)}},{key:"_onSeeked",value:function(){if(!this._isBuffering)return this._isSeeking=!1,l()(h()(a.prototype),"_onSeeked",this).call(this)}},{key:"_startTimeUpdateTimer",value:function(){var t=this;this._stopTimeUpdateTimer(),this._timeUpdateTimer=setInterval(function(){t._onTimeUpdate()},100)}},{key:"_stopTimeUpdateTimer",value:function(){this._timeUpdateTimer&&clearInterval(this._timeUpdateTimer)}},{key:"_setupSrc",value:function(){}},{key:"_ready",value:function(){}},{key:"_onShakaReady",value:function(){this._isShakaReadyState=!0,this.trigger(a.Events.SHAKA_READY),this.trigger(c.Events.PLAYBACK_READY,this.name)}},{key:"isReady",get:function(){return this._isShakaReadyState}},{key:"error",value:function(t){c.Log.error("an error was raised by the video tag",t,this.el.error)}},{key:"isHighDefinitionInUse",value:function(){return!!this.highDefinition}},{key:"stop",value:function(){var t=this;this._stopTimeUpdateTimer(),clearInterval(this.sendStatsId),this._stopped=!0,this._player?(this._sendStats(),this._player.unload().then(function(){l()(h()(a.prototype),"stop",t).call(t),t._player=null,t._isShakaReadyState=!1}).catch(function(){c.Log.error("shaka could not be unloaded")})):l()(h()(a.prototype),"stop",this).call(this)}},{key:"textTracks",get:function(){return this.isReady&&this._player.getTextTracks()}},{key:"audioTracks",get:function(){return this.isReady&&this._player.getVariantTracks().filter(function(t){return t.mimeType.startsWith("audio/")})}},{key:"videoTracks",get:function(){return this.isReady&&this._player.getVariantTracks().filter(function(t){return t.mimeType.startsWith("video/")})}},{key:"getPlaybackType",value:function(){return(this.isReady&&this._player.isLive()?"live":"vod")||""}},{key:"selectTrack",value:function(t){if("text"===t.type)this._player.selectTextTrack(t);else{if("variant"!==t.type)throw new Error("Unhandled track type:",t.type);this._player.selectVariantTrack(t),t.mimeType.startsWith("video/")&&this._onAdaptation()}}},{key:"closedCaptionsTracks",get:function(){var e=0;return(this.textTracks||[]).filter(function(t){return"subtitle"===t.kind}).map(function(t){return{id:e++,name:t.label||t.language,track:t}})}},{key:"closedCaptionsTrackId",get:function(){return l()(h()(a.prototype),"closedCaptionsTrackId",this)},set:function(e){if(this._player){var t,r=this.closedCaptionsTracks;if(-1!==e){if(!(t=r.find(function(t){return t.id===e})))return void c.Log.warn('Track id "'.concat(e,'" not found'));if(this._shakaTTVisible&&!0===t.track.active)return void c.Log.info('Track id "'.concat(e,'" already showing'))}t?(this._player.selectTextTrack(t.track),this._player.setTextTrackVisibility(!0),this._enableShakaTextTrack(!0)):(this._player.setTextTrackVisibility(!1),this._enableShakaTextTrack(!1)),this._ccTrackId=e,this.trigger(c.Events.PLAYBACK_SUBTITLE_CHANGED,{id:e})}}},{key:"_enableShakaTextTrack",value:function(e){this.el.textTracks&&(this._shakaTTVisible=e,Array.from(this.el.textTracks).filter(function(t){return"subtitles"===t.kind}).forEach(function(t){return t.mode=!0===e?"showing":"hidden"}))}},{key:"_checkForClosedCaptions",value:function(){var t;this._ccIsSetup||(this.hasClosedCaptionsTracks&&(this.trigger(c.Events.PLAYBACK_SUBTITLE_AVAILABLE),t=this.closedCaptionsTrackId,this.closedCaptionsTrackId=t),this._ccIsSetup=!0)}},{key:"destroy",value:function(){var t=this;this._stopTimeUpdateTimer(),clearInterval(this.sendStatsId),this._player?this._player.destroy().then(function(){return t._destroy()}).catch(function(){t._destroy(),c.Log.error("shaka could not be destroyed")}):this._destroy(),l()(h()(a.prototype),"destroy",this).call(this)}},{key:"_setup",value:function(){function t(){e._player=e._createPlayer(),e._setInitialConfig(),e._loadSource()}var e=this;this._isShakaReadyState=!1,this._ccIsSetup=!1;this._player?this._player.destroy().then(t):t()}},{key:"_createPlayer",value:function(){var t=new d.a.Player(this.el);return t.addEventListener("error",this._onError.bind(this)),t.addEventListener("adaptation",this._onAdaptation.bind(this)),t.addEventListener("buffering",this._handleShakaBufferingEvents.bind(this)),t.addEventListener("sessiondata",this._onHeaders.bind(this)),t}},{key:"_onHeaders",value:function(t){this.trigger(c.Events.PLAYBACK_FRAGMENT_LOADED,t)}},{key:"_setInitialConfig",value:function(){this._options.shakaConfiguration&&this._player.configure(this._options.shakaConfiguration),this._options.shakaOnBeforeLoad&&this._options.shakaOnBeforeLoad(this._player)}},{key:"_loadSource",value:function(){var e=this;this._player.load(this._options.src).then(function(){return e._loaded()}).catch(function(t){return e._setupError(t)})}},{key:"_onTimeUpdate",value:function(){var t;this.shakaPlayerInstance&&(t={current:this.getCurrentTime(),total:this.getDuration(),firstFragDateTime:this.getProgramDateTime()},this._lastTimeUpdate&&t.current===this._lastTimeUpdate.current&&t.total===this._lastTimeUpdate.total||(this._lastTimeUpdate=t,this.trigger(c.Events.PLAYBACK_TIMEUPDATE,t,this.name)))}},{key:"_handleBufferingEvents",value:function(){}},{key:"_handleShakaBufferingEvents",value:function(t){this._stopped||(this._isBuffering=t.buffering,this._isBuffering?this._onBuffering():this._onBufferfull())}},{key:"_onBuffering",value:function(){this.trigger(c.Events.PLAYBACK_BUFFERING)}},{key:"_onBufferfull",value:function(){this.trigger(c.Events.PLAYBACK_BUFFERFULL),this._isSeeking&&this._onSeeked(),this.isPlaying()&&this._onPlaying()}},{key:"_loaded",value:function(){this._onShakaReady(),this._startToSendStats(),this._fillLevels(),this._checkForClosedCaptions()}},{key:"_fillLevels",value:function(){0===this._levels.length&&(this._levels=this.videoTracks.map(function(t){return{id:t.id,label:"".concat(t.height,"p")}}).reverse(),this.trigger(c.Events.PLAYBACK_LEVELS_AVAILABLE,this.levels))}},{key:"_startToSendStats",value:function(){var t=this,e=this._options.shakaSendStatsInterval||3e4;this.sendStatsId=setInterval(function(){return t._sendStats()},e)}},{key:"_sendStats",value:function(){this.trigger(c.Events.PLAYBACK_STATS_ADD,this._player.getStats())}},{key:"_setupError",value:function(t){this._onError(t)}},{key:"_onError",value:function(t){var e={shakaError:t,videoError:this.el.error},r=e.shakaError.detail||e.shakaError,i=r.category,n=r.code,r=r.severity;if(e.videoError||!n&&!i)return l()(h()(a.prototype),"_onError",this).call(this);e=r===d.a.util.Error.Severity.CRITICAL,i={code:"".concat(i,"_").concat(n),description:"Category: ".concat(i,", code: ").concat(n,", severity: ").concat(r),level:e?c.PlayerError.Levels.FATAL:c.PlayerError.Levels.WARN,raw:t},n=this.createError(i);c.Log.error("Shaka error event:",n),this.trigger(c.Events.PLAYBACK_ERROR,n)}},{key:"_onAdaptation",value:function(){var t=this.videoTracks.filter(function(t){return!0===t.active})[0];this._fillLevels(),this._sendStats(),this._pendingAdaptationEvent&&(this.trigger(c.Events.PLAYBACK_LEVEL_SWITCH_END),this._pendingAdaptationEvent=!1),c.Log.debug("an adaptation has happened:",t),this.highDefinition=720<=t.height,this.trigger(c.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition),this.trigger(c.Events.PLAYBACK_BITRATE,{bandwidth:t.bandwidth,width:t.width,height:t.height,level:t.id,bitrate:t.videoBandwidth})}},{key:"_updateSettings",value:function(){"vod"===this.getPlaybackType()?this.settings.left=["playpause","position","duration"]:this.dvrEnabled?this.settings.left=["playpause"]:this.settings.left=["playstop"],this.settings.seekEnabled=this.isSeekEnabled(),this.trigger(c.Events.PLAYBACK_SETTINGSUPDATE)}},{key:"checkIfCritical",value:function(){var r=this;this._options.mediaInfo.then(function(t){var e=t.criticalError,t=t.errorCodec;e&&(r._isShakaReadyState=!1,r.criticalError=!0,r.stop(),r.trigger(c.Events.PLAYBACK_ERROR,{UI:{title:"Playback error",message:"Could not play ".concat(t||"this"," codec")},raw:{response:{critical:!0}}}))})}},{key:"_destroy",value:function(){this._isShakaReadyState=!1,c.Log.debug("shaka was destroyed")}}],[{key:"Events",get:function(){return{SHAKA_READY:"shaka:ready"}}},{key:"shakaPlayer",get:function(){return d.a}},{key:"canPlay",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=(d.a.polyfill.installAll(),d.a.Player.isBrowserSupported()),t=t.split("?")[0].match(/.*\.(.*)$/)||[];return r&&("mpd"===t[1]||-1<e.indexOf("application/dash+xml"))}}]),a}(c.HTML5Video);e.a=r},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(7),s=r.n(e),e=r(8),o=r.n(e),e=r(9),l=r.n(e),e=r(3),u=r.n(e),h=r(1),e=r(177),c=r.n(e);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=i?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}var i=function(t){o()(i,t);var r=d(i);function i(t){var e;return n()(this,i),(e=r.call(this,t)).listenTo(e.container,h.Events.MEDIACONTROL_CONTAINERCHANGED,e.calculatePos),e.listenToOnce(e.container,h.Events.CONTAINER_LOADEDMETADATA,function(t){e.render(t)}),e}return a()(i,[{key:"name",get:function(){return"Flussonic paning/zooming plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"destroy",value:function(){s()(u()(i.prototype),"destroy",this).call(this)}},{key:"render",value:function(t){var e=this,t=t.data;this._video=t.target,this.zoomElement=c()(this._video,{maxZoom:10,minZoom:1,smoothScroll:!1,zoomDoubleClickSpeed:1,filterKey:function(){return!0},onDoubleClick:function(t){return!1}}),this.zoomElement.on("transform",function(t){e.calculatePos(t)})}},{key:"calculatePos",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0;if(t)r=t.getTransform();else{if(!this.zoomElement)return;r=this.zoomElement.getTransform()}function e(t){return Math.floor(100*t)/100}var r,i,n,a,s,o;r&&(i=r=(t=r).x,n=t=t.y,a=!1,s=this.container.el.getBoundingClientRect(),o=this._video.getBoundingClientRect(),s)&&(o.left>s.left&&(i=s.left,a=!0),o.top>s.top&&(n=s.top,a=!0),o.right<s.right&&(i=s.right-o.width,a=!0),o.bottom<s.bottom&&(n=s.bottom-o.height,a=!0),!a||e(i)===e(r)&&e(n)===e(t)||this.zoomElement.moveTo(i,n))}}]),i}(h.ContainerPlugin)},,function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1),e=r(179),h=r.n(e);r(388);function c(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var i=function(t){s()(i,t);var r=c(i);function i(t){var e;return n()(this,i),(e=r.call(this,t)).core=t,e.guid=e.randomGUID(),e}return a()(i,[{key:"name",get:function(){return"Flussonic Video Thumbnails"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"template",get:function(){return Object(u.template)(h.a)}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_MOUSEMOVE_SEEKBAR,this.onMouseMove.bind(this)),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_MOUSELEAVE_SEEKBAR,this.onMouseLeave)}},{key:"containerChanged",value:function(){this.stopListening(),this.bindEvents(),this.bindHLS()}},{key:"bindHLS",value:function(){var e=this,t=this.core.getCurrentPlayback()._hls;t&&!this.attachedEvent?(this.listenTo(t,"hlsLevelPtsUpdated",this.hlsPtsUpdated.bind(this)),this.attachedEvent=!0,this.hls=!0):this.attachedEvent||this.core.getCurrentPlayback().on("playback:ready",function(){var t=e.core.getCurrentPlayback()._player;t&&(e.player=t,e.hls=!1,(t=e.getThumbnailImageTrack(t))&&t.id&&(e.thumbnailTrackId=t.id),e.attachedEvent=!0)})}},{key:"hlsPtsUpdated",value:function(t,e){e.details.fragments[0]&&(this.totalDuration=e.details.totalduration,this.startProgramDateTime=e.details.fragments[0].rawProgramDateTime)}},{key:"setUpStyles",value:function(t){return t.addClass("thumbnail_placeholder")}},{key:"onMouseMove",value:function(t){var t=t.clientX,e=this.core.mediaControl.$seekBarContainer.width();this.updateThumbPosition(e,t),!this.hls&&this.player?this.updateJpegUrl(e,t):this.totalDuration&&this.startProgramDateTime?this.updateThumbUrl(e,t):this.hide()}},{key:"updateThumbUrl",value:function(t,e){var r=new Date(this.startProgramDateTime),e=e-this.core.mediaControl.$seekBarContainer.offset().left,e=Math.min(1,Math.max(e/t,0)),t=r.getTime(),r=this.totalDuration*e*1e3,e=new Date(t+r),t=this.getBaseUrl(this.core,e);document.getElementById(this.guid).setAttribute("src",t)}},{key:"updateJpegUrl",value:function(t,e){var r,i=this;this.thumbnailTrackId&&!this.hls&&this.player&&(e=e-this.core.mediaControl.$seekBarContainer.offset().left,t=((r=this.player.seekRange()).end-r.start)/t,r=r.start+e*t,this.player.getThumbnails(this.thumbnailTrackId,r).then(function(t){t=t.uris;t&&document.getElementById(i.guid).setAttribute("src",t)}))}},{key:"updateThumbPosition",value:function(t,e){t=Math.max(0,Math.min(t-300,e-150));this.$el.css("left",t),this.show()}},{key:"onMouseLeave",value:function(){this.hide()}},{key:"onRendered",value:function(){this.$el.html(this.template({guid:this.guid,hls:this.hls})),this.setUpStyles(this.$el)}},{key:"render",value:function(){this.onRendered();var t=this.core.$el.find(".media-control-background");t[0]&&t.append(this.$el)}},{key:"show",value:function(){this.$el.css("opacity",1),this.$el.css("height","180px")}},{key:"hide",value:function(){this.$el.css("opacity",0),this.$el.css("height","0")}},{key:"s4",value:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}},{key:"randomGUID",value:function(){return"".concat(this.s4()+this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4()).concat(this.s4()).concat(this.s4())}},{key:"zeroBased",value:function(t){return t<10?"0".concat(t):String(t)}},{key:"relUrl",value:function(t){return"".concat(this.zeroBased(t.getUTCFullYear()),"/").concat(this.zeroBased(t.getUTCMonth()+1),"/").concat(this.zeroBased(t.getUTCDate()),"/").concat(this.zeroBased(t.getUTCHours()),"/").concat(this.zeroBased(t.getUTCMinutes()),"/").concat(this.zeroBased(t.getUTCSeconds()),"-preview.mp4")}},{key:"getBaseUrl",value:function(t,e){var t=t._options,r=t.source,t=t.authToken,r="".concat(r.slice(0,r.lastIndexOf("/")),"/");return"".concat(r).concat(this.relUrl(e)).concat(t?"?".concat(t):"")}},{key:"getThumbnailImageTrack",value:function(t){t=t.getImageTracks();return t&&t.length,t[0]}}]),i}(u.UICorePlugin)},function(t,e){t.exports='<% if (hls) { %>\n<video\n  autoplay\n  id="<%= guid %>"\n  width="100%"\n  type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\'\n></video>\n<% } else { %>\n<img id="<%= guid %>" alt="" />\n<% }; %>\n'},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1),h=r(181),e=r(182),c=r.n(e);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var i=function(t){s()(i,t);var e=d(i);function i(t){var r;return n()(this,i),(r=e.call(this,t)).$el.addClass("media-control-button media-control-icon").css({float:"right",height:"100%"}).append(c.a),r.$el.click(function(){var t=r.core.mediaControl.container.playback.el,e=document.createElement("canvas");e.width=t.videoWidth,e.height=t.videoHeight;e.getContext("2d").drawImage(t,0,0);t=e.toDataURL("image/jpeg");r.core.mediaControl.trigger("capture:base64",t)}),r}return a()(i,[{key:"name",get:function(){return"Flussonic capture plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"tagName",get:function(){return"button"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"bindEvents",value:function(){this.listenToOnce(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,function(){this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,"capture:base64",function(t){Object(h.saveAs)(t,"screenshot_".concat(Date.now(),".jpg"))})})}},{key:"unBindEvents",value:function(){this.stopListening(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED)}},{key:"render",value:function(){return this.core.mediaControl.$el.find(".media-control-right-panel").append(this.el),this}}]),i}(u.UICorePlugin)},function(r,i,t){!function(t){var e;void 0!==(e="function"==typeof(e=function(){"use strict";function n(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function h(t,e,r){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){o(i.response,e,r)},i.onerror=function(){console.error("could not download file")},i.send()}function a(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(r)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof t&&t.global===t?t:void 0,d=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!d?function(t,e,r){var i=c.URL||c.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener","string"==typeof t?(n.href=t,n.origin===location.origin?s(n):a(n.href)?h(t,e,r):s(n,n.target="_blank")):(n.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(n.href)},4e4),setTimeout(function(){s(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(n(t,r),e);else if(a(t))h(t,e,r);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){s(i)})}}:function(t,e,r,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return h(t,e,r);var n="application/octet-stream"===t.type,a=/constructor/i.test(c.HTMLElement)||c.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||n&&a||d)&&"undefined"!=typeof FileReader){var o=new FileReader;o.onloadend=function(){var t=o.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},o.readAsDataURL(t)}else{var l=c.URL||c.webkitURL,u=l.createObjectURL(t);i?i.location=u:location.href=u,i=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});c.saveAs=o.saveAs=o,true&&(r.exports=o)})?e.apply(i,[]):e)&&(r.exports=e)}.call(this,t(35))},function(t,e){t.exports='<svg viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1024 672q119 0 203.5 84.5t84.5 203.5-84.5 203.5-203.5 84.5-203.5-84.5-84.5-203.5 84.5-203.5 203.5-84.5zm704-416q106 0 181 75t75 181v896q0 106-75 181t-181 75h-1408q-106 0-181-75t-75-181v-896q0-106 75-181t181-75h224l51-136q19-49 69.5-84.5t103.5-35.5h512q53 0 103.5 35.5t69.5 84.5l51 136h224zm-704 1152q185 0 316.5-131.5t131.5-316.5-131.5-316.5-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5z" fill="#fff"></path></svg>'},function(t,e,r){"use strict";r.d(e,"a",function(){return f});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(46),s=r.n(e),e=r(7),a=r.n(e),e=r(8),o=r.n(e),e=r(9),l=r.n(e),e=r(3),u=r.n(e),e=r(17),h=r.n(e),c=r(1);r(389);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=i?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}var f=function(t){o()(r,t);var e=d(r);function r(t){var a;return i()(this,r),a=e.call(this,t),h()(s()(a),"frameLooper",function(){if(a.audioConnected){for(var t,e=new Uint8Array(a.analyser.frequencyBinCount),r=(a.analyser.getByteFrequencyData(e),0),i=0;i<e.length;i++)0!==e[i]&&r<(t=Math.abs(e[i]))&&(r=t);var n=Math.round(a.canvas.offsetHeight/(256/r))||0;a.eqBarBack.style.height="".concat(a.canvas.offsetHeight,"px"),a.eqBar.style.height="".concat(n,"px")}}),a.container=t,a.audioConnected=!1,a.render(),a}return n()(r,[{key:"name",get:function(){return"EqualizerPlugin"}},{key:"bindEvents",value:function(){this.listenTo(this.container,c.Events.CONTAINER_VOLUME,this.connectToAudio)}},{key:"destroy",value:function(){clearInterval(this.timerStatus),a()(u()(r.prototype),"destroy",this).call(this)}},{key:"connectToAudio",value:function(t){100===t&&(this.context=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.context.createAnalyser(),this.source=this.context.createMediaElementSource(this.container.$el.find("video")[0]),this.source.connect(this.analyser),this.analyser.connect(this.context.destination),this.audioConnected=!0,this.frameLooper=this.frameLooper.bind(this),clearInterval(this.timerStatus),this.timerStatus=setInterval(this.frameLooper,25),this.stopListening(this.container,c.Events.CONTAINER_VOLUME,this.connectToAudio))}},{key:"render",value:function(){return this.container.$el.append('<div class="equalizer"><div class="eq-bar"><div class="eq-bar-back"></div></div></div>'),this.canvas=this.container.$el.find(".equalizer")[0],this.eqBar=this.container.$el.find(".eq-bar")[0],this.eqBarBack=this.container.$el.find(".eq-bar-back")[0],this}}]),r}(c.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(7),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1);function h(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var c=function(t){s()(r,t);var e=h(r);function r(t){return i()(this,r),(t=e.call(this,t)).background="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAFoBAMAAAA1HFdiAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAG1BMVEX5+fn//wAA//8A/wD/AP//AAAAAP8XFxf///8H5gWfAAAAAWJLR0QIht6VegAAAAd0SU1FB98IBRIsAXmGk48AAAI5SURBVHja7dJBDYBADADBs4AFLGABC1iohbOPhv1BMvu+NLlp10odqTN1pe7Uk5pQ8wMIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECDA/wKWxzM71T7ZZrfltNnppgACBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAL8B+ALjSfYzPnmdzgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0wOC0wNVQxODo0NDowMSswMTowMCL95a4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMDgtMDVUMTg6NDQ6MDErMDE6MDBToF0SAAAAAElFTkSuQmCC","boolean"==typeof t.options.calmError&&t.options.calmError&&(t.background=""),t.options.dontShowError&&(t.dontShowError=parseInt(t.options.dontShowError,10),1==t.options.dontShowError)&&(t.dontShowError=1),t.listenTo(t.container,u.Events.CONTAINER_ERROR,t.onError),t}return n()(r,[{key:"name",get:function(){return"Flussonic error plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"destroy",value:function(){this.t="stop",a()(l()(r.prototype),"destroy",this).call(this)}},{key:"hide",value:function(){this._err&&this._err.remove()}},{key:"show",value:function(t,e){var r,i=t.title,n=t.message,i=(this.hide(),t&&i?i:""),t=t&&n?n:"A fatal error occured.",n="";e&&(r=e.code,e=void 0===(e=e.text)?"":e,n=(r=void 0===r?"":r)||e?"Code:".concat(r||""," - ").concat(e||""):""),this._err=$("<div>").css({position:"absolute","z-index":"999",width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":" center","flex-direction":"column","background-image":"url(".concat(this.background,")"),"background-size":"100% 100%","background-repeat":"no-repeat","background-color":"#777","text-align":"center","font-weight":"bold","text-shadow":"1px 1px ".concat(this.options.calmError?"#000":"#fff"),color:"".concat(this.options.calmError?"#fff":"#000")}).append($("<h1>").text(i).css({"font-size":"200%"})).append($("<h2>").text(t).css({"font-size":"150%","margin-top":"8px"})).append($("<h3>").text(n).css({"font-size":"100%","margin-top":"8px","margin-bottom":"16px"})).append($('<p class="retrying_text">').html('Retrying in <span class="retry-counter">10</span> seconds ...').css({"font-size":"120%",margin:"15px"})),this.dontShowError&&0<this.dontShowError?--this.dontShowError:this.container&&this.container.$el.prepend(this._err)}},{key:"onError",value:function(t){if(t){var e=t.UI,r=t.raw;if(r){r=r.response;if(!this.container)return;if(this.show(e,r),r&&"critical"in r&&r.critical)return $(".retrying_text").text(""),this.t,void this.container.getPlugin("click_to_pause").disable()}}this.container.getPlugin("click_to_pause").disable();var i,n=10,a=function(){if(clearTimeout(i),"stop"!==this.t){if(0===n)return this.container.getPlugin("click_to_pause").enable(),this.options.errorPlugin&&this.options.errorPlugin.onRetry?void this.options.errorPlugin.onRetry(t):(this.container.stop(),this.container.play(),void this.hide());$(".retry-counter").text(n),n--,this.t=n,i=setTimeout(a,1e3)}}.bind(this);a()}}]),r}(u.ContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),a=r.n(e),e=r(6),s=r.n(e),e=r(8),o=r.n(e),e=r(9),n=r.n(e),e=r(3),l=r.n(e),u=r(1),e=r(186),h=r.n(e),e=r(187),c=r.n(e);r(390);function d(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),n()(this,t)}}var i=function(t){o()(n,t);var i=d(n);function n(t){a()(this,n);var e,r=((e=i.call(this,t)).core=t).options.closedCaptionsConfig;return e._title=r&&r.title?r.title:null,e._ariaLabel=r&&r.ariaLabel?r.ariaLabel:"cc-button",e._labelCb=r&&r.labelCallback&&"function"==typeof r.labelCallback?r.labelCallback:function(t){return t.name},e.hideCCOnStart=t.options.hideCCOnStart,e.tracksAdded=!1,e.firstTime=!0,e.onSubtitleAvailable(),e}return s()(n,[{key:"name",get:function(){return"Flussonic closed captions"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"template",get:function(){return Object(u.template)(c.a)}},{key:"events",get:function(){return{"click [data-cc-button]":"toggleContextMenu","click [data-cc-select]":"onTrackSelect"}}},{key:"attributes",get:function(){return{class:"cc-controls","data-cc-controls":""}}},{key:"bindEvents",value:function(){this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.containerChanged),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,u.Events.MEDIACONTROL_HIDE,this.hideContextMenu),this.bindContainerEvents()}},{key:"bindContainerEvents",value:function(){this.container=this.core.activeContainer,this.container&&(this.listenTo(this.container,u.Events.CONTAINER_SUBTITLE_CHANGED,this.onSubtitleChanged),this.listenTo(this.container,u.Events.CONTAINER_STOP,this.onContainerStop))}},{key:"onContainerStop",value:function(){this.ccAvailable(!1)}},{key:"containerChanged",value:function(){var t=this.core.plugins;0<t.length&&t.forEach(function(t){"ClosedCaptions"===t.constructor.name&&(t.$el[0].style.display="none"),"closed_captions"===t.name&&(t.$el[0].style.display="none",t.disable())}),this.stopListening(),this.bindEvents()}},{key:"onSubtitleAvailable",value:function(){this.renderCcButton(),this.ccAvailable(!0)}},{key:"onSubtitleChanged",value:function(t){var e;this.setCurrentContextMenuElement(t.id),this.firstTime&&(e=(t=this.container.$el.find("video")[0].textTracks).length,t&&e&&(this.setCurrentContextMenuElement(e-1),this.$el.addClass("available")),this.firstTime=!1)}},{key:"onTrackSelect",value:function(t){var e=parseInt(t.target.dataset.ccSelect,10);return this.container.closedCaptionsTrackId=e,this.hideContextMenu(),t.noProp||t.stopPropagation(),!1}},{key:"ccAvailable",value:function(t){this.$el[t?"addClass":"removeClass"]("available")}},{key:"toggleContextMenu",value:function(){this.$el.find("ul").toggle()}},{key:"hideContextMenu",value:function(){this.$el.find("ul").hide()}},{key:"contextMenuElement",value:function(t){return this.$el.find("ul a".concat(Number.isNaN(t)?"":'[data-cc-select="'.concat(t,'"]'))).parent()}},{key:"mainButtonElement",value:function(){return this.$el.find("button.cc-button[data-cc-button]")}},{key:"setCurrentContextMenuElement",value:function(t){void 0===this._trackId&&void 0!==this.startingSubs?(this.contextMenuElement().removeClass("current"),this.contextMenuElement(this.startingSubs).addClass("current"),this.$el.find("button.cc-button[data-cc-button]").addClass("enabled"),this._trackId=this.startingSubs,this.startingSubs=void 0):this._trackId!==t&&(this.contextMenuElement(this._trackId).removeClass("current"),this.contextMenuElement(t).addClass("current"),this.$ccButton[-1<t?"addClass":"removeClass"]("enabled"),this._trackId=t)}},{key:"renderCcButton",value:function(){for(var t=this.container?this.container.closedCaptionsTracks:[],e=0;e<t.length;e+=1)t[e].label=this._labelCb(t[e]);this.$el.html(this.template({ariaLabel:this._ariaLabel,disabledLabel:this.core.i18n.t("disabled"),title:this._title,tracks:t})),this.$ccButton=this.$el.find("button.cc-button[data-cc-button]"),this.$ccButton.append(h.a),this.$el.append(this.style)}},{key:"render",value:function(){this.renderCcButton();var t=this.core.mediaControl.$el.find("button[data-fullscreen]");return t[0]?this.$el.insertAfter(t):this.core.mediaControl.$el.find(".media-control-right-panel[data-media-control]").prepend(this.$el),this}}]),n}(u.UICorePlugin)},function(t,e){t.exports='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 49 41.8" style="enable-background:new 0 0 49 41.8;" xml:space="preserve"><path d="M47.1,0H3.2C1.6,0,0,1.2,0,2.8v31.5C0,35.9,1.6,37,3.2,37h11.9l3.2,1.9l4.7,2.7c0.9,0.5,2-0.1,2-1.1V37h22.1 c1.6,0,1.9-1.1,1.9-2.7V2.8C49,1.2,48.7,0,47.1,0z M7.2,18.6c0-4.8,3.5-9.3,9.9-9.3c4.8,0,7.1,2.7,7.1,2.7l-2.5,4 c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2c0,0-2.7,2.9-7.6,2.9 C10.8,27.9,7.2,23.5,7.2,18.6z M36.9,27.9c-6.4,0-9.9-4.4-9.9-9.3c0-4.8,3.5-9.3,9.9-9.3C41.7,9.3,44,12,44,12l-2.5,4 c0,0-1.7-1.7-4.2-1.7c-2.8,0-4.3,2.1-4.3,4.3c0,2.1,1.5,4.4,4.5,4.4c2.5,0,4.9-2.1,4.9-2.1l2.2,4.2C44.5,25,41.9,27.9,36.9,27.9z"></path></svg>'},function(t,e){t.exports='<button\n  type="button"\n  class="cc-button media-control-button media-control-icon"\n  data-cc-button\n  aria-label="<%= ariaLabel %>"\n></button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <li><a href="#" data-cc-select="-1"><%= disabledLabel %></a></li>\n  <% for (var i = 0; i < tracks.length; i++) { %>\n  <li class="<% if (tracks[i].track.mode == \'showing\') { %>current<% }; %>">\n    <a href="#" data-cc-select="<%= tracks[i].id %>">\n      <%= tracks[i].label %> <% if (tracks[i].track.language) { %> (<%=\n      tracks[i].track.language %>) <% }; %></a\n    >\n  </li>\n  <% }; %>\n</ul>\n'},function(t,e,r){"use strict";r.d(e,"a",function(){return v});var e=r(62),a=r.n(e),e=r(5),s=r.n(e),e=r(6),o=r.n(e),e=r(46),l=r.n(e),e=r(7),u=r.n(e),e=r(8),h=r.n(e),e=r(9),n=r.n(e),e=r(3),c=r.n(e),e=r(17),d=r.n(e),f=r(1);function i(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){d()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c()(r);return t=i?(t=c()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),n()(this,t)}}var v=function(t){h()(n,t);var i=g(n);function n(t){s()(this,n),e=i.call(this,t),d()(l()(e),"resetStats",function(){e.playerStatsObject={proto:"mseld",user_agent:navigator.userAgent,bytes:0,application:{application_name:"live_player",application_version:e._options.version,stall_count:0,pause_count:0,error_count:0,reconnect_count:0,bitrate_change_count:0,live_duration:0,stall_duration:0,pause_duration:0,total_video_frames:0,dropped_video_frames:0,corrupted_video_frames:0}}}),d()(l()(e),"start",function(){e.sendingInterval=setInterval(function(){e.post()},e.statsSendTime)}),d()(l()(e),"stop",function(){e.sendingInterval&&(clearInterval(e.sendingInterval),e.post())}),d()(l()(e),"post",function(){var t;e.playerStatsObject.started_at&&(t=e.playerStatsObject.source_id,t=e.statsURL.replace(/sessions/,"sessions/".concat(t||"")),e._options.statsSendEnable)&&fetch(t,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify(e.getStats())})}),e.uuid=e.generateUUID();var e,t=e._options,r=t.statsSendTime,t=t.src;return e.statsSendTime=1e3*r||6e4,e.statsURL=t.replace(/index.mpd/,"sessions").replace(/index.fmp4.m3u8/,"sessions").replace(/mse_ld/,"sessions"),e.resetStats(),e.playerStatsObject=e.getStats(),e}return o()(n,[{key:"name",get:function(){return"StatsPlugin"}},{key:"bindEvents",value:function(){var r=this,t=this._options.playback;this.proto=this._options.proto;var e=["PLAYBACK_PLAY_INTENT","PLAYBACK_LOADEDMETADATA","PLAYBACK_PLAYBACKSTATE","PLAYBACK_PROGRESS","PLAYBACK_READY","CONTAINER_BITRATE","PLAYBACK_BUFFERING","PLAYBACK_BUFFERFULL","PLAYBACK_ERROR","PLAYBACK_FRAGMENT_LOADED","PLAYBACK_STOP","PLAYBACK_STATS_ADD"];(e=!!t.MSE?e:[].concat(a()(e),["PLAYBACK_PAUSE","PLAYBACK_PLAY"])).forEach(function(e){r.listenTo(r.container.playback,f.Events[e],function(t){r.onEvent(f.Events[e],t)})})}},{key:"onEvent",value:function(t,e){var r,i,n=this,a=this._options.playback,s=!!a.MSE;switch(t){case"playback:ready":s||(this.playerStatsObject.proto=this.proto||"hls",this.playerStatsObject.opened_at=Date.now()),this.start();break;case"playback:play:intent":s&&this.updateMseStats();break;case"playback:play":this.playerStatsObject.started_at=Date.now(),this.pauseStartedAt&&(l=this.playerStatsObject.application)&&(l=l.pause_duration,l+=Date.now()-this.pauseStartedAt,this.addPlayerStat("pause_duration",!1,l),delete this.pauseStartedAt);break;case"playback:buffering":this.buferingStart=Date.now(),this.addPlayerStat("stall_count");break;case"playback:bufferfull":this.buferingStart&&(l=this.playerStatsObject.application)&&(l=l.stall_duration,l+=Date.now()-this.buferingStart,this.addPlayerStat("stall_duration",!1,l),delete this.buferingStart);break;case"playback:loadedmetadata":s||this.addPlayerStat("bitrate_change_count");break;case"playback:error":s||this.addPlayerStat("error_count");break;case"playback:stop":s?this.updateMseStats():this.playerStatsObject.closed_at=Date.now(),this.stop();break;case"playback:pause":this.addPlayerStat("pause_count"),this.pauseStartedAt=Date.now();break;case"playback:loadedmetadata":this.playerStatsObject.first_byte_at=Date.now();break;case"playback:fragment:loaded":var o=e.networkDetails;o.onload=function(){n.playerStatsObject.source_id=o.getResponseHeader("X-Sid")};var l=e.frag.stats.loaded;this.playerStatsObject.bytes+=l;break;case"playback:progress":s?this.updateMseStats():(this.playerStatsObject.updated_at=Date.now(),this.segmentStart?(l=this.playerStatsObject.application)&&(l=l.live_duration,l+=Date.now()-this.segmentStart,this.addPlayerStat("live_duration",!1,l),delete this.segmentStart):this.segmentStart=Date.now(),this.playerStatsObject=p(p({},this.playerStatsObject),{},{id:this.uuid}),r=(l=a.el.getVideoPlaybackQuality()).corruptedVideoFrames,i=l.droppedVideoFrames,l=l.totalVideoFrames,this.addPlayerStat("total_video_frames",!1,l),this.addPlayerStat("dropped_video_frames",!1,i),this.addPlayerStat("corrupted_video_frames",!1,r))}"playback:ready"!==t&&this._options.statsCallback(this.getStats())}},{key:"updateMseStats",value:function(){var t;this._options.playback.MSE&&(t=this.getMseStats(),this.playerStatsObject=p(p({},this.playerStatsObject),t))}},{key:"getMseStats",value:function(){var t=this._options.playback.getStats();return delete t.application_name,delete t.application_version,delete t.user_agent,delete t.uuid,t}},{key:"addPlayerStat",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=this.playerStatsObject.application;i&&(r?i[t]=r:e&&i[t]++,this.playerStatsObject.application=i)}},{key:"getStats",value:function(){return p(p({},this.playerStatsObject),{},{id:this.uuid})}},{key:"generateUUID",value:function(){var r=(new Date).getTime(),i="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random();return 0<r?(e=(r+e)%16|0,r=Math.floor(r/16)):(e=(i+e)%16|0,i=Math.floor(i/16)),("x"===t?e:3&e|8).toString(16)})}},{key:"destroy",value:function(){u()(c()(n.prototype),"destroy",this).call(this)}}]),n}(f.UIContainerPlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var e=r(5),i=r.n(e),e=r(6),n=r.n(e),e=r(7),a=r.n(e),e=r(8),s=r.n(e),e=r(9),o=r.n(e),e=r(3),l=r.n(e),u=r(1);function h(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l()(r);return t=i?(t=l()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),o()(this,t)}}var c=function(t){s()(r,t);var e=h(r);function r(){return i()(this,r),e.apply(this,arguments)}return n()(r,[{key:"name",get:function(){return"Flussonic timeline check plugin"}},{key:"supportedVersion",get:function(){return{min:"0.4.18"}}},{key:"bindEvents",value:function(){var t=this;this.listenTo(this.core,u.Events.CORE_ACTIVE_CONTAINER_CHANGED,this.checkForLive),this.checkingLive||(this.checkingLive=setInterval(function(){t.checkForLive()},1e3))}},{key:"destroy",value:function(){clearInterval(this.checkingLive),a()(l()(r.prototype),"destroy",this).call(this)}},{key:"checkForLive",value:function(){this.stopListening(),this.bindEvents(),this.mediaControl=this.core.mediaControl;var t=this.mediaControl.$el;"live"===this.core.getPlaybackType()&&t.addClass("live")}},{key:"render",value:function(){this.checkForLive()}}]),r}(u.UICorePlugin)},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var e=r(5),n=r.n(e),e=r(6),a=r.n(e),e=r(7),s=r.n(e),e=r(8),o=r.n(e),e=r(9),l=r.n(e),e=r(3),u=r.n(e),h=r(1);function c(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u()(r);return t=i?(t=u()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),l()(this,t)}}var i=function(t){o()(i,t);var r=c(i);function i(t){n()(this,i);var e=(t=r.call(this,t))._options.playbackDuration;return t.playbackDuration=e,t}return a()(i,[{key:"name",get:function(){return"SegmentPlayPlugin"}},{key:"bindEvents",value:function(){var t=this;this.listenTo(this.container.playback,h.Events.PLAYBACK_PLAY,function(){t.stopTimer()})}},{key:"stopTimer",value:function(){var t=this;this.playbackDuration&&(this.stopTimeout=setTimeout(function(){t.container.pause(),setTimeout(function(){t.container.stop()},0)},1e3*this.playbackDuration))}},{key:"destroy",value:function(){clearTimeout(this.stopTimeout),s()(u()(i.prototype),"destroy",this).call(this)}}]),i}(h.UIContainerPlugin)},,,,,,,function(t,u,h){"use strict";h.r(u),function(m){var t=h(5),y=h.n(t),t=h(6),e=h.n(t),t=h(8),r=h.n(t),t=h(9),n=h.n(t),t=h(3),a=h.n(t),t=h(17),i=h.n(t),E=(h(200),h(349),h(350),h(351),h(1)),T=h(391),b=h(22),A=h(93),_=h(158),S=h(161),L=h(164),k=h(167),R=h(169),w=h(172),I=h(173),D=h(174),C=h(175),P=h(122),x=h(176),O=h(178),s=h(26),M=h(180),F=h(183),N=h(184),B=h(185),U=h(188),j=h(189),G=h(190);function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=a()(r);return t=i?(t=a()(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),n()(this,t)}}function l(e,t){var r,i=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)),i}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){i()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}t=function(t){r()(v,t);var g=o(v);function v(t){y()(this,v);var e,r,i=new _.a(t),n=i.get("debug"),a=i.get("panzoom"),s=i.get("equalizer"),o=i.get("tracks"),l=i.get("dontShowError"),u=i.get("hideMediaControl"),h=i.get("disableVideoTagContextMenu"),c=i.get("loop"),d=((p={}).mediaInfo=(f=i).getMediaInfo(),p.source=f.constructSource(P.a.isSupported(),!1)(),d=f.get("autoplay"),p.autoPlay||(p.autoPlay=!1!==d),p.authToken=f.get("authToken"),p.logo=f.get("logo"),p.poster=f.get("poster"),p.playback||(p.playback={hlsUseNextLevel:!1,playInline:!0,recycleVideo:E.Browser.isMobile,crossOrigin:"anonymous"}),p.playback.hlsjsConfig||(p.playback.hlsjsConfig={debug:f.get("debug"),lowLatencyMode:!0,latency:.25,maxLatency:.5,liveSyncPosition:.25,backBufferLength:90,autoStartLoad:!0,subtitleDisplay:!0,enableWebVTT:!0}),!1===p.autorestart||p.events||(p.events={}),"statsSendEnable"in p||(p.statsSendEnable=!0),p),f=!0,p=i.get("calmError"),p=(p&&(f=p),i.get("play_duration")),t=$($($($($($($($($($($($($({},{onMediaInfo:function(){}}),t),d),n),a),s),o),u),h),c),f),l),{},{playbackDuration:p});return d=t,a=(n=i).get("isVideoPoster"),(d=$({},d)).plugins||(d.plugins=[]),d.plugins.push(C.a),d.logo&&d.plugins.push(R.a),a||("mse"===d.proto||"ws:"===d.protocol||"wss:"===d.protocol)&&d.autoPlay?d.plugins.push(L.a):d.plugins.push(k.a),d.plugins.push(P.a),(d.from||d.to||d.ago)&&d.plugins.push(O.a),d.plugins.push(S.a),d.plugins.push(M.a),d.plugins.push(N.a),d.plugins.push(B.a),d.plugins.push(j.a),d.panzoom&&d.plugins.push(x.a),d.debug&&(d.plugins.push(E.Log),E.Log.setLevel(0)),d.errorPlugin&&d.errorPlugin.hide(),0===d.volume||d.autoPlay||n.get("mute")?d.mute=!0:(d.volume||(d.volume=100),d.plugins.push(w.a)),d.plugins.push(I.a),d.eventLog&&d.plugins.push(D.a),d.equalizer&&d.plugins.push(F.a),d.plugins.push(A.a),r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}},A.a.isCodecType=function(t,e){e=r[e];return!!e&&!0===e[t.slice(0,4)]},d.plugins.push(A.a),d.plugins.push(U.a),d.plugins.push(G.a),d.sentryConfig&&d.sentryConfig.length&&(T.a({dsn:d.sentryConfig,environment:"production",release:"LivePlayer".concat(m.env.npm_package_version?"@".concat(m.env.npm_package_version):"")}),d.events.onError=function(t){b.a(t)}),t=d,i.get("debug")&&console.info("options",t),t.version=v.version||"",t.statsCallback=function(t){e.playerStatistics=t},e=g.call(this,t)}return e()(v,[{key:"name",get:function(){return"LivePlayer"}},{key:"getStats",value:function(){return this.playerStatistics}}],[{key:"parseUrl",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return s.j(t,r)}},{key:"version",get:function(){return"22.12.1"}}]),v}(E.Player);t.FlasHLS=E.FlasHLS,t.ClapprPlayer=E.Player,u.default=t}.call(this,h(94))},function(t,e,r){var i=r(61).default;t.exports=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0===r)return("string"===e?String:Number)(t);if(r=r.call(t,e||"default"),"object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(r,t){function i(t,e){return r.exports=i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r.exports.__esModule=!0,r.exports.default=r.exports,i(t,e)}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";!function(t){var e,r,l="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==t&&t||{},i="URLSearchParams"in l,n="Symbol"in l&&"iterator"in Symbol,u="FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch(t){return!1}}(),a="FormData"in l,h="ArrayBuffer"in l;function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function d(t){return t="string"!=typeof t?String(t):t}function s(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){if(2!=t.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(t){if(!t._noBody)return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function p(r){return new Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function g(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function v(t){var e;return t.slice?t.slice(0):((e=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),e.buffer)}function m(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:u&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:a&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():h&&u&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=v(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=v(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return o(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(u)return this.blob().then(g);throw new Error("could not read as ArrayBuffer")},this.text=function(){var t,e,r,i=o(this);if(i)return i;if(this._bodyBlob)return i=this._bodyBlob,t=new FileReader,e=p(t),r=(r=/charset=([A-Za-z0-9_-]+)/.exec(i.type))?r[1]:"utf-8",t.readAsText(i,r),e;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),i=0;i<e.length;i++)r[i]=String.fromCharCode(e[i]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(T)}),this.json=function(){return this.text().then(JSON.parse)},this}h&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),f.prototype.append=function(t,e){t=c(t),e=d(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},f.prototype.delete=function(t){delete this.map[c(t)]},f.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},f.prototype.set=function(t,e){this.map[c(t)]=d(e)},f.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},f.prototype.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),s(r)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),s(e)},f.prototype.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),s(r)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var y=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(t,e){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,i=(e=e||{}).body;if(t instanceof E){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(t=e.method||this.method||"GET",r=t.toUpperCase(),-1<y.indexOf(r)?r:t),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in l)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i),"GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache||((r=/([?&])_=[^&]*/).test(this.url)?this.url=this.url.replace(r,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime())}function T(t){var r=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(e=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),r.append(decodeURIComponent(e),decodeURIComponent(t)))}),r}function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.status<200||599<this.status)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=200<=this.status&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},m.call(E.prototype),m.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:200,statusText:""});return t.status=0,t.type="error",t};var A=[301,302,303,307,308],_=(b.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},l.DOMException);try{new _}catch(t){(_=function(t,e){this.message=t,this.name=e;e=Error(t);this.stack=e.stack}).prototype=Object.create(Error.prototype),_.prototype.constructor=_}function S(s,o){return new Promise(function(n,t){var e=new E(s,o);if(e.signal&&e.signal.aborted)return t(new _("Aborted","AbortError"));var r,a=new XMLHttpRequest;function i(){a.abort()}a.onload=function(){var t,r,e={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",r=new f,t.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t}).forEach(function(t){var t=t.split(":"),e=t.shift().trim();if(e){t=t.join(":").trim();try{r.append(e,t)}catch(t){console.warn("Response "+t.message)}}}),r)},i=(e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL"),"response"in a?a.response:a.responseText);setTimeout(function(){n(new b(i,e))},0)},a.onerror=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},a.onabort=function(){setTimeout(function(){t(new _("Aborted","AbortError"))},0)},a.open(e.method,function(e){try{return""===e&&l.location.href?l.location.href:e}catch(t){return e}}(e.url),!0),"include"===e.credentials?a.withCredentials=!0:"omit"===e.credentials&&(a.withCredentials=!1),"responseType"in a&&(u?a.responseType="blob":h&&(a.responseType="arraybuffer")),o&&"object"==typeof o.headers&&!(o.headers instanceof f||l.Headers&&o.headers instanceof l.Headers)?(r=[],Object.getOwnPropertyNames(o.headers).forEach(function(t){r.push(c(t)),a.setRequestHeader(t,d(o.headers[t]))}),e.headers.forEach(function(t,e){-1===r.indexOf(e)&&a.setRequestHeader(e,t)})):e.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),e.signal&&(e.signal.addEventListener("abort",i),a.onreadystatechange=function(){4===a.readyState&&e.signal.removeEventListener("abort",i)}),a.send(void 0===e._bodyInit?null:e._bodyInit)})}S.polyfill=!0,l.fetch||(l.fetch=S,l.Headers=f,l.Request=E,l.Response=b)}.call(this,r(35))},function(t,e,r){!function(t){function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function n(t){return encodeURIComponent(t).replace(/%20/g,"+")}function a(t){return decodeURIComponent(String(t).replace(/\+/g," "))}function e(){function s(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var e=typeof t;if("undefined"!=e)if("string"==e)""!==t&&this._fromString(t);else if(t instanceof s){var r=this;t.forEach(function(t,e){r.append(e,t)})}else{if(null===t||"object"!=e)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(t))for(var i=0;i<t.length;i++){var n=t[i];if("[object Array]"!==Object.prototype.toString.call(n)&&2===n.length)throw new TypeError("Expected [string, any] as entry at index "+i+" of URLSearchParams's input");this.append(n[0],n[1])}else for(var a in t)t.hasOwnProperty(a)&&this.append(a,t[a])}}var t=s.prototype;t.append=function(t,e){t in this._entries?this._entries[t].push(String(e)):this._entries[t]=[String(e)]},t.delete=function(t){delete this._entries[t]},t.get=function(t){return t in this._entries?this._entries[t][0]:null},t.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},t.has=function(t){return t in this._entries},t.set=function(t,e){this._entries[t]=[String(e)]},t.forEach=function(t,e){for(var r in this._entries)if(this._entries.hasOwnProperty(r))for(var i=this._entries[r],n=0;n<i.length;n++)t.call(e,i[n],r,this)},t.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),i(r)},t.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},t.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),i(r)},o&&(t[Symbol.iterator]=t.entries),t.toString=function(){var r=[];return this.forEach(function(t,e){r.push(n(e)+"="+n(t))}),r.join("&")},r.URLSearchParams=s}r=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,o=function(){try{return!!Symbol.iterator}catch(t){return!1}}(),function(){try{var t=r.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(t){return!1}}()||e(),"function"!=typeof(s=r.URLSearchParams.prototype).sort&&(s.sort=function(){var r=this,i=[];this.forEach(function(t,e){i.push([e,t]),r._entries||r.delete(e)}),i.sort(function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0}),r._entries&&(r._entries={});for(var t=0;t<i.length;t++)this.append(i[t][0],i[t][1])}),"function"!=typeof s._fromString&&Object.defineProperty(s,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(t){if(this._entries)this._entries={};else{var r=[];this.forEach(function(t,e){r.push(e)});for(var e=0;e<r.length;e++)this.delete(r[e])}for(var i,n=(t=t.replace(/^\?/,"")).split("&"),e=0;e<n.length;e++)i=n[e].split("="),this.append(a(i[0]),1<i.length?a(i[1]):"")}});var r,o,s,h=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this;function l(){function t(t,e){"string"!=typeof t&&(t=String(t)),e&&"string"!=typeof e&&(e=String(e));var r=document;if(e&&(void 0===h.location||e!==h.location.href)){e=e.toLowerCase(),(n=(r=document.implementation.createHTMLDocument("")).createElement("base")).href=e,r.head.appendChild(n);try{if(0!==n.href.indexOf(e))throw new Error(n.href)}catch(t){throw new Error("URL unable to set base "+e+" due to "+t)}}var i=r.createElement("a"),n=(i.href=t,n&&(r.body.appendChild(i),i.href=i.href),r.createElement("input"));if(n.type="url",n.value=t,":"===i.protocol||!/:/.test(i.href)||!n.checkValidity()&&!e)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:i});var a=new h.URLSearchParams(this.search),s=!0,o=!0,l=this,u=(["append","delete","set"].forEach(function(t){var e=a[t];a[t]=function(){e.apply(a,arguments),s&&(o=!1,l.search=a.toString(),o=!0)}}),Object.defineProperty(this,"searchParams",{value:a,enumerable:!0}),void 0);Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==u&&(u=this.search,o)&&(s=!1,this.searchParams._fromString(this.search),s=!0)}})}var e=h.URL,r=t.prototype;["hash","host","hostname","port","protocol"].forEach(function(t){var e;e=t,Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(t){this._anchorElement.search=t,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:!0},origin:{get:function(){var t={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=t&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(t){},enumerable:!0},username:{get:function(){return""},set:function(t){},enumerable:!0}}),t.createObjectURL=function(t){return e.createObjectURL.apply(e,arguments)},t.revokeObjectURL=function(t){return e.revokeObjectURL.apply(e,arguments)},h.URL=t}if(!function(){try{var t=new h.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(t){return!1}}()&&l(),void 0!==h.location&&!("origin"in h.location)){function u(){return h.location.protocol+"//"+h.location.hostname+(h.location.port?":"+h.location.port:"")}try{Object.defineProperty(h.location,"origin",{get:u,enumerable:!0})}catch(t){setInterval(function(){h.location.origin=u()},100)}}}.call(this,r(35))},function(t,e,r){},function(t,e,r){var i=r(153);t.exports=function(t){if(Array.isArray(t))return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){var i=r(3);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=i(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(_,t,e){var S=e(61).default;function r(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_.exports=function(){return s},_.exports.__esModule=!0,_.exports.default=_.exports;var s={},t=Object.prototype,l=t.hasOwnProperty,u=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function o(t,e,r,i){var n,a,s,o,e=e&&e.prototype instanceof d?e:d,e=Object.create(e.prototype),i=new b(i||[]);return u(e,"_invoke",{value:(n=t,a=r,s=i,o="suspendedStart",function(t,e){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===t)throw e;return{value:void 0,done:!0}}for(s.method=t,s.arg=e;;){var r=s.delegate;if(r){r=function t(e,r){var i=r.method,n=e.iterator[i];if(void 0===n)return r.delegate=null,"throw"===i&&e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),c;i=h(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,c;n=i.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,c):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,c)}(r,s);if(r){if(r===c)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===o)throw o="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);o="executing";r=h(n,a,s);if("normal"===r.type){if(o=s.done?"completed":"suspendedYield",r.arg===c)continue;return{value:r.arg,done:s.done}}"throw"===r.type&&(o="completed",s.method="throw",s.arg=r.arg)}})}),e}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}s.wrap=o;var c={};function d(){}function f(){}function p(){}var e={},g=(a(e,i,function(){return this}),Object.getPrototypeOf),g=g&&g(g(A([]))),v=(g&&g!==t&&l.call(g,i)&&(e=g),p.prototype=d.prototype=Object.create(e));function m(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function y(s,o){var e;u(this,"_invoke",{value:function(r,i){function t(){return new o(function(t,e){!function e(t,r,i,n){var a,t=h(s[t],s,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==S(r)&&l.call(r,"__await")?o.resolve(r.__await).then(function(t){e("next",t,i,n)},function(t){e("throw",t,i,n)}):o.resolve(r).then(function(t){a.value=t,i(a)},function(t){return e("throw",t,i,n)});n(t.arg)}(r,i,t,e)})}return e=e?e.then(t,t):t()}})}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function A(e){if(e||""===e){var r,t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(l.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}throw new TypeError(S(e)+" is not iterable")}return u(v,"constructor",{value:f.prototype=p,configurable:!0}),u(p,"constructor",{value:f,configurable:!0}),f.displayName=a(p,n,"GeneratorFunction"),s.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a(t,n,"GeneratorFunction")),t.prototype=Object.create(v),t},s.awrap=function(t){return{__await:t}},m(y.prototype),a(y.prototype,r,function(){return this}),s.AsyncIterator=y,s.async=function(t,e,r,i,n){void 0===n&&(n=Promise);var a=new y(o(t,e,r,i),n);return s.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},m(v),a(v,n,"Generator"),a(v,i,function(){return this}),a(v,"toString",function(){return"[object Generator]"}),s.keys=function(t){var e,r=Object(t),i=[];for(e in r)i.push(e);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},s.values=A,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&l.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var i=this;function t(t,e){return a.type="throw",a.arg=r,i.next=t,e&&(i.method="next",i.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var s=l.call(n,"catchLoc"),o=l.call(n,"finallyLoc");if(s&&o){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(s){if(this.prev<n.catchLoc)return t(n.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}var a=(n=n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc?null:n)?n.completion:{};return a.type=t,a.arg=e,n?(this.method="next",this.next=n.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),c}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,i,n=this.tryEntries[e];if(n.tryLoc===t)return"throw"===(r=n.completion).type&&(i=r.arg,T(n)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:A(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},s}_.exports=r,_.exports.__esModule=!0,_.exports.default=_.exports},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=a.call(r)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){u=!0,n=t}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw n}}return o}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,e,r){"use strict";var _=r(361);function b(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var S=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,L=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,n=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),k=["'"].concat(n),R=["%","/","?",";","#"].concat(k),w=["/","?","#"],I=/^[+a-z0-9A-Z_-]{0,63}$/,D=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},P={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},O=r(362);function a(t,e,r){var i;return t&&"object"==typeof t&&t instanceof b?t:((i=new b).parse(t,e,r),i)}b.prototype.parse=function(t,e,r){if("string"!=typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t.indexOf("?"),i=-1!==i&&i<t.indexOf("#")?"?":"#",n=t.split(i);n[0]=n[0].replace(/\\/g,"/");var a=(a=t=n.join(i)).trim();if(!r&&1===t.split("#").length){n=L.exec(a);if(n)return this.path=a,this.href=a,this.pathname=n[1],n[2]?(this.search=n[2],this.query=e?O.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var s,i=S.exec(a);if(i&&(s=(i=i[0]).toLowerCase(),this.protocol=s,a=a.substr(i.length)),!(r||i||a.match(/^\/\/[^@/]+@[^@/]+/))||!(T="//"===a.substr(0,2))||i&&P[i]||(a=a.substr(2),this.slashes=!0),!P[i]&&(T||i&&!x[i])){for(var o=-1,l=0;l<w.length;l++)-1!==(u=a.indexOf(w[l]))&&(-1===o||u<o)&&(o=u);-1!==(t=-1===o?a.lastIndexOf("@"):a.lastIndexOf("@",o))&&(n=a.slice(0,t),a=a.slice(t+1),this.auth=decodeURIComponent(n));for(var u,o=-1,l=0;l<R.length;l++)-1!==(u=a.indexOf(R[l]))&&(-1===o||u<o)&&(o=u);-1===o&&(o=a.length),this.host=a.slice(0,o),a=a.slice(o),this.parseHost(),this.hostname=this.hostname||"";r="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!r)for(var h=this.hostname.split(/\./),l=0,c=h.length;l<c;l++){var d=h[l];if(d&&!d.match(I)){for(var f="",p=0,g=d.length;p<g;p++)127<d.charCodeAt(p)?f+="x":f+=d[p];if(!f.match(I)){var v=h.slice(0,l),m=h.slice(l+1),y=d.match(D);y&&(v.push(y[1]),m.unshift(y[2])),m.length&&(a="/"+m.join(".")+a),this.hostname=v.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),r||(this.hostname=_.toASCII(this.hostname));var E=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+E,this.href+=this.host,r&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0])&&(a="/"+a)}if(!C[s])for(l=0,c=k.length;l<c;l++){var b,A=k[l];-1!==a.indexOf(A)&&((b=encodeURIComponent(A))===A&&(b=escape(A)),a=a.split(A).join(b))}i=a.indexOf("#"),-1!==i&&(this.hash=a.substr(i),a=a.slice(0,i)),t=a.indexOf("?");return-1!==t?(this.search=a.substr(t),this.query=a.substr(t+1),e&&(this.query=O.parse(this.query)),a=a.slice(0,t)):e&&(this.search="",this.query={}),a&&(this.pathname=a),x[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(E=this.pathname||"",n=this.search||"",this.path=E+n),this.href=this.format(),this},b.prototype.format=function(){var t=this.auth||"",e=(t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@"),this.protocol||""),r=this.pathname||"",i=this.hash||"",n=!1,a="",t=(this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port)&&(n+=":"+this.port),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(a=O.stringify(this.query)),this.search||a&&"?"+a||"");return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n=n||"",i&&"#"!==i.charAt(0)&&(i="#"+i),t&&"?"!==t.charAt(0)&&(t="?"+t),e+n+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(t=t.replace("#","%23"))+i},b.prototype.resolve=function(t){return this.resolveObject(a(t,!1,!0)).format()},b.prototype.resolveObject=function(t){"string"==typeof t&&((d=new b).parse(t,!1,!0),t=d);for(var e=new b,r=Object.keys(this),i=0;i<r.length;i++){var n=r[i];e[n]=this[n]}if(e.hash=t.hash,""!==t.href)if(t.slashes&&!t.protocol){for(var a=Object.keys(t),s=0;s<a.length;s++){var o=a[s];"protocol"!==o&&(e[o]=t[o])}x[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname)}else if(t.protocol&&t.protocol!==e.protocol)if(x[t.protocol]){if(e.protocol=t.protocol,t.host||P[t.protocol])e.pathname=t.pathname;else{for(var l=(t.pathname||"").split("/");l.length&&!(t.host=l.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==l[0]&&l.unshift(""),l.length<2&&l.unshift(""),e.pathname=l.join("/")}e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,(e.pathname||e.search)&&(d=e.pathname||"",f=e.search||"",e.path=d+f),e.slashes=e.slashes||t.slashes}else for(var u=Object.keys(t),h=0;h<u.length;h++){var c=u[h];e[c]=t[c]}else{var d=e.pathname&&"/"===e.pathname.charAt(0),f=t.host||t.pathname&&"/"===t.pathname.charAt(0),d=f||d||e.host&&t.pathname,p=d,g=e.pathname&&e.pathname.split("/")||[],l=t.pathname&&t.pathname.split("/")||[],v=e.protocol&&!x[e.protocol];if(v&&(e.hostname="",e.port=null,e.host&&(""===g[0]?g[0]=e.host:g.unshift(e.host)),e.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===l[0]?l[0]=t.host:l.unshift(t.host)),t.host=null),d=d&&(""===l[0]||""===g[0])),f)e.host=(t.host||""===t.host?t:e).host,e.hostname=(t.hostname||""===t.hostname?t:e).hostname,e.search=t.search,e.query=t.query,g=l;else if(l.length)(g=g||[]).pop(),g=g.concat(l),e.search=t.search,e.query=t.query;else if(null!=t.search)return v&&(e.host=g.shift(),e.hostname=e.host,T=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=T.shift(),e.hostname=T.shift(),e.host=e.hostname),e.search=t.search,e.query=t.query,null===e.pathname&&null===e.search||(e.path=(e.pathname||"")+(e.search||"")),e.href=e.format(),e;if(g.length){for(var m=g.slice(-1)[0],f=(e.host||t.host||1<g.length)&&("."===m||".."===m)||""===m,y=0,E=g.length;0<=E;E--)"."===(m=g[E])?g.splice(E,1):".."===m?(g.splice(E,1),y++):y&&(g.splice(E,1),y--);if(!d&&!p)for(;y--;)g.unshift("..");!d||""===g[0]||g[0]&&"/"===g[0].charAt(0)||g.unshift(""),f&&"/"!==g.join("/").substr(-1)&&g.push("");var T,p=""===g[0]||g[0]&&"/"===g[0].charAt(0);v&&(e.hostname=!p&&g.length?g.shift():"",e.host=e.hostname,T=!!(e.host&&0<e.host.indexOf("@"))&&e.host.split("@"))&&(e.auth=T.shift(),e.hostname=T.shift(),e.host=e.hostname),(d=d||e.host&&g.length)&&!p&&g.unshift(""),0<g.length?e.pathname=g.join("/"):(e.pathname=null,e.path=null),null===e.pathname&&null===e.search||(e.path=(e.pathname||"")+(e.search||"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes}else e.pathname=null,e.search?e.path="/"+e.search:e.path=null}return e.href=e.format(),e},b.prototype.parseHost=function(){var t=this.host,e=i.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},e.parse=a,e.resolve=function(t,e){return a(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?a(t,!1,!0).resolveObject(e):e},e.format=function(t){return(t="string"==typeof t?a(t):t)instanceof b?t.format():b.prototype.format.call(t)},e.Url=b},function(t,g,L){!function(t,e){var r,v,m,y,n,a,i,s,o,l,u,E,T;/*! https://mths.be/punycode v1.4.1 by @mathias */function b(t){throw new RangeError(l[t])}function h(t,e){for(var r=t.length,i=[];r--;)i[r]=e(t[r]);return i}function c(t,e){var r=t.split("@"),i="",r=(1<r.length&&(i=r[0]+"@",t=r[1]),(t=t.replace(o,".")).split("."));return i+h(r,e).join(".")}function A(t){for(var e,r,i=[],n=0,a=t.length;n<a;)55296<=(e=t.charCodeAt(n++))&&e<=56319&&n<a?56320==(64512&(r=t.charCodeAt(n++)))?i.push(((1023&e)<<10)+(1023&r)+65536):(i.push(e),n--):i.push(e);return i}function p(t){return h(t,function(t){var e="";return 65535<t&&(e+=T((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=T(t)}).join("")}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function S(t,e,r){var i=0;for(t=r?E(t/a):t>>1,t+=E(t/e);u*y>>1<t;i+=m)t=E(t/u);return E(i+(u+1)*t/(t+n))}function d(t){var e,r,i,n,a,s,o,l=[],u=t.length,h=0,c=128,d=72,f=t.lastIndexOf("-");for(f<0&&(f=0),r=0;r<f;++r)128<=t.charCodeAt(r)&&b("not-basic"),l.push(t.charCodeAt(r));for(i=0<f?f+1:0;i<u;){for(n=h,a=1,s=m;u<=i&&b("invalid-input"),o=t.charCodeAt(i++),(m<=(o=o-48<10?o-22:o-65<26?o-65:o-97<26?o-97:m)||o>E((v-h)/a))&&b("overflow"),h+=o*a,!(o<(o=s<=d?1:d+y<=s?y:s-d));s+=m)a>E(v/(o=m-o))&&b("overflow"),a*=o;d=S(h-n,e=l.length+1,0==n),E(h/e)>v-c&&b("overflow"),c+=E(h/e),h%=e,l.splice(h++,0,c)}return p(l)}function f(t){for(var e,r,i,n,a,s,o,l,u,h,c=[],d=(t=A(t)).length,f=128,p=72,g=e=0;g<d;++g)(o=t[g])<128&&c.push(T(o));for(r=i=c.length,i&&c.push("-");r<d;){for(n=v,g=0;g<d;++g)f<=(o=t[g])&&o<n&&(n=o);for(n-f>E((v-e)/(l=r+1))&&b("overflow"),e+=(n-f)*l,f=n,g=0;g<d;++g)if((o=t[g])<f&&++e>v&&b("overflow"),o==f){for(a=e,s=m;!(a<(u=s<=p?1:p+y<=s?y:s-p));s+=m)c.push(T(_(u+(h=a-u)%(u=m-u),0))),a=E(h/u);c.push(T(_(a,0))),p=S(e,l,r==i),e=0,++r}++e,++f}return c.join("")}g&&g.nodeType,t&&t.nodeType,(e="object"==typeof e&&e).global!==e&&e.window!==e&&e.self,v=2147483647,y=26,n=38,a=700,i=/^xn--/,s=/[^\x20-\x7E]/,o=/[\x2E\u3002\uFF0E\uFF61]/g,l={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},u=(m=36)-1,E=Math.floor,T=String.fromCharCode,r={version:"1.4.1",ucs2:{decode:A,encode:p},decode:d,encode:f,toASCII:function(t){return c(t,function(t){return s.test(t)?"xn--"+f(t):t})},toUnicode:function(t){return c(t,function(t){return i.test(t)?d(t.slice(4).toLowerCase()):t})}},void 0!==(e=function(){return r}.call(g,L,g,t))&&(t.exports=e)}.call(this,L(155)(t),L(35))},function(t,e,r){"use strict";var i=r(363),n=r(374),r=r(119);t.exports={formats:r,parse:n,stringify:i}},function(t,e,r){"use strict";function I(t,e){i.apply(t,x(e)?e:[e])}function D(t,e,r,i,n,a,s,o,l,u,h,c,d,f,p,g){for(var v=t,m=g,y=0,E=!1;void 0!==(m=m.get(M))&&!E;){var T=m.get(t);if(y+=1,void 0!==T){if(T===y)throw new RangeError("Cyclic object value");E=!0}void 0===m.get(M)&&(y=0)}if("function"==typeof o?v=o(e,v):v instanceof Date?v=h(v):"comma"===r&&x(v)&&(v=P.maybeMap(v,function(t){return t instanceof Date?h(t):t})),null===v){if(n)return s&&!f?s(e,O.encoder,p,"key",c):e;v=""}if("string"==typeof(A=v)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||P.isBuffer(v))return s?[d(f?e:s(e,O.encoder,p,"key",c))+"="+d(s(v,O.encoder,p,"value",c))]:[d(e)+"="+d(String(v))];var b=[];if(void 0!==v)for(var A,_,_="comma"===r&&x(v)?[{value:0<(v=f&&s?P.maybeMap(v,s):v).length?v.join(",")||null:void 0}]:x(o)?o:(A=Object.keys(v),l?A.sort(l):A),S=i&&x(v)&&1===v.length?e+"[]":e,L=0;L<_.length;++L){var k,R=_[L],w="object"==typeof R&&void 0!==R.value?R.value:v[R];a&&null===w||(R=x(v)?"function"==typeof r?r(S,R):S:S+(u?"."+R:"["+R+"]"),g.set(t,y),(k=C()).set(M,g),I(b,D(w,R,r,i,n,a,"comma"===r&&f&&x(v)?null:s,o,l,u,h,c,d,f,p,k)))}return b}var C=r(364),P=r(156),c=r(119),d=Object.prototype.hasOwnProperty,f={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},x=Array.isArray,i=Array.prototype.push,n=Date.prototype.toISOString,r=c.default,O={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:P.encode,encodeValuesOnly:!1,format:r,formatter:c.formatters[r],indices:!1,serializeDate:function(t){return n.call(t)},skipNulls:!1,strictNullHandling:!1},M={};t.exports=function(t,e){var r=t,i=function(t){if(!t)return O;if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||O.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=c.default;if(void 0!==t.format){if(!d.call(c.formatters,t.format))throw new TypeError("Unknown format option provided.");r=t.format}var i=c.formatters[r],n=O.filter;return"function"!=typeof t.filter&&!x(t.filter)||(n=t.filter),{addQueryPrefix:("boolean"==typeof t.addQueryPrefix?t:O).addQueryPrefix,allowDots:void 0===t.allowDots?O.allowDots:!!t.allowDots,charset:e,charsetSentinel:("boolean"==typeof t.charsetSentinel?t:O).charsetSentinel,delimiter:(void 0===t.delimiter?O:t).delimiter,encode:("boolean"==typeof t.encode?t:O).encode,encoder:("function"==typeof t.encoder?t:O).encoder,encodeValuesOnly:("boolean"==typeof t.encodeValuesOnly?t:O).encodeValuesOnly,filter:n,format:r,formatter:i,serializeDate:("function"==typeof t.serializeDate?t:O).serializeDate,skipNulls:("boolean"==typeof t.skipNulls?t:O).skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:("boolean"==typeof t.strictNullHandling?t:O).strictNullHandling}}(e),n=("function"==typeof i.filter?r=(0,i.filter)("",r):x(i.filter)&&(o=i.filter),[]);if("object"!=typeof r||null===r)return"";var t=e&&e.arrayFormat in f?e.arrayFormat:!(e&&"indices"in e)||e.indices?"indices":"repeat",a=f[t];if(e&&"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s="comma"===a&&e&&e.commaRoundTrip,o=o||Object.keys(r);i.sort&&o.sort(i.sort);for(var l=C(),u=0;u<o.length;++u){var h=o[u];i.skipNulls&&null===r[h]||I(n,D(r[h],h,a,s,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,l))}t=n.join(i.delimiter),e=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&("iso-8859-1"===i.charset?e+="utf8=%26%2310003%3B&":e+="utf8=%E2%9C%93&"),0<t.length?e+t:""}},function(t,e,r){"use strict";function o(t,e){for(var r,i=t;null!==(r=i.next);i=r)if(r.key===e)return i.next=r.next,r.next=t.next,t.next=r}var i=r(117),n=r(370),l=r(372),u=i("%TypeError%"),h=i("%WeakMap%",!0),c=i("%Map%",!0),d=n("WeakMap.prototype.get",!0),f=n("WeakMap.prototype.set",!0),p=n("WeakMap.prototype.has",!0),g=n("Map.prototype.get",!0),v=n("Map.prototype.set",!0),m=n("Map.prototype.has",!0);t.exports=function(){var n,a,s,e={assert:function(t){if(!e.has(t))throw new u("Side channel does not contain "+l(t))},get:function(t){if(h&&t&&("object"==typeof t||"function"==typeof t)){if(n)return d(n,t)}else if(c){if(a)return g(a,t)}else{var e;if(s)return(e=o(e=s,t))&&e.value}},has:function(t){if(h&&t&&("object"==typeof t||"function"==typeof t)){if(n)return p(n,t)}else if(c){if(a)return m(a,t)}else if(s)return!!o(s,t);return!1},set:function(t,e){var r,i;h&&t&&("object"==typeof t||"function"==typeof t)?(n=n||new h,f(n,t,e)):c?(a=a||new c,v(a,t,e)):(e=e,(i=o(r=s=s||{key:{},next:null},t=t))?i.value=e:r.next={key:t,next:r.next,value:e})}};return e}},function(t,e,r){"use strict";var i="undefined"!=typeof Symbol&&Symbol,n=r(366);t.exports=function(){return"function"==typeof i&&"function"==typeof Symbol&&"symbol"==typeof i("foo")&&"symbol"==typeof Symbol("bar")&&n()}},function(t,e,r){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"!=typeof Symbol.iterator){var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}}return!0}},function(t,e,r){"use strict";var i={foo:{}},n=Object;t.exports=function(){return{__proto__:i}.foo===i.foo&&!({__proto__:null}instanceof n)}},function(t,e,r){"use strict";var l=Array.prototype.slice,u=Object.prototype.toString;t.exports=function(e){var r=this;if("function"!=typeof r||"[object Function]"!==u.call(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var i,t,n=l.call(arguments,1),a=Math.max(0,r.length-n.length),s=[],o=0;o<a;o++)s.push("$"+o);return i=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(function(){var t;return this instanceof i?(t=r.apply(this,n.concat(l.call(arguments))),Object(t)===t?t:this):r.apply(e,n.concat(l.call(arguments)))}),r.prototype&&((t=function(){}).prototype=r.prototype,i.prototype=new t,t.prototype=null),i}},function(t,e,r){"use strict";r=r(118);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,r){"use strict";var i=r(117),n=r(371),a=n(i("String.prototype.indexOf"));t.exports=function(t,e){e=i(t,!!e);return"function"==typeof e&&-1<a(t,".prototype.")?n(e):e}},function(t,e,r){"use strict";var i=r(118),r=r(117),n=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),s=r("%Reflect.apply%",!0)||i.call(a,n),o=r("%Object.getOwnPropertyDescriptor%",!0),l=r("%Object.defineProperty%",!0),u=r("%Math.max%");if(l)try{l({},"a",{value:1})}catch(t){l=null}t.exports=function(t){var e=s(i,a,arguments);return o&&l&&o(e,"length").configurable&&l(e,"length",{value:1+u(0,t.length-(arguments.length-1))}),e};function h(){return s(i,n,arguments)}l?l(t.exports,"apply",{value:h}):t.exports.apply=h},function(r,i,a){var t="function"==typeof Map&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,E=t&&e&&"function"==typeof e.get?e.get:null,T=t&&Map.prototype.forEach,e="function"==typeof Set&&Set.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,b=e&&t&&"function"==typeof t.get?t.get:null,A=e&&Set.prototype.forEach,_="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,S="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,L="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Q=Boolean.prototype.valueOf,s=Object.prototype.toString,X=Function.prototype.toString,J=String.prototype.match,k=String.prototype.slice,R=String.prototype.replace,o=String.prototype.toUpperCase,w=String.prototype.toLowerCase,h=RegExp.prototype.test,I=Array.prototype.concat,D=Array.prototype.join,Z=Array.prototype.slice,n=Math.floor,C="function"==typeof BigInt?BigInt.prototype.valueOf:null,c=Object.getOwnPropertySymbols,P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,x="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,M=Object.prototype.propertyIsEnumerable,F=("function"==typeof Reflect?Reflect:Object).getPrototypeOf||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function N(t,e){if(t===1/0||t===-1/0||t!=t||t&&-1e3<t&&t<1e3||h.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var i=t<0?-n(-t):n(t);if(i!==t)return t=String(i),i=k.call(e,t.length+1),R.call(t,r,"$&_")+"."+R.call(R.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}return R.call(e,r,"$&_")}var B=a(373),t=B.custom,U=K(t)?t:null;function j(t,e,r){r="double"===(r.quoteStyle||e)?'"':"'";return r+t+r}function G(t){return!("[object Array]"!==V(t)||O&&"object"==typeof t&&O in t)}function $(t){return!("[object RegExp]"!==V(t)||O&&"object"==typeof t&&O in t)}function K(t){if(x)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return 1;if(t&&"object"==typeof t&&P)try{return P.call(t),1}catch(t){}}r.exports=function i(r,t,n,a){var s=t||{};if(H(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(H(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');t=!H(s,"customInspect")||s.customInspect;if("boolean"!=typeof t&&"symbol"!==t)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(H(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&0<s.indent))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(H(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var e=s.numericSeparator;if(void 0===r)return"undefined";if(null===r)return"null";if("boolean"==typeof r)return r?"true":"false";if("string"==typeof r)return function t(e,r){if(e.length>r.maxStringLength)return i=e.length-r.maxStringLength,i="... "+i+" more character"+(1<i?"s":""),t(k.call(e,0,r.maxStringLength),r)+i;var i=R.call(R.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,et);return j(i,"single",r)}(r,s);if("number"==typeof r)return 0===r?0<1/0/r?"0":"-0":(p=String(r),e?N(r,p):p);if("bigint"==typeof r)return p=String(r)+"n",e?N(r,p):p;e=void 0===s.depth?5:s.depth;if(e<=(n=void 0===n?0:n)&&0<e&&"object"==typeof r)return G(r)?"[Array]":"[Object]";var o,l,u,h,c,d,f,p=function(t,e){var r;if("\t"===t.indent)r="\t";else{if(!("number"==typeof t.indent&&0<t.indent))return null;r=D.call(Array(t.indent+1)," ")}return{base:r,prev:D.call(Array(e+1),r)}}(s,n);if(void 0===a)a=[];else if(0<=tt(a,r))return"[Circular]";function g(t,e,r){return e&&(a=Z.call(a)).push(e),r?(e={depth:s.depth},H(s,"quoteStyle")&&(e.quoteStyle=s.quoteStyle),i(t,e,n+1,a)):i(t,s,n+1,a)}if("function"==typeof r&&!$(r))return"[Function"+((l=function(t){if(t.name)return t.name;t=J.call(X.call(t),/^function\s*([\w$]+)/);if(t)return t[1];return null}(r))?": "+l:" (anonymous)")+"]"+(0<(l=z(r,g)).length?" { "+D.call(l,", ")+" }":"");if(K(r))return l=x?R.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):P.call(r),"object"!=typeof r||x?l:W(l);if(function(t){if(!t||"object"!=typeof t)return;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return 1;return"string"==typeof t.nodeName&&"function"==typeof t.getAttribute}(r)){for(var v="<"+w.call(String(r.nodeName)),m=r.attributes||[],y=0;y<m.length;y++)v+=" "+m[y].name+"="+j((o=m[y].value,R.call(String(o),/"/g,"&quot;")),"double",s);return v+=">",r.childNodes&&r.childNodes.length&&(v+="..."),v+="</"+w.call(String(r.nodeName))+">"}if(G(r))return 0===r.length?"[]":(l=z(r,g),p&&!function(t){for(var e=0;e<t.length;e++)if(0<=tt(t[e],"\n"))return;return 1}(l)?"["+q(l,p)+"]":"[ "+D.call(l,", ")+" ]");if(!("[object Error]"!==V(l=r)||O&&"object"==typeof l&&O in l))return c=z(r,g),"cause"in Error.prototype||!("cause"in r)||M.call(r,"cause")?0===c.length?"["+String(r)+"]":"{ ["+String(r)+"] "+D.call(c,", ")+" }":"{ ["+String(r)+"] "+D.call(I.call("[cause]: "+g(r.cause),c),", ")+" }";if("object"==typeof r&&t){if(U&&"function"==typeof r[U]&&B)return B(r,{depth:e-n});if("symbol"!==t&&"function"==typeof r.inspect)return r.inspect()}return function(t){if(E&&t&&"object"==typeof t)try{E.call(t);try{b.call(t)}catch(t){return 1}return t instanceof Map}catch(t){}return}(r)?(u=[],T&&T.call(r,function(t,e){u.push(g(e,r,!0)+" => "+g(t,r))}),rt("Map",E.call(r),u,p)):function(t){if(b&&t&&"object"==typeof t)try{b.call(t);try{E.call(t)}catch(t){return 1}return t instanceof Set}catch(t){}return}(r)?(h=[],A&&A.call(r,function(t){h.push(g(t,r))}),rt("Set",b.call(r),h,p)):function(t){if(_&&t&&"object"==typeof t)try{_.call(t,_);try{S.call(t,S)}catch(t){return 1}return t instanceof WeakMap}catch(t){}return}(r)?Y("WeakMap"):function(t){if(S&&t&&"object"==typeof t)try{S.call(t,S);try{_.call(t,_)}catch(t){return 1}return t instanceof WeakSet}catch(t){}return}(r)?Y("WeakSet"):function(t){if(L&&t&&"object"==typeof t)try{return L.call(t),1}catch(t){}return}(r)?Y("WeakRef"):"[object Number]"!==V(c=r)||O&&"object"==typeof c&&O in c?function(t){if(t&&"object"==typeof t&&C)try{return C.call(t),1}catch(t){}return}(r)?W(g(C.call(r))):"[object Boolean]"!==V(e=r)||O&&"object"==typeof e&&O in e?"[object String]"!==V(t=r)||O&&"object"==typeof t&&O in t?("[object Date]"!==V(e=r)||O&&"object"==typeof e&&O in e)&&!$(r)?(t=z(r,g),e=F?F(r)===Object.prototype:r instanceof Object||r.constructor===Object,d=r instanceof Object?"":"null prototype",f=!e&&O&&Object(r)===r&&O in r?k.call(V(r),8,-1):d?"Object":"",e=(!e&&"function"==typeof r.constructor&&r.constructor.name?r.constructor.name+" ":"")+(f||d?"["+D.call(I.call([],f||[],d||[]),": ")+"] ":""),0===t.length?e+"{}":p?e+"{"+q(t,p)+"}":e+"{ "+D.call(t,", ")+" }"):String(r):W(g(String(r))):W(Q.call(r)):W(g(Number(r)))};var l=Object.prototype.hasOwnProperty||function(t){return t in this};function H(t,e){return l.call(t,e)}function V(t){return s.call(t)}function tt(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}function et(t){var t=t.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+o.call(t.toString(16))}function W(t){return"Object("+t+")"}function Y(t){return t+" { ? }"}function rt(t,e,r,i){return t+" ("+e+") {"+(i?q(r,i):D.call(r,", "))+"}"}function q(t,e){var r;return 0===t.length?"":(r="\n"+e.prev+e.base)+D.call(t,","+r)+"\n"+e.prev}function z(t,e){var r=G(t),i=[];if(r){i.length=t.length;for(var n=0;n<t.length;n++)i[n]=H(t,n)?e(t[n],t):""}var a,s="function"==typeof c?c(t):[];if(x)for(var o={},l=0;l<s.length;l++)o["$"+s[l]]=s[l];for(a in t)!H(t,a)||r&&String(Number(a))===a&&a<t.length||x&&o["$"+a]instanceof Symbol||(h.call(/[^\w$]/,a)?i.push(e(a,t)+": "+e(t[a],t)):i.push(a+": "+e(t[a],t)));if("function"==typeof c)for(var u=0;u<s.length;u++)M.call(t,s[u])&&i.push("["+e(s[u])+"]: "+e(t[s[u]],t));return i}},function(t,e){},function(t,e,r){"use strict";function l(t,e){var r,i,n,a,s={__proto__:null},t=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,o=e.parameterLimit===1/0?void 0:e.parameterLimit,l=t.split(e.delimiter,o),u=-1,h=e.charset;if(e.charsetSentinel)for(r=0;r<l.length;++r)0===l[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===l[r]?h="utf-8":"utf8=%26%2310003%3B"===l[r]&&(h="iso-8859-1"),u=r,r=l.length);for(r=0;r<l.length;++r)r!==u&&((a=-1===(a=-1===(a=(i=l[r]).indexOf("]="))?i.indexOf("="):a+1)?(n=e.decoder(i,f.decoder,h,"key"),e.strictNullHandling?null:""):(n=e.decoder(i.slice(0,a),f.decoder,h,"key"),c.maybeMap(y(i.slice(a+1),e),function(t){return e.decoder(t,f.decoder,h,"value")})))&&e.interpretNumericEntities&&"iso-8859-1"===h&&(a=a.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})),-1<i.indexOf("[]=")&&(a=d(a)?[a]:a),m.call(s,n)?s[n]=c.combine(s[n],a):s[n]=a);return s}function u(t,e,r,i){if(t){var n=r.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/g,s=0<r.depth&&/(\[[^[\]]*])/.exec(n),t=s?n.slice(0,s.index):n,o=[];if(t){if(!r.plainObjects&&m.call(Object.prototype,t)&&!r.allowPrototypes)return;o.push(t)}for(var l=0;0<r.depth&&null!==(s=a.exec(n))&&l<r.depth;){if(l+=1,!r.plainObjects&&m.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;o.push(s[1])}s&&o.push("["+n.slice(s.index)+"]");for(var u=o,t=e,h=r,c=i?t:y(t,h),d=u.length-1;0<=d;--d){var f,p,g,v=u[d];"[]"===v&&h.parseArrays?f=[].concat(c):(f=h.plainObjects?Object.create(null):{},p="["===v.charAt(0)&&"]"===v.charAt(v.length-1)?v.slice(1,-1):v,g=parseInt(p,10),h.parseArrays||""!==p?!isNaN(g)&&v!==p&&String(g)===p&&0<=g&&h.parseArrays&&g<=h.arrayLimit?(f=[])[g]=c:"__proto__"!==p&&(f[p]=c):f={0:c}),c=f}return c}}var c=r(156),m=Object.prototype.hasOwnProperty,d=Array.isArray,f={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:c.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},y=function(t,e){return t&&"string"==typeof t&&e.comma&&-1<t.indexOf(",")?t.split(","):t};t.exports=function(t,e){var r=function(t){if(!t)return f;if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=(void 0===t.charset?f:t).charset;return{allowDots:void 0===t.allowDots?f.allowDots:!!t.allowDots,allowPrototypes:("boolean"==typeof t.allowPrototypes?t:f).allowPrototypes,allowSparse:("boolean"==typeof t.allowSparse?t:f).allowSparse,arrayLimit:("number"==typeof t.arrayLimit?t:f).arrayLimit,charset:e,charsetSentinel:("boolean"==typeof t.charsetSentinel?t:f).charsetSentinel,comma:("boolean"==typeof t.comma?t:f).comma,decoder:("function"==typeof t.decoder?t:f).decoder,delimiter:("string"==typeof t.delimiter||c.isRegExp(t.delimiter)?t:f).delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:f.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:("boolean"==typeof t.interpretNumericEntities?t:f).interpretNumericEntities,parameterLimit:("number"==typeof t.parameterLimit?t:f).parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:("boolean"==typeof t.plainObjects?t:f).plainObjects,strictNullHandling:("boolean"==typeof t.strictNullHandling?t:f).strictNullHandling}}(e);if(""===t||null==t)return r.plainObjects?Object.create(null):{};for(var i="string"==typeof t?l(t,r):t,n=r.plainObjects?Object.create(null):{},a=Object.keys(i),s=0;s<a.length;++s)var o=a[s],o=u(o,i[o],r,"string"==typeof t),n=c.merge(n,o,r);return!0===r.allowSparse?n:c.compact(n)}},function(t,e,r){(t.exports=r(376)(!1)).push([t.i,'.level_selector[data-level-selector]{float:right;position:relative;height:100%}.level_selector[data-level-selector] button{background-color:transparent;color:#fff;font-family:Roboto,"Open Sans",Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:12px;height:100%}.level_selector[data-level-selector] button:hover{color:#c9c9c9}.level_selector[data-level-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.level_selector[data-level-selector]>ul{overflow-x:hidden;overflow-y:auto;list-style-type:none;position:absolute;bottom:100%;display:none;background-color:rgba(28,28,28,.9);white-space:nowrap}.level_selector[data-level-selector] li{font-size:12px;color:#eee}.level_selector[data-level-selector] li[data-title]{background-color:#333;padding:8px 25px}.level_selector[data-level-selector] li a{color:#eee;padding:5px 18px;display:block;text-decoration:none}.level_selector[data-level-selector] li a:hover{background-color:rgba(255,255,255,.1);color:#fff}.level_selector[data-level-selector] li a:hover a{color:#fff;text-decoration:none}.level_selector[data-level-selector] li.current a{color:#2ecc71}@-webkit-keyframes pulse{0%{color:#fff}50%{color:#ff0101}100%{color:#b80000}}',""])},function(t,e){t.exports=function(r){var s=[];return s.toString=function(){return this.map(function(t){var e=function(t,e){var r=t[1]||"",i=t[3];if(!i)return r;if(e&&"function"==typeof btoa)return t=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(i),e=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"}),[r].concat(e).concat([t]).join("\n");return[r].join("\n")}(t,r);return t[2]?"@media "+t[2]+"{"+e+"}":e}).join("")},s.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var n=this[i][0];"number"==typeof n&&(r[n]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(e&&!a[2]?a[2]=e:e&&(a[2]="("+a[2]+") and ("+e+")"),s.push(a))}},s}},function(t,e,i){var r,n,a,l={},u=(r=function(){return window&&document&&document.all&&!window.atob},function(){return n=void 0===n?r.apply(this,arguments):n}),s=(a={},function(t,e){if("function"==typeof t)return t();if(void 0===a[t]){e=function(t,e){return(e||document).querySelector(t)}.call(this,t,e);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}a[t]=e}return a[t]}),o=null,h=0,c=[],d=i(378);function f(t,e){for(var r=0;r<t.length;r++){var i=t[r],n=l[i.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](i.parts[a]);for(;a<i.parts.length;a++)n.parts.push(E(i.parts[a],e))}else{for(var s=[],a=0;a<i.parts.length;a++)s.push(E(i.parts[a],e));l[i.id]={id:i.id,refs:1,parts:s}}}}function p(t,e){for(var r=[],i={},n=0;n<t.length;n++){var a=t[n],s=e.base?a[0]+e.base:a[0],a={css:a[1],media:a[2],sourceMap:a[3]};i[s]?i[s].parts.push(a):r.push(i[s]={id:s,parts:[a]})}return r}function g(t,e){var r=s(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=c[c.length-1];if("top"===t.insertAt)i?i.nextSibling?r.insertBefore(e,i.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),c.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");i=s(t.insertAt.before,r);r.insertBefore(e,i)}}function v(t){null!==t.parentNode&&(t.parentNode.removeChild(t),0<=(t=c.indexOf(t)))&&c.splice(t,1)}function m(t){var e,r=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce&&(e=i.nc)&&(t.attrs.nonce=e),y(r,t.attrs),g(t,r),r}function y(e,r){Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])})}function E(e,t){var r,i,n,a,s;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}return n=t.singleton?(a=h++,r=o=o||m(t),i=A.bind(null,r,a,!1),A.bind(null,r,a,!0)):e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=t,s=document.createElement("link"),void 0===a.attrs.type&&(a.attrs.type="text/css"),a.attrs.rel="stylesheet",y(s,a.attrs),g(a,s),r=s,i=function(t,e,r){var i=r.css,r=r.sourceMap,n=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||n)&&(i=d(i));r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");e=new Blob([i],{type:"text/css"}),n=t.href;t.href=URL.createObjectURL(e),n&&URL.revokeObjectURL(n)}.bind(null,r,t),function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=m(t),i=function(t,e){var r=e.css,e=e.media;e&&t.setAttribute("media",e);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),function(){v(r)}),i(e),function(t){t?t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap||i(e=t):n()}}t.exports=function(t,s){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(s=s||{}).attrs="object"==typeof s.attrs?s.attrs:{},s.singleton||"boolean"==typeof s.singleton||(s.singleton=u()),s.insertInto||(s.insertInto="head"),s.insertAt||(s.insertAt="bottom");var o=p(t,s);return f(o,s),function(t){for(var e=[],r=0;r<o.length;r++){var i=o[r];(n=l[i.id]).refs--,e.push(n)}t&&f(p(t,s),s);for(var n,r=0;r<e.length;r++)if(0===(n=e[r]).refs){for(var a=0;a<n.parts.length;a++)n.parts[a]();delete l[n.id]}}};T=[];var T,b=function(t,e){return T[t]=e,T.filter(Boolean).join("\n")};function A(t,e,r,i){var r=r?"":i.css;t.styleSheet?t.styleSheet.cssText=b(e,r):(i=document.createTextNode(r),(r=t.childNodes)[e]&&t.removeChild(r[e]),r.length?t.insertBefore(i,r[e]):t.appendChild(i))}},function(t,e){t.exports=function(t){var r,i,e="undefined"!=typeof window&&window.location;if(e)return t&&"string"==typeof t?(r=e.protocol+"//"+e.host,i=r+e.pathname.replace(/\/[^\/]*$/,"/"),t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){e=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e)?t:(t=0===e.indexOf("//")?e:0===e.indexOf("/")?r+e:i+e.replace(/^\.\//,""),"url("+JSON.stringify(t)+")")})):t;throw new Error("fixUrls requires window.location")}},function(t,e){function r(t,e,r){t.addEventListener("wheel",e,r)}t.exports=r,t.exports.addWheelListener=r,t.exports.removeWheelListener=function(t,e,r){t.removeEventListener("wheel",e,r)}},function(t,e,r){var r=r(381),p={ease:r(.25,.1,.25,1),easeIn:r(.42,0,1,1),easeOut:r(0,0,.58,1),easeInOut:r(.42,0,.58,1),linear:r(0,0,1,1)};function g(){}function i(){var e=new Set,r=new Set,i=0;return{next:t,cancel:t,clearAll:function(){e.clear(),r.clear(),cancelAnimationFrame(i),i=0}};function t(t){r.add(t),i=i||requestAnimationFrame(n)}function n(){i=0;var t=r;r=e,(e=t).forEach(function(t){t()}),e.clear()}}t.exports=function(r,e,t){var i=Object.create(null),n=Object.create(null),a="function"==typeof(t=t||{}).easing?t.easing:p[t.easing];a||(t.easing&&console.warn("Unknown easing function in amator: "+t.easing),a=p.ease);var s,o="function"==typeof t.step?t.step:g,l="function"==typeof t.done?t.done:g,u=function(t){if(!t)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(t){return setTimeout(t,1e3/60)},cancel:function(t){return clearTimeout(t)}};if("function"!=typeof t.next)throw new Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof t.cancel)throw new Error("Scheduler is supposed to have cancel(handle) function");return t}(t.scheduler),h=Object.keys(e),t=(h.forEach(function(t){i[t]=r[t],n[t]=e[t]-r[t]}),"number"==typeof t.duration?t.duration:400),c=Math.max(1,.06*t),d=0;return s=u.next(function t(){var e=a(d/c);d+=1;f(e);d<=c?(s=u.next(t),o(r)):(s=0,setTimeout(function(){l(r)},0))}),{cancel:function(){u.cancel(s),s=0}};function f(e){h.forEach(function(t){r[t]=n[t]*e+i[t]})}},t.exports.makeAggregateRaf=i,t.exports.sharedScheduler=i()},function(t,e){var A=4,_=1e-7,S=10,n="function"==typeof Float32Array;function i(t,e){return 1-3*e+3*t}function L(t,e,r){return((i(e,r)*t+(3*r-6*e))*t+3*e)*t}function k(t,e,r){return 3*i(e,r)*t*t+2*(3*r-6*e)*t+3*e}function a(t){return t}t.exports=function(E,e,T,r){if(!(0<=E&&E<=1&&0<=T&&T<=1))throw new Error("bezier x values must be in [0, 1] range");if(E===e&&T===r)return a;for(var b=new(n?Float32Array:Array)(11),t=0;t<11;++t)b[t]=L(.1*t,E,T);function i(t){for(var e=0,r=1;10!==r&&b[r]<=t;++r)e+=.1;var i=e+.1*((t-b[--r])/(b[r+1]-b[r])),n=k(i,E,T);if(.001<=n){for(var a=t,s=i,o=E,l=T,u=0;u<A;++u){var h=k(s,o,l);if(0===h)return s;s-=(L(s,o,l)-a)/h}return s}if(0===n)return i;for(var c,d,f=t,p=e,g=e+.1,v=E,m=T,y=0;0<(c=L(d=p+(g-p)/2,v,m)-f)?g=d:p=d,Math.abs(c)>_&&++y<S;);return d}return function(t){return 0===t?0:1===t?1:L(i(t),e,r)}}},function(t,e){t.exports=function(t){var e=t;if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var r=["on","fire","off"],i=0;i<r.length;++i)if(e.hasOwnProperty(r[i]))throw new Error("Subject cannot be eventified, since it already has property '"+r[i]+"'");a=t,s=Object.create(null);var a,s,n={on:function(t,e,r){if("function"!=typeof e)throw new Error("callback is expected to be a function");return(s[t]||(s[t]=[])).push({callback:e,ctx:r}),a},off:function(t,e){var r=void 0===t;if(r)s=Object.create(null);else if(s[t])if("function"!=typeof e)delete s[t];else for(var i=s[t],n=0;n<i.length;++n)i[n].callback===e&&i.splice(n,1);return a},fire:function(t){var e,r=s[t];if(r){1<arguments.length&&(e=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var n=r[i];n.callback.apply(n.ctx,e)}}return a}};return t.on=n.on,t.off=n.off,t.fire=n.fire,t}},,,,,,function(t,e,r){},function(t,e,r){},function(t,e,r){}]).default;